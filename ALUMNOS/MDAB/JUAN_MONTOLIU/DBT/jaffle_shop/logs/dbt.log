[0m12:20:24.349784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ffed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ffd90>]}


============================== 12:20:24.380196 | 6336a771-24c3-4b6a-bbc0-9324fa852c33 ==============================
[0m12:20:24.380196 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:20:24.384308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:20:24.387121 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:20:24.393565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6336a771-24c3-4b6a-bbc0-9324fa852c33', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107134d60>]}
[0m12:20:31.251815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6336a771-24c3-4b6a-bbc0-9324fa852c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106def8a0>]}
[0m12:20:31.700867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6336a771-24c3-4b6a-bbc0-9324fa852c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaba50>]}
[0m12:20:31.708473 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:20:31.838844 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:20:31.847949 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:20:31.851040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6336a771-24c3-4b6a-bbc0-9324fa852c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107152e40>]}
[0m12:20:40.333176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6336a771-24c3-4b6a-bbc0-9324fa852c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d452b0>]}
[0m12:20:41.361029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6336a771-24c3-4b6a-bbc0-9324fa852c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d9b20>]}
[0m12:20:41.364993 [info ] [MainThread]: Found 2 models, 4 data tests, 423 macros
[0m12:20:41.368268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6336a771-24c3-4b6a-bbc0-9324fa852c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c953d0>]}
[0m12:20:41.388479 [info ] [MainThread]: 
[0m12:20:41.392357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:20:41.431995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m12:20:41.781805 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m12:20:41.785035 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m12:20:41.788254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:42.180486 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "raw" does not exist

[0m12:20:42.324736 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m12:20:42.332413 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:20:42.339161 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m12:20:42.345567 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:20:42.350782 [debug] [ThreadPool]: On list_raw: No close available on handle
[0m12:20:42.357282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:42.359208 [debug] [MainThread]: Connection 'list_raw' was properly closed.
[0m12:20:42.362502 [info ] [MainThread]: 
[0m12:20:42.365668 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m12:20:42.372653 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "raw" does not exist
  
[0m12:20:42.393300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 18.445177, "process_user_time": 2.761247, "process_kernel_time": 3.669995, "process_mem_max_rss": "114130944", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:20:42.398121 [debug] [MainThread]: Command `dbt run` failed at 12:20:42.397444 after 18.45 seconds
[0m12:20:42.402606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780ae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e0c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e0e10>]}
[0m12:20:42.405927 [debug] [MainThread]: Flushing usage events
[0m12:21:58.245327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102591fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c3d90>]}


============================== 12:21:58.291000 | e7ec3083-6eea-4327-8238-9b61e28af1b8 ==============================
[0m12:21:58.291000 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:21:58.297110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:21:58.303342 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:21:58.307338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e7ec3083-6eea-4327-8238-9b61e28af1b8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f8d60>]}
[0m12:21:59.665355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7ec3083-6eea-4327-8238-9b61e28af1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ef8a0>]}
[0m12:22:00.537213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7ec3083-6eea-4327-8238-9b61e28af1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e7a50>]}
[0m12:22:00.545700 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:22:00.658925 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:22:01.417186 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:22:01.421556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7ec3083-6eea-4327-8238-9b61e28af1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b0aa0>]}
[0m12:22:11.546038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7ec3083-6eea-4327-8238-9b61e28af1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055fc9f0>]}
[0m12:22:12.195847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7ec3083-6eea-4327-8238-9b61e28af1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cb380>]}
[0m12:22:12.200776 [info ] [MainThread]: Found 2 models, 4 data tests, 423 macros
[0m12:22:12.203660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ec3083-6eea-4327-8238-9b61e28af1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f5fd0>]}
[0m12:22:12.237983 [info ] [MainThread]: 
[0m12:22:12.243018 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:22:12.291533 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m12:22:12.600329 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m12:22:12.604736 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m12:22:12.606626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:12.825902 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.219 seconds
[0m12:22:12.837345 [debug] [ThreadPool]: On list_dbt: Close
[0m12:22:12.846516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_dev)
[0m12:22:12.851623 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "dev"
"
[0m12:22:12.893739 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
[0m12:22:12.897054 [debug] [ThreadPool]: On create_dbt_dev: BEGIN
[0m12:22:12.900784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:12.990143 [debug] [ThreadPool]: SQL status: BEGIN in 0.089 seconds
[0m12:22:12.993613 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
[0m12:22:12.995966 [debug] [ThreadPool]: On create_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_dbt_dev"} */
create schema if not exists "dev"
[0m12:22:13.008983 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.010 seconds
[0m12:22:13.017993 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
[0m12:22:13.020422 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
[0m12:22:13.023381 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
[0m12:22:13.035238 [debug] [ThreadPool]: SQL status: COMMIT in 0.009 seconds
[0m12:22:13.037575 [debug] [ThreadPool]: On create_dbt_dev: Close
[0m12:22:13.050327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_dev, now list_dbt_dev)
[0m12:22:13.098733 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m12:22:13.100925 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m12:22:13.103272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:13.166693 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m12:22:13.169205 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m12:22:13.172300 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:22:13.229580 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.053 seconds
[0m12:22:13.241831 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m12:22:13.248965 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m12:22:13.297811 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:13.301190 [debug] [MainThread]: On master: BEGIN
[0m12:22:13.303738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:13.398059 [debug] [MainThread]: SQL status: BEGIN in 0.092 seconds
[0m12:22:13.401564 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:13.405159 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:22:13.469912 [debug] [MainThread]: SQL status: SELECT 0 in 0.061 seconds
[0m12:22:13.480936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7ec3083-6eea-4327-8238-9b61e28af1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c149f0>]}
[0m12:22:13.484467 [debug] [MainThread]: On master: ROLLBACK
[0m12:22:13.492022 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:13.494166 [debug] [MainThread]: On master: BEGIN
[0m12:22:13.503913 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:22:13.506867 [debug] [MainThread]: On master: COMMIT
[0m12:22:13.508840 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:13.511074 [debug] [MainThread]: On master: COMMIT
[0m12:22:13.517320 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m12:22:13.519565 [debug] [MainThread]: On master: Close
[0m12:22:13.524261 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:13.528167 [info ] [MainThread]: 
[0m12:22:13.611333 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m12:22:13.616510 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m12:22:13.619812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.my_first_dbt_model)
[0m12:22:13.623110 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m12:22:13.685827 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m12:22:13.691718 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m12:22:13.979510 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m12:22:13.984784 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m12:22:13.987096 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: BEGIN
[0m12:22:13.989327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:14.046122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m12:22:14.049829 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m12:22:14.055935 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */

  
    

  create  table "dbt"."dev"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m12:22:14.097695 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.037 seconds
[0m12:22:14.151044 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m12:22:14.153185 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
alter table "dbt"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:22:14.162131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:22:14.316662 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m12:22:14.320230 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m12:22:14.323030 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: COMMIT
[0m12:22:14.329274 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:22:14.455155 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."my_first_dbt_model__dbt_backup"
[0m12:22:14.658770 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_first_dbt_model"
[0m12:22:14.661403 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
drop table if exists "dbt"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m12:22:14.674484 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m12:22:14.693141 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m12:22:14.703025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ec3083-6eea-4327-8238-9b61e28af1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038ae3f0>]}
[0m12:22:14.708660 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 1.08s]
[0m12:22:14.714261 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m12:22:14.722316 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m12:22:14.726039 [info ] [Thread-1 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m12:22:14.730601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model, now model.jaffle_shop.my_second_dbt_model)
[0m12:22:14.740145 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m12:22:14.757427 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m12:22:14.765853 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m12:22:14.919151 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m12:22:14.924557 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m12:22:14.927845 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: BEGIN
[0m12:22:14.931135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:15.029090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.098 seconds
[0m12:22:15.031394 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m12:22:15.035113 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */

  create view "dbt"."dev"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."dev"."my_first_dbt_model"
where id = 1
  );
[0m12:22:15.067283 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m12:22:15.087198 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m12:22:15.089898 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
alter table "dbt"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:22:15.098294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:22:15.107400 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m12:22:15.109946 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m12:22:15.112148 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: COMMIT
[0m12:22:15.126635 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m12:22:15.154341 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."my_second_dbt_model__dbt_backup"
[0m12:22:15.181605 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.my_second_dbt_model"
[0m12:22:15.184639 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "dbt"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m12:22:15.195345 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m12:22:15.204841 [debug] [Thread-1 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m12:22:15.208715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7ec3083-6eea-4327-8238-9b61e28af1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cec950>]}
[0m12:22:15.212948 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.48s]
[0m12:22:15.217106 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m12:22:15.228011 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:15.232252 [debug] [MainThread]: On master: BEGIN
[0m12:22:15.235102 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:15.338353 [debug] [MainThread]: SQL status: BEGIN in 0.103 seconds
[0m12:22:15.347675 [debug] [MainThread]: On master: COMMIT
[0m12:22:15.358718 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:15.361708 [debug] [MainThread]: On master: COMMIT
[0m12:22:15.370686 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m12:22:15.374341 [debug] [MainThread]: On master: Close
[0m12:22:15.376820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:15.379088 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m12:22:15.381668 [info ] [MainThread]: 
[0m12:22:15.384524 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m12:22:15.390246 [debug] [MainThread]: Command end result
[0m12:22:15.569521 [info ] [MainThread]: 
[0m12:22:15.573591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:22:15.576127 [info ] [MainThread]: 
[0m12:22:15.579217 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:22:15.597725 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.813118, "process_user_time": 3.658017, "process_kernel_time": 4.55078, "process_mem_max_rss": "119324672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:22:15.606554 [debug] [MainThread]: Command `dbt run` succeeded at 12:22:15.605250 after 17.82 seconds
[0m12:22:15.609862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f5320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100285da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fca210>]}
[0m12:22:15.612795 [debug] [MainThread]: Flushing usage events
[0m12:26:16.712338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f51fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cffed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cffd90>]}


============================== 12:26:16.741964 | caf5dc9f-bc3a-4108-bd30-19fbff8f9a11 ==============================
[0m12:26:16.741964 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:26:16.747502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:26:16.750168 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:26:16.753955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'caf5dc9f-bc3a-4108-bd30-19fbff8f9a11', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d34d60>]}
[0m12:26:17.907097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caf5dc9f-bc3a-4108-bd30-19fbff8f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ef8a0>]}
[0m12:26:18.369013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caf5dc9f-bc3a-4108-bd30-19fbff8f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aaba50>]}
[0m12:26:18.375888 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:26:18.446897 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:26:19.319880 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m12:26:19.326170 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/example/my_second_dbt_model.sql
[0m12:26:19.329636 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/example/my_first_dbt_model.sql
[0m12:26:19.557181 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.example
[0m12:26:19.609084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caf5dc9f-bc3a-4108-bd30-19fbff8f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105315220>]}
[0m12:26:20.395171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caf5dc9f-bc3a-4108-bd30-19fbff8f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105896b30>]}
[0m12:26:20.399557 [info ] [MainThread]: Found 423 macros
[0m12:26:20.402017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caf5dc9f-bc3a-4108-bd30-19fbff8f9a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105869bf0>]}
[0m12:26:20.438134 [info ] [MainThread]: 
[0m12:26:20.441588 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:26:20.459808 [debug] [MainThread]: Command end result
[0m12:26:20.630812 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.293828, "process_user_time": 1.893623, "process_kernel_time": 2.540636, "process_mem_max_rss": "102252544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:26:20.636552 [debug] [MainThread]: Command `dbt run` succeeded at 12:26:20.635700 after 4.30 seconds
[0m12:26:20.638795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d20650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105891e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105891c80>]}
[0m12:26:20.642454 [debug] [MainThread]: Flushing usage events
[0m12:34:40.707693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10343dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bfd90>]}


============================== 12:34:40.733222 | 76ddedcf-3e21-4c6b-a62b-b3ee96bf911c ==============================
[0m12:34:40.733222 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:34:40.736416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:34:40.738326 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:34:40.739776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76ddedcf-3e21-4c6b-a62b-b3ee96bf911c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f8d60>]}
[0m12:34:42.428236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76ddedcf-3e21-4c6b-a62b-b3ee96bf911c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ef8a0>]}
[0m12:34:42.840371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76ddedcf-3e21-4c6b-a62b-b3ee96bf911c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057aba50>]}
[0m12:34:42.844925 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:34:42.936498 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:34:43.235677 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:34:43.238006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '76ddedcf-3e21-4c6b-a62b-b3ee96bf911c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d5a90>]}
[0m12:34:48.906375 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models
[0m12:34:48.942923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76ddedcf-3e21-4c6b-a62b-b3ee96bf911c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dd470>]}
[0m12:34:49.339612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76ddedcf-3e21-4c6b-a62b-b3ee96bf911c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106585570>]}
[0m12:34:49.343147 [info ] [MainThread]: Found 3 seeds, 423 macros
[0m12:34:49.346156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76ddedcf-3e21-4c6b-a62b-b3ee96bf911c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3d010>]}
[0m12:34:49.363324 [info ] [MainThread]: 
[0m12:34:49.367865 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:34:49.374718 [debug] [MainThread]: Command end result
[0m12:34:49.808215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.452886, "process_user_time": 3.248435, "process_kernel_time": 3.237471, "process_mem_max_rss": "104316928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:34:49.812397 [debug] [MainThread]: Command `dbt run` succeeded at 12:34:49.811677 after 9.46 seconds
[0m12:34:49.815335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665cec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106549090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ab250>]}
[0m12:34:49.817539 [debug] [MainThread]: Flushing usage events
[0m12:35:35.862227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cbfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cbfd90>]}


============================== 12:35:35.889574 | 00e0a913-642c-40fe-8528-1ac6eb37a82a ==============================
[0m12:35:35.889574 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:35:35.892939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:35:35.896254 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:35:35.901473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '00e0a913-642c-40fe-8528-1ac6eb37a82a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cf8d60>]}
[0m12:35:37.003246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00e0a913-642c-40fe-8528-1ac6eb37a82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103ef8a0>]}
[0m12:35:37.551803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00e0a913-642c-40fe-8528-1ac6eb37a82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108aba50>]}
[0m12:35:37.558866 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:35:37.654097 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:35:38.138899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:38.139294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:38.142072 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models
[0m12:35:38.150407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00e0a913-642c-40fe-8528-1ac6eb37a82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a6d220>]}
[0m12:35:38.189288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00e0a913-642c-40fe-8528-1ac6eb37a82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128c4590>]}
[0m12:35:38.189659 [info ] [MainThread]: Found 3 seeds, 423 macros
[0m12:35:38.189921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00e0a913-642c-40fe-8528-1ac6eb37a82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b2b930>]}
[0m12:35:38.191330 [info ] [MainThread]: 
[0m12:35:38.191787 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:35:38.193968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m12:35:38.197479 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m12:35:38.197685 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:35:38.197825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:38.254365 [debug] [ThreadPool]: On list_raw: Close
[0m12:35:38.254955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:38.255122 [debug] [MainThread]: Connection 'list_raw' was properly closed.
[0m12:35:38.255275 [info ] [MainThread]: 
[0m12:35:38.255438 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m12:35:38.255676 [error] [MainThread]: Encountered an error:
Runtime Error
  ERROR: Cross-db references not allowed in postgres (raw vs dbt)
[0m12:35:38.257830 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 2.725216, "process_user_time": 1.745597, "process_kernel_time": 1.844671, "process_mem_max_rss": "103055360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:35:38.258231 [debug] [MainThread]: Command `dbt seed` failed at 12:35:38.258173 after 2.73 seconds
[0m12:35:38.258432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ce8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ba1650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ba12e0>]}
[0m12:35:38.258610 [debug] [MainThread]: Flushing usage events
[0m12:36:28.698341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103051fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffbd90>]}


============================== 12:36:28.726398 | 2f5ab3ea-1fdc-437f-9968-6177e1376949 ==============================
[0m12:36:28.726398 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:36:28.729829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m12:36:28.732154 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:36:28.735193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2f5ab3ea-1fdc-437f-9968-6177e1376949', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105034d60>]}
[0m12:36:29.636151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f5ab3ea-1fdc-437f-9968-6177e1376949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cef8a0>]}
[0m12:36:30.150332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f5ab3ea-1fdc-437f-9968-6177e1376949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104daba50>]}
[0m12:36:30.166036 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:36:30.305475 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:36:30.562866 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:36:30.566353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2f5ab3ea-1fdc-437f-9968-6177e1376949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a41040>]}
[0m12:36:36.103255 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models
[0m12:36:36.129333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f5ab3ea-1fdc-437f-9968-6177e1376949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e98e50>]}
[0m12:36:36.411047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f5ab3ea-1fdc-437f-9968-6177e1376949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f63ee0>]}
[0m12:36:36.413991 [info ] [MainThread]: Found 3 seeds, 423 macros
[0m12:36:36.416012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f5ab3ea-1fdc-437f-9968-6177e1376949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea65d0>]}
[0m12:36:36.433733 [info ] [MainThread]: 
[0m12:36:36.436748 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:36:36.470606 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m12:36:37.083684 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m12:36:37.084486 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m12:36:37.084936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:37.216694 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.131 seconds
[0m12:36:37.224834 [debug] [ThreadPool]: On list_dbt: Close
[0m12:36:37.229291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_dev_data)
[0m12:36:37.232493 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "dev_data"
"
[0m12:36:37.266778 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_data"
[0m12:36:37.269294 [debug] [ThreadPool]: On create_dbt_dev_data: BEGIN
[0m12:36:37.271123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:37.311712 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m12:36:37.313985 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_data"
[0m12:36:37.316199 [debug] [ThreadPool]: On create_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_dbt_dev_data"} */
create schema if not exists "dev_data"
[0m12:36:37.320856 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m12:36:37.326584 [debug] [ThreadPool]: On create_dbt_dev_data: COMMIT
[0m12:36:37.329356 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_data"
[0m12:36:37.331745 [debug] [ThreadPool]: On create_dbt_dev_data: COMMIT
[0m12:36:37.336007 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m12:36:37.337616 [debug] [ThreadPool]: On create_dbt_dev_data: Close
[0m12:36:37.345453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_dev_data, now list_dbt_dev_data)
[0m12:36:37.380468 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m12:36:37.383337 [debug] [ThreadPool]: On list_dbt_dev_data: BEGIN
[0m12:36:37.385441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:37.430255 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m12:36:37.433228 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m12:36:37.434946 [debug] [ThreadPool]: On list_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev_data"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_data'
  
[0m12:36:37.465158 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m12:36:37.472893 [debug] [ThreadPool]: On list_dbt_dev_data: ROLLBACK
[0m12:36:37.477938 [debug] [ThreadPool]: On list_dbt_dev_data: Close
[0m12:36:37.513354 [debug] [MainThread]: Using postgres connection "master"
[0m12:36:37.516443 [debug] [MainThread]: On master: BEGIN
[0m12:36:37.518432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:36:37.572006 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m12:36:37.574375 [debug] [MainThread]: Using postgres connection "master"
[0m12:36:37.576224 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:36:37.620142 [debug] [MainThread]: SQL status: SELECT 1 in 0.041 seconds
[0m12:36:37.629698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f5ab3ea-1fdc-437f-9968-6177e1376949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f23ee0>]}
[0m12:36:37.632461 [debug] [MainThread]: On master: ROLLBACK
[0m12:36:37.637422 [debug] [MainThread]: Using postgres connection "master"
[0m12:36:37.639298 [debug] [MainThread]: On master: BEGIN
[0m12:36:37.645735 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:36:37.647319 [debug] [MainThread]: On master: COMMIT
[0m12:36:37.649607 [debug] [MainThread]: Using postgres connection "master"
[0m12:36:37.651436 [debug] [MainThread]: On master: COMMIT
[0m12:36:37.656657 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m12:36:37.659157 [debug] [MainThread]: On master: Close
[0m12:36:37.662953 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:36:37.665320 [info ] [MainThread]: 
[0m12:36:37.685693 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.jaffle_shop_customers
[0m12:36:37.690066 [info ] [Thread-1 (]: 1 of 3 START seed file dev_data.jaffle_shop_customers .......................... [RUN]
[0m12:36:37.691452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev_data, now seed.jaffle_shop.jaffle_shop_customers)
[0m12:36:37.691686 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.jaffle_shop_customers
[0m12:36:37.692020 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.jaffle_shop_customers
[0m12:36:37.849566 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_customers"
[0m12:36:37.853462 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_customers: BEGIN
[0m12:36:37.855991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:37.924949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m12:36:37.928308 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_customers"
[0m12:36:37.930932 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.jaffle_shop_customers"} */

    create table "dbt"."dev_data"."jaffle_shop_customers" ("ID" integer,"FIRST_NAME" text,"LAST_NAME" text)
  
[0m12:36:37.964271 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.031 seconds
[0m12:36:38.319734 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_customers"
[0m12:36:38.322824 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_customers: 
          insert into "dbt"."dev_data"."jaffle_shop_customers" ("ID", "FIRST_NAME", "LAST_NAME") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m12:36:38.330659 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.005 seconds
[0m12:36:38.370327 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.jaffle_shop_customers"
[0m12:36:38.481188 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_customers: COMMIT
[0m12:36:38.483393 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_customers"
[0m12:36:38.484990 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_customers: COMMIT
[0m12:36:38.490050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:36:38.500232 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_customers: Close
[0m12:36:38.509599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f5ab3ea-1fdc-437f-9968-6177e1376949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b23f0>]}
[0m12:36:38.513411 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file dev_data.jaffle_shop_customers ...................... [[32mINSERT 100[0m in 0.81s]
[0m12:36:38.518771 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.jaffle_shop_customers
[0m12:36:38.522085 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.jaffle_shop_orders
[0m12:36:38.531244 [info ] [Thread-1 (]: 2 of 3 START seed file dev_data.jaffle_shop_orders ............................. [RUN]
[0m12:36:38.534719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.jaffle_shop_customers, now seed.jaffle_shop.jaffle_shop_orders)
[0m12:36:38.536056 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.jaffle_shop_orders
[0m12:36:38.540796 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.jaffle_shop_orders
[0m12:36:38.592415 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_orders"
[0m12:36:38.594809 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_orders: BEGIN
[0m12:36:38.596948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:38.624764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m12:36:38.626102 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_orders"
[0m12:36:38.629110 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.jaffle_shop_orders"} */

    create table "dbt"."dev_data"."jaffle_shop_orders" ("ID" integer,"USER_ID" integer,"ORDER_DATE" date,"STATUS" text)
  
[0m12:36:38.652907 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.020 seconds
[0m12:36:39.080766 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_orders"
[0m12:36:39.084156 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_orders: 
          insert into "dbt"."dev_data"."jaffle_shop_orders" ("ID", "USER_ID", "ORDER_DATE", "STATUS") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m12:36:39.095903 [debug] [Thread-1 (]: SQL status: INSERT 0 99 in 0.008 seconds
[0m12:36:39.100768 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.jaffle_shop_orders"
[0m12:36:39.111808 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_orders: COMMIT
[0m12:36:39.114410 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_orders"
[0m12:36:39.117048 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_orders: COMMIT
[0m12:36:39.122549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:36:39.126171 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_orders: Close
[0m12:36:39.129841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f5ab3ea-1fdc-437f-9968-6177e1376949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064281d0>]}
[0m12:36:39.134259 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file dev_data.jaffle_shop_orders ......................... [[32mINSERT 99[0m in 0.60s]
[0m12:36:39.138940 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.jaffle_shop_orders
[0m12:36:39.141707 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.stripe_payments
[0m12:36:39.145789 [info ] [Thread-1 (]: 3 of 3 START seed file dev_data.stripe_payments ................................ [RUN]
[0m12:36:39.149183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.jaffle_shop_orders, now seed.jaffle_shop.stripe_payments)
[0m12:36:39.153975 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.stripe_payments
[0m12:36:39.156745 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.stripe_payments
[0m12:36:39.226175 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.stripe_payments"
[0m12:36:39.228644 [debug] [Thread-1 (]: On seed.jaffle_shop.stripe_payments: BEGIN
[0m12:36:39.231588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:39.278687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m12:36:39.283551 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.stripe_payments"
[0m12:36:39.285991 [debug] [Thread-1 (]: On seed.jaffle_shop.stripe_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.stripe_payments"} */

    create table "dbt"."dev_data"."stripe_payments" ("ID" integer,"ORDERID" integer,"PAYMENTMETHOD" text,"STATUS" text,"AMOUNT" integer,"CREATED" date)
  
[0m12:36:39.303222 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.012 seconds
[0m12:36:40.384711 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.stripe_payments"
[0m12:36:40.388177 [debug] [Thread-1 (]: On seed.jaffle_shop.stripe_payments: 
          insert into "dbt"."dev_data"."stripe_payments" ("ID", "ORDERID", "PAYMENTMETHOD", "STATUS", "AMOUNT", "CREATED") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m12:36:40.426633 [debug] [Thread-1 (]: SQL status: INSERT 0 120 in 0.034 seconds
[0m12:36:40.433438 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.stripe_payments"
[0m12:36:40.447539 [debug] [Thread-1 (]: On seed.jaffle_shop.stripe_payments: COMMIT
[0m12:36:40.451246 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.stripe_payments"
[0m12:36:40.454767 [debug] [Thread-1 (]: On seed.jaffle_shop.stripe_payments: COMMIT
[0m12:36:40.464734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m12:36:40.469573 [debug] [Thread-1 (]: On seed.jaffle_shop.stripe_payments: Close
[0m12:36:40.475151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f5ab3ea-1fdc-437f-9968-6177e1376949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d97cb0>]}
[0m12:36:40.480255 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file dev_data.stripe_payments ............................ [[32mINSERT 120[0m in 1.33s]
[0m12:36:40.486049 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.stripe_payments
[0m12:36:40.502367 [debug] [MainThread]: Using postgres connection "master"
[0m12:36:40.508829 [debug] [MainThread]: On master: BEGIN
[0m12:36:40.511351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:36:40.619281 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m12:36:40.627210 [debug] [MainThread]: On master: COMMIT
[0m12:36:40.629288 [debug] [MainThread]: Using postgres connection "master"
[0m12:36:40.632408 [debug] [MainThread]: On master: COMMIT
[0m12:36:40.645366 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m12:36:40.647888 [debug] [MainThread]: On master: Close
[0m12:36:40.652325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:40.657191 [debug] [MainThread]: Connection 'seed.jaffle_shop.stripe_payments' was properly closed.
[0m12:36:40.666709 [info ] [MainThread]: 
[0m12:36:40.670471 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 4.23 seconds (4.23s).
[0m12:36:40.697030 [debug] [MainThread]: Command end result
[0m12:36:40.876952 [info ] [MainThread]: 
[0m12:36:40.881249 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:40.884522 [info ] [MainThread]: 
[0m12:36:40.889032 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:36:40.908164 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 12.568012, "process_user_time": 3.782967, "process_kernel_time": 3.680679, "process_mem_max_rss": "112951296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:36:40.913786 [debug] [MainThread]: Command `dbt seed` succeeded at 12:36:40.912644 after 12.58 seconds
[0m12:36:40.916276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655bc50>]}
[0m12:36:40.918837 [debug] [MainThread]: Flushing usage events
[0m14:05:14.897566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105251fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c3d90>]}


============================== 14:05:14.929312 | b6912c78-5a8e-41ea-9fe5-e06a6fb886c9 ==============================
[0m14:05:14.929312 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:05:14.935655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:05:14.938351 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:05:14.940013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b6912c78-5a8e-41ea-9fe5-e06a6fb886c9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107100d60>]}
[0m14:05:15.883686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6912c78-5a8e-41ea-9fe5-e06a6fb886c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfbf00>]}
[0m14:05:16.205035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6912c78-5a8e-41ea-9fe5-e06a6fb886c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106caf550>]}
[0m14:05:16.211301 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:05:16.643585 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m14:05:17.201539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:17.204133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:17.235218 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m14:05:17.364943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6912c78-5a8e-41ea-9fe5-e06a6fb886c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e4b90>]}
[0m14:05:17.831130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6912c78-5a8e-41ea-9fe5-e06a6fb886c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100e0210>]}
[0m14:05:17.834377 [info ] [MainThread]: Found 1 model, 423 macros
[0m14:05:17.836210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6912c78-5a8e-41ea-9fe5-e06a6fb886c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714aa90>]}
[0m14:05:17.851227 [info ] [MainThread]: 
[0m14:05:17.854965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:17.871447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m14:05:18.270257 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m14:05:18.273523 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:05:18.276637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:18.486339 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.209 seconds
[0m14:05:18.497500 [debug] [ThreadPool]: On list_dbt: Close
[0m14:05:18.510739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m14:05:18.565379 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m14:05:18.568602 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m14:05:18.571074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:18.652089 [debug] [ThreadPool]: SQL status: BEGIN in 0.079 seconds
[0m14:05:18.655473 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m14:05:18.657869 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:05:18.702945 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.042 seconds
[0m14:05:18.715826 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m14:05:18.720296 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m14:05:18.792128 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:18.794911 [debug] [MainThread]: On master: BEGIN
[0m14:05:18.796732 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:18.839825 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m14:05:18.842841 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:18.845386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:18.890717 [debug] [MainThread]: SQL status: SELECT 1 in 0.043 seconds
[0m14:05:18.900875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6912c78-5a8e-41ea-9fe5-e06a6fb886c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d2810>]}
[0m14:05:18.903541 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:18.908291 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:18.909728 [debug] [MainThread]: On master: BEGIN
[0m14:05:18.919953 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:05:18.922245 [debug] [MainThread]: On master: COMMIT
[0m14:05:18.924402 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:18.926152 [debug] [MainThread]: On master: COMMIT
[0m14:05:18.930602 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m14:05:18.933032 [debug] [MainThread]: On master: Close
[0m14:05:18.936786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:18.939390 [info ] [MainThread]: 
[0m14:05:18.965469 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m14:05:18.972425 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.stg_customers .................................. [RUN]
[0m14:05:18.976315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m14:05:18.999479 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:05:19.042449 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:05:19.047270 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:05:19.251510 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:05:19.257036 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m14:05:19.259110 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m14:05:19.261386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:19.379090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.117 seconds
[0m14:05:19.381882 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m14:05:19.384602 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   dbt.dev_data.jaffle_shop_customers
  );
[0m14:05:19.393948 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 8:    id as customer_id,
           ^

[0m14:05:19.396719 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m14:05:19.402929 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m14:05:19.447056 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  column "id" does not exist
  LINE 8:    id as customer_id,
             ^
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:05:19.455469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6912c78-5a8e-41ea-9fe5-e06a6fb886c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110093490>]}
[0m14:05:19.460825 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dev.stg_customers ......................... [[31mERROR[0m in 0.47s]
[0m14:05:19.464843 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:05:19.482712 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:19.486659 [debug] [MainThread]: On master: BEGIN
[0m14:05:19.489087 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:19.556991 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m14:05:19.560131 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.563565 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:19.565532 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.569548 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m14:05:19.571552 [debug] [MainThread]: On master: Close
[0m14:05:19.575064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:19.576684 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m14:05:19.578685 [info ] [MainThread]: 
[0m14:05:19.581025 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m14:05:19.585466 [debug] [MainThread]: Command end result
[0m14:05:19.741863 [info ] [MainThread]: 
[0m14:05:19.744734 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:05:19.746882 [info ] [MainThread]: 
[0m14:05:19.751480 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  column "id" does not exist
  LINE 8:    id as customer_id,
             ^
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:05:19.758318 [info ] [MainThread]: 
[0m14:05:19.760618 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:05:19.765291 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.149954, "process_user_time": 2.069062, "process_kernel_time": 2.199769, "process_mem_max_rss": "108707840", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:19.765731 [debug] [MainThread]: Command `dbt run` failed at 14:05:19.765639 after 5.15 seconds
[0m14:05:19.766614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11037af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100bbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771aa50>]}
[0m14:05:19.768282 [debug] [MainThread]: Flushing usage events
[0m14:07:38.208159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105251fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c3d90>]}


============================== 14:07:38.244667 | b38db9d9-0d5c-4ab2-8b3e-18d8a3869b6b ==============================
[0m14:07:38.244667 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:07:38.249162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:38.251847 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:07:38.256998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b38db9d9-0d5c-4ab2-8b3e-18d8a3869b6b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f8d60>]}
[0m14:07:39.813326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b38db9d9-0d5c-4ab2-8b3e-18d8a3869b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eef8a0>]}
[0m14:07:40.328003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b38db9d9-0d5c-4ab2-8b3e-18d8a3869b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ab550>]}
[0m14:07:40.335113 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:07:40.449569 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m14:07:41.144727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:07:41.147559 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:07:41.189518 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m14:07:41.353384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b38db9d9-0d5c-4ab2-8b3e-18d8a3869b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de4b90>]}
[0m14:07:42.116508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b38db9d9-0d5c-4ab2-8b3e-18d8a3869b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb6510>]}
[0m14:07:42.116872 [info ] [MainThread]: Found 1 model, 423 macros
[0m14:07:42.123246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b38db9d9-0d5c-4ab2-8b3e-18d8a3869b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107846a90>]}
[0m14:07:42.183100 [info ] [MainThread]: 
[0m14:07:42.184350 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:07:42.187356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m14:07:42.672864 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m14:07:42.675165 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:07:42.678936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:42.823380 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.144 seconds
[0m14:07:42.834242 [debug] [ThreadPool]: On list_dbt: Close
[0m14:07:42.844257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m14:07:42.891441 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m14:07:42.893184 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m14:07:42.894262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:42.962140 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m14:07:42.964102 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m14:07:42.966038 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:07:43.001504 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.032 seconds
[0m14:07:43.012063 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m14:07:43.017280 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m14:07:43.054554 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:43.056925 [debug] [MainThread]: On master: BEGIN
[0m14:07:43.059304 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:43.138969 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m14:07:43.142963 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:43.144209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:07:43.192408 [debug] [MainThread]: SQL status: SELECT 1 in 0.045 seconds
[0m14:07:43.204955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b38db9d9-0d5c-4ab2-8b3e-18d8a3869b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dce810>]}
[0m14:07:43.207251 [debug] [MainThread]: On master: ROLLBACK
[0m14:07:43.212714 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:43.214643 [debug] [MainThread]: On master: BEGIN
[0m14:07:43.224279 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:07:43.228096 [debug] [MainThread]: On master: COMMIT
[0m14:07:43.231369 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:43.233545 [debug] [MainThread]: On master: COMMIT
[0m14:07:43.240069 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:07:43.242378 [debug] [MainThread]: On master: Close
[0m14:07:43.249768 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:07:43.252139 [info ] [MainThread]: 
[0m14:07:43.273708 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m14:07:43.280802 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.stg_customers .................................. [RUN]
[0m14:07:43.285187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m14:07:43.288290 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:07:43.357183 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:07:43.357843 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:07:43.576227 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:07:43.580478 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m14:07:43.582276 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m14:07:43.584923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:43.678021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.092 seconds
[0m14:07:43.680675 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m14:07:43.684260 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   ID as customer_id,
   first_name,
   last_name
from
   dbt.dev_data.jaffle_shop_customers
  );
[0m14:07:43.694616 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 8:    ID as customer_id,
           ^

[0m14:07:43.698679 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m14:07:43.705316 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m14:07:43.759198 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  column "id" does not exist
  LINE 8:    ID as customer_id,
             ^
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:07:43.770092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b38db9d9-0d5c-4ab2-8b3e-18d8a3869b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f03490>]}
[0m14:07:43.773587 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dev.stg_customers ......................... [[31mERROR[0m in 0.48s]
[0m14:07:43.778596 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:07:43.794494 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:43.796841 [debug] [MainThread]: On master: BEGIN
[0m14:07:43.798949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:43.879786 [debug] [MainThread]: SQL status: BEGIN in 0.080 seconds
[0m14:07:43.883657 [debug] [MainThread]: On master: COMMIT
[0m14:07:43.886189 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:43.888315 [debug] [MainThread]: On master: COMMIT
[0m14:07:43.892109 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m14:07:43.894045 [debug] [MainThread]: On master: Close
[0m14:07:43.897310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:43.900059 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m14:07:43.903524 [info ] [MainThread]: 
[0m14:07:43.906698 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m14:07:43.917920 [debug] [MainThread]: Command end result
[0m14:07:44.084951 [info ] [MainThread]: 
[0m14:07:44.088079 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:07:44.090476 [info ] [MainThread]: 
[0m14:07:44.093914 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  column "id" does not exist
  LINE 8:    ID as customer_id,
             ^
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:07:44.096493 [info ] [MainThread]: 
[0m14:07:44.098990 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:07:44.110650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.373639, "process_user_time": 2.269648, "process_kernel_time": 3.068615, "process_mem_max_rss": "112214016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:07:44.115288 [debug] [MainThread]: Command `dbt run` failed at 14:07:44.114888 after 6.38 seconds
[0m14:07:44.119789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12167acb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078db750>]}
[0m14:07:44.129633 [debug] [MainThread]: Flushing usage events
[0m14:08:58.818061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102849fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fbed0>]}


============================== 14:08:58.854637 | 3c5533d0-7a77-4d4e-881b-adb9de36a1b9 ==============================
[0m14:08:58.854637 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:08:58.860703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:58.863362 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:08:58.871509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3c5533d0-7a77-4d4e-881b-adb9de36a1b9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a30d60>]}
[0m14:08:59.735304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c5533d0-7a77-4d4e-881b-adb9de36a1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f7bd0>]}
[0m14:08:59.848114 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:08:59.856388 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:08:59.871962 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.5980812, "process_user_time": 1.800277, "process_kernel_time": 2.762697, "process_mem_max_rss": "98484224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:08:59.876998 [debug] [MainThread]: Command `cli deps` succeeded at 14:08:59.875847 after 1.60 seconds
[0m14:08:59.880275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a519a0>]}
[0m14:08:59.885219 [debug] [MainThread]: Flushing usage events
[0m14:18:18.193317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106affed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106affd90>]}


============================== 14:18:18.230316 | f8014a94-9a81-4bde-b8ab-583fb3c005c1 ==============================
[0m14:18:18.230316 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:18:18.235962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:18.239894 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m14:18:18.245304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f8014a94-9a81-4bde-b8ab-583fb3c005c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b34d60>]}
[0m14:18:19.388581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8014a94-9a81-4bde-b8ab-583fb3c005c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f38a0>]}
[0m14:18:19.823080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8014a94-9a81-4bde-b8ab-583fb3c005c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ab550>]}
[0m14:18:19.831129 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:18:20.013730 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m14:18:20.720862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m14:18:20.724710 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/jaffle_shop_orders.csv
[0m14:18:20.726872 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/stripe_payments.csv
[0m14:18:20.729881 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/jaffle_shop_customers.csv
[0m14:18:22.765341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8014a94-9a81-4bde-b8ab-583fb3c005c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107122e40>]}
[0m14:18:23.440769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8014a94-9a81-4bde-b8ab-583fb3c005c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c2890>]}
[0m14:18:23.445440 [info ] [MainThread]: Found 1 model, 3 seeds, 423 macros
[0m14:18:23.450276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8014a94-9a81-4bde-b8ab-583fb3c005c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776b930>]}
[0m14:18:23.493562 [info ] [MainThread]: 
[0m14:18:23.503382 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:18:23.547265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m14:18:23.854945 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m14:18:23.856778 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m14:18:23.858665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:24.055120 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.195 seconds
[0m14:18:24.067477 [debug] [ThreadPool]: On list_dbt: Close
[0m14:18:24.075110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_dev_data)
[0m14:18:24.080781 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "dev_data"
"
[0m14:18:24.125635 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_data"
[0m14:18:24.128021 [debug] [ThreadPool]: On create_dbt_dev_data: BEGIN
[0m14:18:24.129798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:24.216352 [debug] [ThreadPool]: SQL status: BEGIN in 0.086 seconds
[0m14:18:24.219398 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_data"
[0m14:18:24.221842 [debug] [ThreadPool]: On create_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_dbt_dev_data"} */
create schema if not exists "dev_data"
[0m14:18:24.231044 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.007 seconds
[0m14:18:24.238475 [debug] [ThreadPool]: On create_dbt_dev_data: COMMIT
[0m14:18:24.241141 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_data"
[0m14:18:24.243315 [debug] [ThreadPool]: On create_dbt_dev_data: COMMIT
[0m14:18:24.251911 [debug] [ThreadPool]: SQL status: COMMIT in 0.007 seconds
[0m14:18:24.254677 [debug] [ThreadPool]: On create_dbt_dev_data: Close
[0m14:18:24.267614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_dev_data, now list_dbt_dev)
[0m14:18:24.318870 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m14:18:24.322114 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m14:18:24.324817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:24.405788 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m14:18:24.410456 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m14:18:24.412786 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:18:24.452577 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.037 seconds
[0m14:18:24.464923 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m14:18:24.473373 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m14:18:24.478763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_dev, now list_dbt_dev_data)
[0m14:18:24.509746 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m14:18:24.514794 [debug] [ThreadPool]: On list_dbt_dev_data: BEGIN
[0m14:18:24.516248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:24.593766 [debug] [ThreadPool]: SQL status: BEGIN in 0.077 seconds
[0m14:18:24.596929 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m14:18:24.599092 [debug] [ThreadPool]: On list_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev_data"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_data'
  
[0m14:18:24.631539 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.029 seconds
[0m14:18:24.641933 [debug] [ThreadPool]: On list_dbt_dev_data: ROLLBACK
[0m14:18:24.647036 [debug] [ThreadPool]: On list_dbt_dev_data: Close
[0m14:18:24.674863 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:24.677573 [debug] [MainThread]: On master: BEGIN
[0m14:18:24.679959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:24.765829 [debug] [MainThread]: SQL status: BEGIN in 0.085 seconds
[0m14:18:24.769329 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:24.773499 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:18:24.838938 [debug] [MainThread]: SQL status: SELECT 1 in 0.062 seconds
[0m14:18:24.852518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8014a94-9a81-4bde-b8ab-583fb3c005c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077474d0>]}
[0m14:18:24.855666 [debug] [MainThread]: On master: ROLLBACK
[0m14:18:24.862083 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:24.864706 [debug] [MainThread]: On master: BEGIN
[0m14:18:24.872921 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:18:24.876558 [debug] [MainThread]: On master: COMMIT
[0m14:18:24.878380 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:24.880508 [debug] [MainThread]: On master: COMMIT
[0m14:18:24.886720 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:18:24.889429 [debug] [MainThread]: On master: Close
[0m14:18:24.892956 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:24.896076 [info ] [MainThread]: 
[0m14:18:24.920291 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.jaffle_shop_customers
[0m14:18:24.925690 [info ] [Thread-1 (]: 1 of 3 START seed file dev_data.jaffle_shop_customers .......................... [RUN]
[0m14:18:24.929155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev_data, now seed.jaffle_shop.jaffle_shop_customers)
[0m14:18:24.932067 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.jaffle_shop_customers
[0m14:18:24.936402 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.jaffle_shop_customers
[0m14:18:25.161839 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_customers"
[0m14:18:25.164245 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_customers: BEGIN
[0m14:18:25.164642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:25.228534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m14:18:25.231574 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_customers"
[0m14:18:25.235713 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.jaffle_shop_customers"} */

    create table "dbt"."dev_data"."jaffle_shop_customers" ("id" integer,"first_name" text,"last_name" text)
  
[0m14:18:25.269150 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.029 seconds
[0m14:18:25.767358 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_customers"
[0m14:18:25.770642 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_customers: 
          insert into "dbt"."dev_data"."jaffle_shop_customers" ("id", "first_name", "last_name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m14:18:25.782162 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.009 seconds
[0m14:18:25.828230 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.jaffle_shop_customers"
[0m14:18:25.989190 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_customers: COMMIT
[0m14:18:25.993242 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_customers"
[0m14:18:25.995501 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_customers: COMMIT
[0m14:18:26.001327 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:18:26.018813 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_customers: Close
[0m14:18:26.028124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8014a94-9a81-4bde-b8ab-583fb3c005c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb0680>]}
[0m14:18:26.031656 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file dev_data.jaffle_shop_customers ...................... [[32mINSERT 100[0m in 1.09s]
[0m14:18:26.035289 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.jaffle_shop_customers
[0m14:18:26.038234 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.jaffle_shop_orders
[0m14:18:26.045519 [info ] [Thread-1 (]: 2 of 3 START seed file dev_data.jaffle_shop_orders ............................. [RUN]
[0m14:18:26.051429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.jaffle_shop_customers, now seed.jaffle_shop.jaffle_shop_orders)
[0m14:18:26.052455 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.jaffle_shop_orders
[0m14:18:26.053194 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.jaffle_shop_orders
[0m14:18:26.066120 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_orders"
[0m14:18:26.073278 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_orders: BEGIN
[0m14:18:26.077153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:26.168419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.090 seconds
[0m14:18:26.175231 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_orders"
[0m14:18:26.178689 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.jaffle_shop_orders"} */

    create table "dbt"."dev_data"."jaffle_shop_orders" ("id" integer,"user_id" integer,"order_date" date,"status" text)
  
[0m14:18:26.226013 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.036 seconds
[0m14:18:26.426352 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_orders"
[0m14:18:26.429855 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_orders: 
          insert into "dbt"."dev_data"."jaffle_shop_orders" ("id", "user_id", "order_date", "status") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m14:18:26.444112 [debug] [Thread-1 (]: SQL status: INSERT 0 99 in 0.010 seconds
[0m14:18:26.448814 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.jaffle_shop_orders"
[0m14:18:26.467322 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_orders: COMMIT
[0m14:18:26.471933 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.jaffle_shop_orders"
[0m14:18:26.475528 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_orders: COMMIT
[0m14:18:26.483025 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:18:26.488235 [debug] [Thread-1 (]: On seed.jaffle_shop.jaffle_shop_orders: Close
[0m14:18:26.491149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8014a94-9a81-4bde-b8ab-583fb3c005c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107795630>]}
[0m14:18:26.494455 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file dev_data.jaffle_shop_orders ......................... [[32mINSERT 99[0m in 0.44s]
[0m14:18:26.498961 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.jaffle_shop_orders
[0m14:18:26.502335 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.stripe_payments
[0m14:18:26.512423 [info ] [Thread-1 (]: 3 of 3 START seed file dev_data.stripe_payments ................................ [RUN]
[0m14:18:26.517653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.jaffle_shop_orders, now seed.jaffle_shop.stripe_payments)
[0m14:18:26.517907 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.stripe_payments
[0m14:18:26.518087 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.stripe_payments
[0m14:18:26.525205 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.stripe_payments"
[0m14:18:26.525489 [debug] [Thread-1 (]: On seed.jaffle_shop.stripe_payments: BEGIN
[0m14:18:26.526091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:26.657869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.129 seconds
[0m14:18:26.663827 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.stripe_payments"
[0m14:18:26.665363 [debug] [Thread-1 (]: On seed.jaffle_shop.stripe_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.stripe_payments"} */

    create table "dbt"."dev_data"."stripe_payments" ("id" integer,"orderid" integer,"paymentmethod" text,"status" text,"amount" integer,"created" date)
  
[0m14:18:26.781526 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.103 seconds
[0m14:18:27.995891 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.stripe_payments"
[0m14:18:27.999856 [debug] [Thread-1 (]: On seed.jaffle_shop.stripe_payments: 
          insert into "dbt"."dev_data"."stripe_payments" ("id", "orderid", "paymentmethod", "status", "amount", "created") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m14:18:28.016514 [debug] [Thread-1 (]: SQL status: INSERT 0 120 in 0.013 seconds
[0m14:18:28.023041 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.stripe_payments"
[0m14:18:28.038517 [debug] [Thread-1 (]: On seed.jaffle_shop.stripe_payments: COMMIT
[0m14:18:28.041508 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.stripe_payments"
[0m14:18:28.045488 [debug] [Thread-1 (]: On seed.jaffle_shop.stripe_payments: COMMIT
[0m14:18:28.050606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:18:28.055379 [debug] [Thread-1 (]: On seed.jaffle_shop.stripe_payments: Close
[0m14:18:28.060200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8014a94-9a81-4bde-b8ab-583fb3c005c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b8f4d0>]}
[0m14:18:28.063921 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file dev_data.stripe_payments ............................ [[32mINSERT 120[0m in 1.54s]
[0m14:18:28.067525 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.stripe_payments
[0m14:18:28.080161 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:28.084254 [debug] [MainThread]: On master: BEGIN
[0m14:18:28.086451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:28.140609 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m14:18:28.144166 [debug] [MainThread]: On master: COMMIT
[0m14:18:28.146023 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:28.148380 [debug] [MainThread]: On master: COMMIT
[0m14:18:28.152710 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:18:28.154763 [debug] [MainThread]: On master: Close
[0m14:18:28.158755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:28.161298 [debug] [MainThread]: Connection 'seed.jaffle_shop.stripe_payments' was properly closed.
[0m14:18:28.164371 [info ] [MainThread]: 
[0m14:18:28.172865 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m14:18:28.188133 [debug] [MainThread]: Command end result
[0m14:18:28.451527 [info ] [MainThread]: 
[0m14:18:28.457679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:28.460218 [info ] [MainThread]: 
[0m14:18:28.464990 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:18:28.492455 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 10.743582, "process_user_time": 2.984934, "process_kernel_time": 4.181916, "process_mem_max_rss": "118177792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:18:28.497042 [debug] [MainThread]: Command `dbt seed` succeeded at 14:18:28.496265 after 10.75 seconds
[0m14:18:28.511008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b31240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025b9da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076911f0>]}
[0m14:18:28.515475 [debug] [MainThread]: Flushing usage events
[0m20:49:17.323420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aadfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10440bd90>]}


============================== 20:49:17.326749 | f9b2c25b-99b5-41a3-938a-d3bf3d8a341d ==============================
[0m20:49:17.326749 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:49:17.327079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:49:17.327289 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m20:49:17.327453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f9b2c25b-99b5-41a3-938a-d3bf3d8a341d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104440d60>]}
[0m20:49:17.408008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9b2c25b-99b5-41a3-938a-d3bf3d8a341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040fb8a0>]}
[0m20:49:17.432462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9b2c25b-99b5-41a3-938a-d3bf3d8a341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b7550>]}
[0m20:49:17.433202 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:49:17.444958 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:49:17.503528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:49:17.503773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:49:17.506174 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m20:49:17.519306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9b2c25b-99b5-41a3-938a-d3bf3d8a341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad4d70>]}
[0m20:49:17.566631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9b2c25b-99b5-41a3-938a-d3bf3d8a341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f7e70>]}
[0m20:49:17.566910 [info ] [MainThread]: Found 1 model, 1 source, 423 macros
[0m20:49:17.567080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9b2c25b-99b5-41a3-938a-d3bf3d8a341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448aa90>]}
[0m20:49:17.567933 [info ] [MainThread]: 
[0m20:49:17.568227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:49:17.568982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m20:49:17.618032 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m20:49:17.618273 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m20:49:17.618417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:17.652071 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.034 seconds
[0m20:49:17.652955 [debug] [ThreadPool]: On list_dbt: Close
[0m20:49:17.653679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m20:49:17.656859 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m20:49:17.657049 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m20:49:17.657193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:17.664700 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:49:17.664958 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m20:49:17.665134 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:49:17.676106 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.011 seconds
[0m20:49:17.677027 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m20:49:17.677519 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m20:49:17.680390 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:17.680613 [debug] [MainThread]: On master: BEGIN
[0m20:49:17.680764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:17.687335 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:49:17.687581 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:17.687824 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:49:17.696363 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m20:49:17.697419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9b2c25b-99b5-41a3-938a-d3bf3d8a341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abf7d0>]}
[0m20:49:17.697685 [debug] [MainThread]: On master: ROLLBACK
[0m20:49:17.698131 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:17.698320 [debug] [MainThread]: On master: BEGIN
[0m20:49:17.698902 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:49:17.699074 [debug] [MainThread]: On master: COMMIT
[0m20:49:17.699236 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:17.699385 [debug] [MainThread]: On master: COMMIT
[0m20:49:17.699756 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:49:17.699911 [debug] [MainThread]: On master: Close
[0m20:49:17.700165 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:49:17.700346 [info ] [MainThread]: 
[0m20:49:17.702124 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:49:17.702442 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.stg_customers .................................. [RUN]
[0m20:49:17.702711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m20:49:17.702901 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:49:17.707804 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:49:17.708966 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:49:17.732091 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:49:17.733263 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m20:49:17.733444 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m20:49:17.733600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:17.743606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:49:17.743884 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m20:49:17.744074 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."jaffle_shop_customers"
  );
[0m20:49:17.745021 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev_data.jaffle_shop_customers" does not exist
LINE 12:    "dbt"."dev_data"."jaffle_shop_customers"
            ^

[0m20:49:17.745256 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m20:49:17.745684 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m20:49:17.751699 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "dev_data.jaffle_shop_customers" does not exist
  LINE 12:    "dbt"."dev_data"."jaffle_shop_customers"
              ^
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m20:49:17.752537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9b2c25b-99b5-41a3-938a-d3bf3d8a341d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a0ec0>]}
[0m20:49:17.752870 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dev.stg_customers ......................... [[31mERROR[0m in 0.05s]
[0m20:49:17.753170 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:49:17.754050 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:17.754193 [debug] [MainThread]: On master: BEGIN
[0m20:49:17.754313 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:17.760572 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m20:49:17.760826 [debug] [MainThread]: On master: COMMIT
[0m20:49:17.760970 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:17.761101 [debug] [MainThread]: On master: COMMIT
[0m20:49:17.761413 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:49:17.761590 [debug] [MainThread]: On master: Close
[0m20:49:17.761805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:17.761939 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m20:49:17.762089 [info ] [MainThread]: 
[0m20:49:17.762249 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m20:49:17.762570 [debug] [MainThread]: Command end result
[0m20:49:17.776096 [info ] [MainThread]: 
[0m20:49:17.776375 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:49:17.776526 [info ] [MainThread]: 
[0m20:49:17.776711 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "dev_data.jaffle_shop_customers" does not exist
  LINE 12:    "dbt"."dev_data"."jaffle_shop_customers"
              ^
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m20:49:17.776855 [info ] [MainThread]: 
[0m20:49:17.777001 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:49:17.779165 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.48774508, "process_user_time": 0.861207, "process_kernel_time": 0.154194, "process_mem_max_rss": "114262016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:49:17.779722 [debug] [MainThread]: Command `dbt run` failed at 20:49:17.779665 after 0.49 seconds
[0m20:49:17.779939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105368c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049385d0>]}
[0m20:49:17.780117 [debug] [MainThread]: Flushing usage events
[0m21:17:16.342548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ffed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ffd90>]}


============================== 21:17:16.349246 | f5bfd35a-a7f9-4294-82b8-79288d5f05dc ==============================
[0m21:17:16.349246 [info ] [MainThread]: Running with dbt=1.8.8
[0m21:17:16.349559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:17:16.349771 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m21:17:16.349948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f5bfd35a-a7f9-4294-82b8-79288d5f05dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a434d60>]}
[0m21:17:16.478029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5bfd35a-a7f9-4294-82b8-79288d5f05dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ef8a0>]}
[0m21:17:16.501842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5bfd35a-a7f9-4294-82b8-79288d5f05dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ab550>]}
[0m21:17:16.502558 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:17:16.512422 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m21:17:16.572596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:17:16.572858 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:17:16.575435 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m21:17:16.587775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5bfd35a-a7f9-4294-82b8-79288d5f05dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0bcd70>]}
[0m21:17:16.635166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5bfd35a-a7f9-4294-82b8-79288d5f05dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4ebe70>]}
[0m21:17:16.635443 [info ] [MainThread]: Found 1 model, 1 source, 423 macros
[0m21:17:16.635609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5bfd35a-a7f9-4294-82b8-79288d5f05dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a47ea90>]}
[0m21:17:16.636455 [info ] [MainThread]: 
[0m21:17:16.636741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:17:16.637508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m21:17:16.687828 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m21:17:16.688064 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m21:17:16.688208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:16.851488 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.163 seconds
[0m21:17:16.852840 [debug] [ThreadPool]: On list_dbt: Close
[0m21:17:16.853891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m21:17:16.858509 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m21:17:16.858800 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m21:17:16.859002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:17:16.869779 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m21:17:16.870086 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m21:17:16.870311 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m21:17:16.877201 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m21:17:16.878371 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m21:17:16.879082 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m21:17:16.882452 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:16.882748 [debug] [MainThread]: On master: BEGIN
[0m21:17:16.882943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:17:16.897792 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m21:17:16.898103 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:16.898364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:17:16.902985 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m21:17:16.903915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5bfd35a-a7f9-4294-82b8-79288d5f05dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0a77d0>]}
[0m21:17:16.904207 [debug] [MainThread]: On master: ROLLBACK
[0m21:17:16.904742 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:16.904916 [debug] [MainThread]: On master: BEGIN
[0m21:17:16.905567 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:17:16.905769 [debug] [MainThread]: On master: COMMIT
[0m21:17:16.905930 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:16.906082 [debug] [MainThread]: On master: COMMIT
[0m21:17:16.906474 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:17:16.906635 [debug] [MainThread]: On master: Close
[0m21:17:16.906959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:17:16.907346 [info ] [MainThread]: 
[0m21:17:16.909127 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m21:17:16.909487 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.stg_customers .................................. [RUN]
[0m21:17:16.909766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m21:17:16.909955 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m21:17:16.918596 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m21:17:16.919522 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m21:17:16.940592 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m21:17:16.941358 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m21:17:16.941561 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m21:17:16.941725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:16.951541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m21:17:16.951815 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m21:17:16.951989 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m21:17:16.959118 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m21:17:16.962546 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m21:17:16.962805 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:17:16.964139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:17:16.971967 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m21:17:16.972225 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m21:17:16.972386 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m21:17:16.973664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:17:16.976643 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m21:17:16.978949 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m21:17:16.979133 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m21:17:16.979668 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:17:16.980807 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m21:17:16.981501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5bfd35a-a7f9-4294-82b8-79288d5f05dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c450730>]}
[0m21:17:16.981819 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m21:17:16.982282 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m21:17:16.982951 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:16.983134 [debug] [MainThread]: On master: BEGIN
[0m21:17:16.983279 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:17:16.990286 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:17:16.990551 [debug] [MainThread]: On master: COMMIT
[0m21:17:16.990697 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:16.990829 [debug] [MainThread]: On master: COMMIT
[0m21:17:16.991187 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:17:16.991332 [debug] [MainThread]: On master: Close
[0m21:17:16.991549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:16.991678 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m21:17:16.991845 [info ] [MainThread]: 
[0m21:17:16.992091 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m21:17:16.993563 [debug] [MainThread]: Command end result
[0m21:17:17.017992 [info ] [MainThread]: 
[0m21:17:17.018323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:17:17.018489 [info ] [MainThread]: 
[0m21:17:17.018650 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:17:17.030654 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.72757137, "process_user_time": 0.911161, "process_kernel_time": 0.216856, "process_mem_max_rss": "109019136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:17:17.031190 [debug] [MainThread]: Command `dbt run` succeeded at 21:17:17.031126 after 0.73 seconds
[0m21:17:17.031419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106305770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c486960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a516c50>]}
[0m21:17:17.031619 [debug] [MainThread]: Flushing usage events
[0m18:49:23.203398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103205fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b63ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b63d90>]}


============================== 18:49:23.208796 | 2b06bbce-d678-4884-999c-35350f6b448d ==============================
[0m18:49:23.208796 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:49:23.209131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'version_check': 'True', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:49:23.209348 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m18:49:23.209508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2b06bbce-d678-4884-999c-35350f6b448d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b98d60>]}
[0m18:49:23.303328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b06bbce-d678-4884-999c-35350f6b448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048538a0>]}
[0m18:49:23.326745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b06bbce-d678-4884-999c-35350f6b448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490f550>]}
[0m18:49:23.327316 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:49:23.336926 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:49:23.375502 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:49:23.375834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b06bbce-d678-4884-999c-35350f6b448d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bc500>]}
[0m18:49:23.789696 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.stg_payments' (models/staging/stg_payments.sql) depends on a source named 'stripe.payment' which was not found
[0m18:49:23.849186 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6850493, "process_user_time": 1.090785, "process_kernel_time": 0.13631, "process_mem_max_rss": "108003328", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:49:23.849726 [debug] [MainThread]: Command `dbt run` failed at 18:49:23.849647 after 0.69 seconds
[0m18:49:23.850026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ffe70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f20590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9bad0>]}
[0m18:49:23.850268 [debug] [MainThread]: Flushing usage events
[0m18:49:46.981162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030e9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a43ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a43d90>]}


============================== 18:49:46.984109 | 401ce659-c705-4b3c-834f-3cec9245fd4b ==============================
[0m18:49:46.984109 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:49:46.984457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:49:46.984677 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m18:49:46.984845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '401ce659-c705-4b3c-834f-3cec9245fd4b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7cd60>]}
[0m18:49:47.061965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '401ce659-c705-4b3c-834f-3cec9245fd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047378a0>]}
[0m18:49:47.085123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '401ce659-c705-4b3c-834f-3cec9245fd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f7550>]}
[0m18:49:47.086598 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:49:47.096262 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:49:47.134404 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:49:47.134722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '401ce659-c705-4b3c-834f-3cec9245fd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105110500>]}
[0m18:49:47.548603 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.jaffle_shop.stg_payments' (models/staging/stg_payments.sql) depends on a source named 'stripe.payment' which was not found
[0m18:49:47.550420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6011442, "process_user_time": 1.108406, "process_kernel_time": 0.123277, "process_mem_max_rss": "109051904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:49:47.550738 [debug] [MainThread]: Command `dbt run` failed at 18:49:47.550685 after 0.60 seconds
[0m18:49:47.550939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e7e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105677ad0>]}
[0m18:49:47.551114 [debug] [MainThread]: Flushing usage events
[0m18:50:07.429554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108757ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108757d90>]}


============================== 18:50:07.432759 | a708ed50-c76b-40a1-8edd-2fcf2629cceb ==============================
[0m18:50:07.432759 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:50:07.433146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:50:07.433376 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m18:50:07.433541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a708ed50-c76b-40a1-8edd-2fcf2629cceb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108788d60>]}
[0m18:50:07.511593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a708ed50-c76b-40a1-8edd-2fcf2629cceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084478a0>]}
[0m18:50:07.534419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a708ed50-c76b-40a1-8edd-2fcf2629cceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108503550>]}
[0m18:50:07.534912 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:50:07.543869 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:50:07.582841 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:50:07.583166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a708ed50-c76b-40a1-8edd-2fcf2629cceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e20500>]}
[0m18:50:08.029603 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.marts
- seeds.jaffle_shop
[0m18:50:08.034533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a708ed50-c76b-40a1-8edd-2fcf2629cceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d9d630>]}
[0m18:50:08.108217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a708ed50-c76b-40a1-8edd-2fcf2629cceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093aab60>]}
[0m18:50:08.108483 [info ] [MainThread]: Found 3 models, 3 sources, 423 macros
[0m18:50:08.108649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a708ed50-c76b-40a1-8edd-2fcf2629cceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10954d610>]}
[0m18:50:08.109501 [info ] [MainThread]: 
[0m18:50:08.109770 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:08.111539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m18:50:08.156370 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m18:50:08.156595 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m18:50:08.156733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:08.290545 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.134 seconds
[0m18:50:08.291461 [debug] [ThreadPool]: On list_dbt: Close
[0m18:50:08.292273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m18:50:08.295553 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m18:50:08.295751 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m18:50:08.295903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:08.302863 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:50:08.303052 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m18:50:08.303207 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:50:08.308411 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m18:50:08.309254 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m18:50:08.311262 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m18:50:08.314031 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:08.314238 [debug] [MainThread]: On master: BEGIN
[0m18:50:08.314384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:08.322079 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:50:08.322306 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:08.322542 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:08.328961 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m18:50:08.329803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a708ed50-c76b-40a1-8edd-2fcf2629cceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109454f70>]}
[0m18:50:08.330063 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:08.330479 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:08.330696 [debug] [MainThread]: On master: BEGIN
[0m18:50:08.331244 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:50:08.331399 [debug] [MainThread]: On master: COMMIT
[0m18:50:08.331542 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:08.331681 [debug] [MainThread]: On master: COMMIT
[0m18:50:08.331990 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:08.332131 [debug] [MainThread]: On master: Close
[0m18:50:08.332360 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:08.332523 [info ] [MainThread]: 
[0m18:50:08.334567 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m18:50:08.334908 [info ] [Thread-1 (]: 1 of 3 START sql view model dev.stg_customers .................................. [RUN]
[0m18:50:08.335176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m18:50:08.335371 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m18:50:08.339609 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m18:50:08.340444 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m18:50:08.359177 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m18:50:08.360423 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m18:50:08.360747 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m18:50:08.360931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:08.367075 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:50:08.367309 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m18:50:08.367479 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m18:50:08.379589 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m18:50:08.383195 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m18:50:08.383415 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:50:08.384556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:50:08.386213 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m18:50:08.386407 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:50:08.386894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:50:08.396490 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m18:50:08.396758 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m18:50:08.396940 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m18:50:08.399239 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:50:08.402455 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m18:50:08.404963 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m18:50:08.405162 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m18:50:08.408325 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:50:08.409603 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m18:50:08.410385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a708ed50-c76b-40a1-8edd-2fcf2629cceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d063f0>]}
[0m18:50:08.410711 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m18:50:08.411022 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m18:50:08.411232 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m18:50:08.411488 [info ] [Thread-1 (]: 2 of 3 START sql view model dev.stg_orders ..................................... [RUN]
[0m18:50:08.411703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m18:50:08.411873 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m18:50:08.413437 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m18:50:08.413863 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m18:50:08.415348 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m18:50:08.415708 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m18:50:08.415873 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m18:50:08.416026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:08.422700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:50:08.422982 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m18:50:08.423159 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m18:50:08.424197 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m18:50:08.426078 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m18:50:08.426286 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m18:50:08.426950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:50:08.427691 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m18:50:08.427872 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m18:50:08.428030 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m18:50:08.428834 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:50:08.430078 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m18:50:08.430400 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m18:50:08.430563 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m18:50:08.431012 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m18:50:08.431660 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m18:50:08.431919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a708ed50-c76b-40a1-8edd-2fcf2629cceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109767250>]}
[0m18:50:08.432223 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.02s]
[0m18:50:08.432504 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m18:50:08.432699 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m18:50:08.432945 [info ] [Thread-1 (]: 3 of 3 START sql view model dev.stg_payments ................................... [RUN]
[0m18:50:08.433155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m18:50:08.433312 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m18:50:08.434540 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m18:50:08.435016 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m18:50:08.438160 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m18:50:08.438557 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m18:50:08.438720 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m18:50:08.438868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:08.446051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:50:08.446296 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m18:50:08.446507 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    amount / 100 as amount,
    created as created_at
from "dbt"."dev_data"."payment"
  );
[0m18:50:08.449824 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev_data.payment" does not exist
LINE 15: from "dbt"."dev_data"."payment"
              ^

[0m18:50:08.449995 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: ROLLBACK
[0m18:50:08.450424 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m18:50:08.457080 [debug] [Thread-1 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "dev_data.payment" does not exist
  LINE 15: from "dbt"."dev_data"."payment"
                ^
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m18:50:08.457472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a708ed50-c76b-40a1-8edd-2fcf2629cceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d6040>]}
[0m18:50:08.458356 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model dev.stg_payments .......................... [[31mERROR[0m in 0.02s]
[0m18:50:08.458788 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m18:50:08.459738 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:08.459916 [debug] [MainThread]: On master: BEGIN
[0m18:50:08.460051 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:08.466335 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:50:08.466564 [debug] [MainThread]: On master: COMMIT
[0m18:50:08.466697 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:08.466818 [debug] [MainThread]: On master: COMMIT
[0m18:50:08.467124 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:08.467300 [debug] [MainThread]: On master: Close
[0m18:50:08.467515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:08.467647 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m18:50:08.467829 [info ] [MainThread]: 
[0m18:50:08.467988 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:50:08.468421 [debug] [MainThread]: Command end result
[0m18:50:08.481807 [info ] [MainThread]: 
[0m18:50:08.482045 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:50:08.482183 [info ] [MainThread]: 
[0m18:50:08.482361 [error] [MainThread]:   Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "dev_data.payment" does not exist
  LINE 15: from "dbt"."dev_data"."payment"
                ^
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m18:50:08.482500 [info ] [MainThread]: 
[0m18:50:08.482635 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:50:08.484120 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0922204, "process_user_time": 1.342682, "process_kernel_time": 0.1697, "process_mem_max_rss": "119029760", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:50:08.484376 [debug] [MainThread]: Command `dbt run` failed at 18:50:08.484332 after 1.09 seconds
[0m18:50:08.484552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109511df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098fbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098fbad0>]}
[0m18:50:08.484711 [debug] [MainThread]: Flushing usage events
[0m18:50:30.260308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106735fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108093ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108093d90>]}


============================== 18:50:30.263433 | 2669ee33-5348-4d7d-a666-16839f015131 ==============================
[0m18:50:30.263433 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:50:30.263773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:50:30.263986 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m18:50:30.264143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2669ee33-5348-4d7d-a666-16839f015131', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c8d60>]}
[0m18:50:30.344539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2669ee33-5348-4d7d-a666-16839f015131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d838a0>]}
[0m18:50:30.367489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2669ee33-5348-4d7d-a666-16839f015131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3f550>]}
[0m18:50:30.367974 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:50:30.376568 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:50:30.436877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:50:30.437376 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/sources.yml
[0m18:50:30.438164 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_payments.sql
[0m18:50:30.571442 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.marts
- seeds.jaffle_shop
[0m18:50:30.576309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2669ee33-5348-4d7d-a666-16839f015131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108763020>]}
[0m18:50:30.618076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2669ee33-5348-4d7d-a666-16839f015131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e95fd0>]}
[0m18:50:30.618348 [info ] [MainThread]: Found 3 models, 3 sources, 423 macros
[0m18:50:30.618517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2669ee33-5348-4d7d-a666-16839f015131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d62340>]}
[0m18:50:30.619428 [info ] [MainThread]: 
[0m18:50:30.619697 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:30.621503 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m18:50:30.655332 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m18:50:30.655596 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m18:50:30.655743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:30.678067 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.022 seconds
[0m18:50:30.678884 [debug] [ThreadPool]: On list_dbt: Close
[0m18:50:30.679526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m18:50:30.682245 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m18:50:30.682408 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m18:50:30.682537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:30.691255 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:50:30.691504 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m18:50:30.691675 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:50:30.694423 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m18:50:30.695198 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m18:50:30.695652 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m18:50:30.698214 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:30.698412 [debug] [MainThread]: On master: BEGIN
[0m18:50:30.698555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:30.705670 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:50:30.705874 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:30.706090 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:30.711929 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m18:50:30.712691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2669ee33-5348-4d7d-a666-16839f015131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e53f50>]}
[0m18:50:30.712948 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:30.713399 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:30.713602 [debug] [MainThread]: On master: BEGIN
[0m18:50:30.714292 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:50:30.714456 [debug] [MainThread]: On master: COMMIT
[0m18:50:30.714599 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:30.714736 [debug] [MainThread]: On master: COMMIT
[0m18:50:30.715164 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:30.715353 [debug] [MainThread]: On master: Close
[0m18:50:30.715613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:30.715807 [info ] [MainThread]: 
[0m18:50:30.717311 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m18:50:30.717626 [info ] [Thread-1 (]: 1 of 3 START sql view model dev.stg_customers .................................. [RUN]
[0m18:50:30.717881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m18:50:30.718066 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m18:50:30.722866 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m18:50:30.723408 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m18:50:30.741651 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m18:50:30.742196 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m18:50:30.742371 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m18:50:30.742524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:30.753002 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m18:50:30.753201 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m18:50:30.753381 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m18:50:30.756178 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:50:30.760073 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m18:50:30.760344 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m18:50:30.761429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:50:30.763255 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m18:50:30.763478 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m18:50:30.764175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:50:30.773169 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m18:50:30.773379 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m18:50:30.773541 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m18:50:30.775248 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:50:30.778216 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m18:50:30.780546 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m18:50:30.780735 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m18:50:30.783428 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:50:30.784620 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m18:50:30.785357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2669ee33-5348-4d7d-a666-16839f015131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f09f40>]}
[0m18:50:30.785683 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m18:50:30.785992 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m18:50:30.786205 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m18:50:30.786486 [info ] [Thread-1 (]: 2 of 3 START sql view model dev.stg_orders ..................................... [RUN]
[0m18:50:30.786730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m18:50:30.786913 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m18:50:30.788159 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m18:50:30.788599 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m18:50:30.790422 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m18:50:30.790785 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m18:50:30.790944 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m18:50:30.791088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:30.799014 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m18:50:30.799282 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m18:50:30.799446 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m18:50:30.800463 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m18:50:30.802015 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m18:50:30.802202 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m18:50:30.803446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:50:30.804693 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m18:50:30.804861 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m18:50:30.806234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:50:30.807350 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m18:50:30.807521 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m18:50:30.807675 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m18:50:30.809251 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:50:30.810238 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m18:50:30.810556 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m18:50:30.810720 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m18:50:30.813139 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:50:30.813777 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m18:50:30.814036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2669ee33-5348-4d7d-a666-16839f015131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1bd90>]}
[0m18:50:30.814330 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.03s]
[0m18:50:30.814608 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m18:50:30.814809 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m18:50:30.815076 [info ] [Thread-1 (]: 3 of 3 START sql view model dev.stg_payments ................................... [RUN]
[0m18:50:30.815322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m18:50:30.815507 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m18:50:30.816783 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m18:50:30.817192 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m18:50:30.818987 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m18:50:30.819338 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m18:50:30.819507 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m18:50:30.819660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:30.828465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m18:50:30.828720 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m18:50:30.828900 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    amount / 100 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m18:50:30.830222 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m18:50:30.831714 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m18:50:30.831891 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m18:50:30.832350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:50:30.833112 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m18:50:30.833301 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m18:50:30.833464 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m18:50:30.834358 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:50:30.835339 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m18:50:30.835677 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m18:50:30.835859 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m18:50:30.836994 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:50:30.837709 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m18:50:30.837986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2669ee33-5348-4d7d-a666-16839f015131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091df250>]}
[0m18:50:30.838298 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.02s]
[0m18:50:30.838592 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m18:50:30.839232 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:30.839431 [debug] [MainThread]: On master: BEGIN
[0m18:50:30.839582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:30.846946 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:50:30.847172 [debug] [MainThread]: On master: COMMIT
[0m18:50:30.847326 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:30.847471 [debug] [MainThread]: On master: COMMIT
[0m18:50:30.847859 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:30.848045 [debug] [MainThread]: On master: Close
[0m18:50:30.848280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:30.848428 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m18:50:30.848627 [info ] [MainThread]: 
[0m18:50:30.848811 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:50:30.849381 [debug] [MainThread]: Command end result
[0m18:50:30.863909 [info ] [MainThread]: 
[0m18:50:30.864185 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:50:30.864342 [info ] [MainThread]: 
[0m18:50:30.864878 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:50:30.866493 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.64002, "process_user_time": 1.028148, "process_kernel_time": 0.153276, "process_mem_max_rss": "119865344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:50:30.866779 [debug] [MainThread]: Command `dbt run` succeeded at 18:50:30.866733 after 0.64 seconds
[0m18:50:30.866967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104429da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087771c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4deb0>]}
[0m18:50:30.867148 [debug] [MainThread]: Flushing usage events
[0m19:07:39.869111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a51fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ffed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ffd90>]}


============================== 19:07:39.877522 | 3d3470ca-6cf8-49db-99bc-c57c3173bdf7 ==============================
[0m19:07:39.877522 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:07:39.877837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:07:39.878066 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:07:39.878225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d3470ca-6cf8-49db-99bc-c57c3173bdf7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106234d60>]}
[0m19:07:39.969449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d3470ca-6cf8-49db-99bc-c57c3173bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eef8a0>]}
[0m19:07:39.994323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d3470ca-6cf8-49db-99bc-c57c3173bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060eb550>]}
[0m19:07:39.995134 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:07:40.004825 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m19:07:40.064351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:07:40.064667 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/marts/dim_customers.sql
[0m19:07:40.160347 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m19:07:40.165812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d3470ca-6cf8-49db-99bc-c57c3173bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f57110>]}
[0m19:07:40.210718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d3470ca-6cf8-49db-99bc-c57c3173bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107178670>]}
[0m19:07:40.211010 [info ] [MainThread]: Found 4 models, 3 sources, 423 macros
[0m19:07:40.211173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d3470ca-6cf8-49db-99bc-c57c3173bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d4d50>]}
[0m19:07:40.212428 [info ] [MainThread]: 
[0m19:07:40.212717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:07:40.214492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m19:07:40.260135 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m19:07:40.260370 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m19:07:40.260513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:40.405809 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.145 seconds
[0m19:07:40.407093 [debug] [ThreadPool]: On list_dbt: Close
[0m19:07:40.408193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m19:07:40.412515 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m19:07:40.412781 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m19:07:40.412975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:07:40.426878 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m19:07:40.427175 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m19:07:40.427397 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m19:07:40.431184 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m19:07:40.432183 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m19:07:40.432668 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m19:07:40.436049 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:40.436309 [debug] [MainThread]: On master: BEGIN
[0m19:07:40.436489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:07:40.444980 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m19:07:40.445287 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:40.445565 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:07:40.450106 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m19:07:40.451133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d3470ca-6cf8-49db-99bc-c57c3173bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10713fd10>]}
[0m19:07:40.451443 [debug] [MainThread]: On master: ROLLBACK
[0m19:07:40.451933 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:40.452117 [debug] [MainThread]: On master: BEGIN
[0m19:07:40.452833 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:07:40.453096 [debug] [MainThread]: On master: COMMIT
[0m19:07:40.453311 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:40.453487 [debug] [MainThread]: On master: COMMIT
[0m19:07:40.453924 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:07:40.454116 [debug] [MainThread]: On master: Close
[0m19:07:40.454469 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:07:40.454752 [info ] [MainThread]: 
[0m19:07:40.456492 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m19:07:40.456903 [info ] [Thread-1 (]: 1 of 3 START sql view model dev.stg_customers .................................. [RUN]
[0m19:07:40.457228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m19:07:40.457445 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m19:07:40.462980 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m19:07:40.463768 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m19:07:40.486080 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m19:07:40.487164 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:07:40.487463 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m19:07:40.487645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:40.495792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m19:07:40.496061 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:07:40.496233 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m19:07:40.499149 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:07:40.502316 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:07:40.502510 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:07:40.503163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:07:40.504545 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:07:40.504826 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:07:40.505405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:07:40.515125 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m19:07:40.515394 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:07:40.515562 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m19:07:40.518902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:07:40.522075 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m19:07:40.529929 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:07:40.530184 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m19:07:40.533048 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:07:40.534244 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m19:07:40.534943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3470ca-6cf8-49db-99bc-c57c3173bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c5a70>]}
[0m19:07:40.535254 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m19:07:40.535564 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m19:07:40.535822 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m19:07:40.536140 [info ] [Thread-1 (]: 2 of 3 START sql view model dev.stg_orders ..................................... [RUN]
[0m19:07:40.536414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m19:07:40.536597 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m19:07:40.538010 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m19:07:40.538693 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m19:07:40.542482 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m19:07:40.543344 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:07:40.543534 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m19:07:40.543689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:40.552554 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:07:40.552775 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:07:40.552947 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m19:07:40.555167 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:07:40.556668 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:07:40.556848 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m19:07:40.557586 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:07:40.559250 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:07:40.559450 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m19:07:40.560111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:07:40.561331 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m19:07:40.561522 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:07:40.561680 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m19:07:40.562903 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:07:40.563901 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m19:07:40.564222 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:07:40.564387 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m19:07:40.567339 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:07:40.568044 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m19:07:40.568314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3470ca-6cf8-49db-99bc-c57c3173bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743f1b0>]}
[0m19:07:40.568597 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.03s]
[0m19:07:40.568863 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m19:07:40.569056 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m19:07:40.569319 [info ] [Thread-1 (]: 3 of 3 START sql view model dev.stg_payments ................................... [RUN]
[0m19:07:40.569576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m19:07:40.569758 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m19:07:40.571216 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m19:07:40.571923 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m19:07:40.574320 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m19:07:40.576014 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m19:07:40.576257 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m19:07:40.576418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:40.584464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m19:07:40.584812 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m19:07:40.584999 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    amount / 100 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m19:07:40.586222 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m19:07:40.587699 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m19:07:40.587883 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:07:40.588456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:07:40.589785 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m19:07:40.589962 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:07:40.590442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:07:40.591367 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m19:07:40.591597 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m19:07:40.591774 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m19:07:40.592855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:07:40.594093 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m19:07:40.594407 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m19:07:40.594570 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m19:07:40.597429 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:07:40.598115 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m19:07:40.598373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d3470ca-6cf8-49db-99bc-c57c3173bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f09150>]}
[0m19:07:40.598980 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.03s]
[0m19:07:40.599248 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m19:07:40.599831 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:40.601853 [debug] [MainThread]: On master: BEGIN
[0m19:07:40.601977 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:07:40.610986 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:07:40.611362 [debug] [MainThread]: On master: COMMIT
[0m19:07:40.611522 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:40.611829 [debug] [MainThread]: On master: COMMIT
[0m19:07:40.612225 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:07:40.612716 [debug] [MainThread]: On master: Close
[0m19:07:40.612944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:07:40.613084 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m19:07:40.613293 [info ] [MainThread]: 
[0m19:07:40.613644 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m19:07:40.614248 [debug] [MainThread]: Command end result
[0m19:07:40.630367 [info ] [MainThread]: 
[0m19:07:40.630648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:07:40.631116 [info ] [MainThread]: 
[0m19:07:40.631317 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:07:40.633238 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8017895, "process_user_time": 0.990567, "process_kernel_time": 0.17896, "process_mem_max_rss": "117522432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:07:40.633586 [debug] [MainThread]: Command `dbt run` succeeded at 19:07:40.633533 after 0.80 seconds
[0m19:07:40.633787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106231240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a59da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e71190>]}
[0m19:07:40.633966 [debug] [MainThread]: Flushing usage events
[0m19:07:51.265361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106605fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5fd90>]}


============================== 19:07:51.268159 | de474f85-e8ac-4f65-93a8-faf9631519ef ==============================
[0m19:07:51.268159 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:07:51.268476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:07:51.268685 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:07:51.268847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de474f85-e8ac-4f65-93a8-faf9631519ef', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f98d60>]}
[0m19:07:51.343936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de474f85-e8ac-4f65-93a8-faf9631519ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c538a0>]}
[0m19:07:51.367124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de474f85-e8ac-4f65-93a8-faf9631519ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0f550>]}
[0m19:07:51.368547 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:07:51.378095 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m19:07:51.432470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:07:51.432833 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/dim_customers.sql
[0m19:07:51.533101 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m19:07:51.538673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de474f85-e8ac-4f65-93a8-faf9631519ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108633110>]}
[0m19:07:51.582758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de474f85-e8ac-4f65-93a8-faf9631519ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdc590>]}
[0m19:07:51.583037 [info ] [MainThread]: Found 4 models, 3 sources, 423 macros
[0m19:07:51.583202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de474f85-e8ac-4f65-93a8-faf9631519ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c3cc80>]}
[0m19:07:51.584401 [info ] [MainThread]: 
[0m19:07:51.584682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:07:51.586487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m19:07:51.619665 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m19:07:51.619897 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m19:07:51.620042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:07:51.639861 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.020 seconds
[0m19:07:51.640727 [debug] [ThreadPool]: On list_dbt: Close
[0m19:07:51.641453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m19:07:51.644280 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m19:07:51.644450 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m19:07:51.644588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:07:51.653634 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:07:51.653804 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m19:07:51.653946 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m19:07:51.656165 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m19:07:51.656995 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m19:07:51.657447 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m19:07:51.660215 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:51.660423 [debug] [MainThread]: On master: BEGIN
[0m19:07:51.660578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:07:51.666997 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m19:07:51.667198 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:51.667414 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:07:51.670114 [debug] [MainThread]: SQL status: SELECT 3 in 0.002 seconds
[0m19:07:51.670969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de474f85-e8ac-4f65-93a8-faf9631519ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca7d10>]}
[0m19:07:51.671227 [debug] [MainThread]: On master: ROLLBACK
[0m19:07:51.672233 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:51.672421 [debug] [MainThread]: On master: BEGIN
[0m19:07:51.673356 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:07:51.673519 [debug] [MainThread]: On master: COMMIT
[0m19:07:51.673654 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:51.673784 [debug] [MainThread]: On master: COMMIT
[0m19:07:51.674309 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:07:51.674458 [debug] [MainThread]: On master: Close
[0m19:07:51.674689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:07:51.674857 [info ] [MainThread]: 
[0m19:07:51.678056 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m19:07:51.678368 [info ] [Thread-1 (]: 1 of 4 START sql view model dev.stg_customers .................................. [RUN]
[0m19:07:51.678620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m19:07:51.678795 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m19:07:51.683673 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m19:07:51.684408 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m19:07:51.701750 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m19:07:51.702206 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:07:51.702365 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m19:07:51.702508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:51.711020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m19:07:51.711235 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:07:51.711389 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m19:07:51.714223 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:07:51.717497 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:07:51.717698 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:07:51.718506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:07:51.719825 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:07:51.720000 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:07:51.720952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:07:51.732783 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m19:07:51.733050 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:07:51.733209 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m19:07:51.735029 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:07:51.738054 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m19:07:51.740376 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m19:07:51.740559 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m19:07:51.742820 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:07:51.744019 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m19:07:51.744749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de474f85-e8ac-4f65-93a8-faf9631519ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d09910>]}
[0m19:07:51.745069 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m19:07:51.745377 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m19:07:51.745590 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m19:07:51.745819 [info ] [Thread-1 (]: 2 of 4 START sql view model dev.stg_orders ..................................... [RUN]
[0m19:07:51.746083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m19:07:51.746308 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m19:07:51.747564 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m19:07:51.748004 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m19:07:51.749788 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m19:07:51.750121 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:07:51.750278 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m19:07:51.750424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:51.759345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:07:51.759578 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:07:51.759734 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m19:07:51.761810 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:07:51.763308 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:07:51.763491 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m19:07:51.764392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:07:51.765640 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:07:51.765825 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m19:07:51.766640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:07:51.767702 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m19:07:51.767872 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:07:51.768027 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m19:07:51.769610 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:07:51.770724 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m19:07:51.771130 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m19:07:51.771320 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m19:07:51.773438 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:07:51.774168 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m19:07:51.774450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de474f85-e8ac-4f65-93a8-faf9631519ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b2850>]}
[0m19:07:51.774762 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.03s]
[0m19:07:51.775054 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m19:07:51.775263 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m19:07:51.775531 [info ] [Thread-1 (]: 3 of 4 START sql view model dev.stg_payments ................................... [RUN]
[0m19:07:51.775797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m19:07:51.775972 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m19:07:51.777262 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m19:07:51.777669 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m19:07:51.779442 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m19:07:51.779775 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m19:07:51.779936 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m19:07:51.780086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:51.788299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m19:07:51.788534 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m19:07:51.788710 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    amount / 100 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m19:07:51.790511 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:07:51.792098 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m19:07:51.792302 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m19:07:51.792834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:07:51.794227 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m19:07:51.794416 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m19:07:51.795526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:07:51.796338 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m19:07:51.796520 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m19:07:51.796682 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m19:07:51.798444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:07:51.799792 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m19:07:51.800124 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m19:07:51.800300 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m19:07:51.804082 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:07:51.804984 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m19:07:51.805349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de474f85-e8ac-4f65-93a8-faf9631519ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc5350>]}
[0m19:07:51.805702 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.03s]
[0m19:07:51.806019 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m19:07:51.806244 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m19:07:51.806886 [info ] [Thread-1 (]: 4 of 4 START sql table model dev.dim_customers ................................. [RUN]
[0m19:07:51.807487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.dim_customers)
[0m19:07:51.807687 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m19:07:51.809540 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m19:07:51.810564 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m19:07:51.822577 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m19:07:51.823350 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:07:51.823553 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m19:07:51.823707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:07:51.833916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m19:07:51.834110 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:07:51.834296 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."dev"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dbt"."dev"."stg_customers"
),

orders as (
   select * from "dbt"."dev"."stg_orders"
),

customer_orders as (
   select
       customer_id,
       min(order_date) as first_order_date,
       max(order_date) as most_recent_order_date,
       count(order_id) as number_of_orders
   from orders
   group by customer_id
),

final as (
   select
       customers.customer_id,
       customers.first_name,
       customers.last_name,
       customer_orders.first_order_date,
       customer_orders.most_recent_order_date,
       coalesce (customer_orders.number_of_orders, 0)
       as number_of_orders

   from customers
   left join customer_orders using (customer_id)
)
select * from final
  );
  
[0m19:07:51.841443 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.007 seconds
[0m19:07:51.843029 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:07:51.843212 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:07:51.843931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:07:51.846641 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m19:07:51.846844 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:07:51.847063 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m19:07:51.848113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:07:51.849122 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m19:07:51.850616 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m19:07:51.850801 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m19:07:51.851329 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:07:51.852117 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m19:07:51.852438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de474f85-e8ac-4f65-93a8-faf9631519ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910ac10>]}
[0m19:07:51.852807 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev.dim_customers ............................ [[32mSELECT 100[0m in 0.04s]
[0m19:07:51.853148 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m19:07:51.854079 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:51.854269 [debug] [MainThread]: On master: BEGIN
[0m19:07:51.854409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:07:51.871011 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m19:07:51.871292 [debug] [MainThread]: On master: COMMIT
[0m19:07:51.871456 [debug] [MainThread]: Using postgres connection "master"
[0m19:07:51.871612 [debug] [MainThread]: On master: COMMIT
[0m19:07:51.872050 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:07:51.872232 [debug] [MainThread]: On master: Close
[0m19:07:51.872488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:07:51.872635 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m19:07:51.872850 [info ] [MainThread]: 
[0m19:07:51.873040 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m19:07:51.873635 [debug] [MainThread]: Command end result
[0m19:07:51.889082 [info ] [MainThread]: 
[0m19:07:51.889370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:07:51.889526 [info ] [MainThread]: 
[0m19:07:51.889686 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:07:51.891234 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6564172, "process_user_time": 1.024759, "process_kernel_time": 0.15076, "process_mem_max_rss": "119750656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:07:51.891509 [debug] [MainThread]: Command `dbt run` succeeded at 19:07:51.891464 after 0.66 seconds
[0m19:07:51.891694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068db6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10909c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10909f3b0>]}
[0m19:07:51.891866 [debug] [MainThread]: Flushing usage events
[0m09:36:05.486477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072cdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2bd90>]}


============================== 09:36:05.491720 | 1703a747-9843-4ea3-a534-693acddaa908 ==============================
[0m09:36:05.491720 [info ] [MainThread]: Running with dbt=1.8.8
[0m09:36:05.492058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:36:05.492278 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:36:05.492440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1703a747-9843-4ea3-a534-693acddaa908', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c60d60>]}
[0m09:36:05.585753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1703a747-9843-4ea3-a534-693acddaa908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891b8a0>]}
[0m09:36:05.609043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1703a747-9843-4ea3-a534-693acddaa908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d7550>]}
[0m09:36:05.609687 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:36:05.620136 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m09:36:05.683202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:36:05.683539 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/marts/fct_orders.sql
[0m09:36:05.683740 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/dim_customers.sql
[0m09:36:05.782656 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m09:36:05.788282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1703a747-9843-4ea3-a534-693acddaa908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ff200>]}
[0m09:36:05.836426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1703a747-9843-4ea3-a534-693acddaa908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109adc590>]}
[0m09:36:05.836707 [info ] [MainThread]: Found 5 models, 3 sources, 423 macros
[0m09:36:05.836869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1703a747-9843-4ea3-a534-693acddaa908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a40e20>]}
[0m09:36:05.838140 [info ] [MainThread]: 
[0m09:36:05.838433 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:36:05.840273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m09:36:05.891744 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m09:36:05.892005 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m09:36:05.892154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:36:06.047284 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.155 seconds
[0m09:36:06.048304 [debug] [ThreadPool]: On list_dbt: Close
[0m09:36:06.049368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m09:36:06.053081 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:36:06.053364 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m09:36:06.053527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:36:06.061491 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:36:06.061792 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:36:06.061986 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:36:06.066342 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m09:36:06.067254 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m09:36:06.067675 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m09:36:06.070954 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:06.071197 [debug] [MainThread]: On master: BEGIN
[0m09:36:06.071355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:36:06.078950 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:36:06.079240 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:06.079482 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:36:06.091164 [debug] [MainThread]: SQL status: SELECT 3 in 0.011 seconds
[0m09:36:06.093416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1703a747-9843-4ea3-a534-693acddaa908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab7e90>]}
[0m09:36:06.093955 [debug] [MainThread]: On master: ROLLBACK
[0m09:36:06.095368 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:06.095643 [debug] [MainThread]: On master: BEGIN
[0m09:36:06.097236 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:36:06.097645 [debug] [MainThread]: On master: COMMIT
[0m09:36:06.097969 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:06.098222 [debug] [MainThread]: On master: COMMIT
[0m09:36:06.098839 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:36:06.099058 [debug] [MainThread]: On master: Close
[0m09:36:06.099392 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:36:06.099604 [info ] [MainThread]: 
[0m09:36:06.101489 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m09:36:06.101842 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.stg_customers .................................. [RUN]
[0m09:36:06.102136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m09:36:06.102335 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m09:36:06.107941 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m09:36:06.109680 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m09:36:06.128748 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m09:36:06.129784 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:36:06.129980 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m09:36:06.130135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:06.136682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m09:36:06.136962 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:36:06.137165 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m09:36:06.142989 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:36:06.147586 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:36:06.147940 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m09:36:06.150299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:36:06.152487 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:36:06.152709 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m09:36:06.153995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:36:06.166143 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:36:06.166445 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:36:06.166649 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:36:06.167974 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:36:06.171543 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m09:36:06.174163 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:36:06.174545 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m09:36:06.179690 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m09:36:06.181120 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m09:36:06.181854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1703a747-9843-4ea3-a534-693acddaa908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b1dc80>]}
[0m09:36:06.182189 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m09:36:06.182539 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m09:36:06.182759 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m09:36:06.183029 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.stg_orders ..................................... [RUN]
[0m09:36:06.183278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m09:36:06.183458 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m09:36:06.184742 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m09:36:06.185609 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m09:36:06.187420 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m09:36:06.188223 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:36:06.188397 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m09:36:06.188743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:06.198401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:36:06.198677 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:36:06.198849 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m09:36:06.200025 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m09:36:06.201544 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:36:06.201724 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m09:36:06.202338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:06.203676 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:36:06.203858 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m09:36:06.204511 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:06.205726 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:36:06.205921 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:36:06.206086 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:36:06.208037 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:36:06.209816 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m09:36:06.210309 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:36:06.210518 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m09:36:06.213298 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:36:06.214205 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m09:36:06.214588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1703a747-9843-4ea3-a534-693acddaa908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ebe850>]}
[0m09:36:06.215053 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.03s]
[0m09:36:06.215457 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m09:36:06.215923 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m09:36:06.216409 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.stg_payments ................................... [RUN]
[0m09:36:06.217045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m09:36:06.217233 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m09:36:06.218685 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m09:36:06.219413 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m09:36:06.222086 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m09:36:06.223009 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:36:06.223497 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m09:36:06.223719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:06.232324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:36:06.232585 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:36:06.232758 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    amount / 100 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m09:36:06.234096 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m09:36:06.235608 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:36:06.235793 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m09:36:06.236367 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:06.237583 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:36:06.237754 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m09:36:06.238255 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:06.239042 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m09:36:06.239224 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:36:06.239377 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m09:36:06.241357 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:36:06.242581 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m09:36:06.242890 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:36:06.243132 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m09:36:06.245371 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:36:06.246043 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m09:36:06.246312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1703a747-9843-4ea3-a534-693acddaa908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dcdcd0>]}
[0m09:36:06.246603 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.03s]
[0m09:36:06.246880 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m09:36:06.247256 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m09:36:06.247505 [info ] [Thread-1 (]: 4 of 5 START sql table model dev.fct_orders .................................... [RUN]
[0m09:36:06.247717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m09:36:06.247885 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m09:36:06.249356 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m09:36:06.249811 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m09:36:06.261861 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m09:36:06.262417 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:36:06.262591 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m09:36:06.262748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:06.272455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:36:06.272685 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:36:06.272877 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    

  create  table "dbt"."dev"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
  
[0m09:36:06.276719 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.004 seconds
[0m09:36:06.278418 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:36:06.278624 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m09:36:06.279235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:06.282091 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m09:36:06.282300 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:36:06.282479 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m09:36:06.283297 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:36:06.284375 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m09:36:06.285925 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:36:06.286117 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m09:36:06.286582 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:36:06.287324 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m09:36:06.287605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1703a747-9843-4ea3-a534-693acddaa908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e116d60>]}
[0m09:36:06.287928 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dev.fct_orders ............................... [[32mSELECT 99[0m in 0.04s]
[0m09:36:06.288217 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m09:36:06.288557 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m09:36:06.288806 [info ] [Thread-1 (]: 5 of 5 START sql table model dev.dim_customers ................................. [RUN]
[0m09:36:06.289079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.dim_customers)
[0m09:36:06.289266 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m09:36:06.291109 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m09:36:06.291891 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m09:36:06.293543 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m09:36:06.294626 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:36:06.294811 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m09:36:06.294977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:06.303894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:36:06.304171 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:36:06.304395 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."dev"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m09:36:06.307930 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.003 seconds
[0m09:36:06.309843 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:36:06.310055 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers" rename to "dim_customers__dbt_backup"
[0m09:36:06.310638 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:06.312316 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:36:06.312635 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m09:36:06.313504 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:36:06.314481 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m09:36:06.314673 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:36:06.314839 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m09:36:06.315782 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:36:06.316954 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m09:36:06.317320 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:36:06.317505 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m09:36:06.319975 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:36:06.320746 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m09:36:06.321037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1703a747-9843-4ea3-a534-693acddaa908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e139b0>]}
[0m09:36:06.321362 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dev.dim_customers ............................ [[32mSELECT 100[0m in 0.03s]
[0m09:36:06.321680 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m09:36:06.322331 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:06.322511 [debug] [MainThread]: On master: BEGIN
[0m09:36:06.322657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:36:06.329611 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:36:06.329872 [debug] [MainThread]: On master: COMMIT
[0m09:36:06.330028 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:06.330169 [debug] [MainThread]: On master: COMMIT
[0m09:36:06.330539 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:36:06.330721 [debug] [MainThread]: On master: Close
[0m09:36:06.330959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:36:06.331106 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m09:36:06.331316 [info ] [MainThread]: 
[0m09:36:06.331502 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m09:36:06.332091 [debug] [MainThread]: Command end result
[0m09:36:06.347081 [info ] [MainThread]: 
[0m09:36:06.347474 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:36:06.347648 [info ] [MainThread]: 
[0m09:36:06.347822 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:36:06.388941 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.93896556, "process_user_time": 1.060608, "process_kernel_time": 0.194896, "process_mem_max_rss": "109592576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:36:06.389402 [debug] [MainThread]: Command `dbt run` succeeded at 09:36:06.389338 after 0.94 seconds
[0m09:36:06.389650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e153a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1539b0>]}
[0m09:36:06.389873 [debug] [MainThread]: Flushing usage events
[0m09:36:56.722409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106037ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106037d90>]}


============================== 09:36:56.736468 | daae75d2-c192-43bb-9094-0cb52f4bb99e ==============================
[0m09:36:56.736468 [info ] [MainThread]: Running with dbt=1.8.8
[0m09:36:56.736827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:36:56.737038 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:36:56.737204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'daae75d2-c192-43bb-9094-0cb52f4bb99e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606cd60>]}
[0m09:36:56.818911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daae75d2-c192-43bb-9094-0cb52f4bb99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d278a0>]}
[0m09:36:56.842553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'daae75d2-c192-43bb-9094-0cb52f4bb99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de7550>]}
[0m09:36:56.843108 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:36:56.852732 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m09:36:56.912341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:36:56.912582 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:36:56.915158 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m09:36:56.928667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'daae75d2-c192-43bb-9094-0cb52f4bb99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106708d70>]}
[0m09:36:56.977997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daae75d2-c192-43bb-9094-0cb52f4bb99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106122890>]}
[0m09:36:56.978285 [info ] [MainThread]: Found 5 models, 3 sources, 423 macros
[0m09:36:56.978456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daae75d2-c192-43bb-9094-0cb52f4bb99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106caad00>]}
[0m09:36:56.979770 [info ] [MainThread]: 
[0m09:36:56.980066 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:36:56.981941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m09:36:57.025192 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m09:36:57.025423 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m09:36:57.025568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:36:57.083008 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.057 seconds
[0m09:36:57.083891 [debug] [ThreadPool]: On list_dbt: Close
[0m09:36:57.085251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m09:36:57.088400 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:36:57.088669 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m09:36:57.088813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:36:57.108095 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m09:36:57.108393 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:36:57.108580 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:36:57.111744 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m09:36:57.112610 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m09:36:57.113041 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m09:36:57.116108 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:57.116329 [debug] [MainThread]: On master: BEGIN
[0m09:36:57.116482 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:36:57.124473 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:36:57.124709 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:57.124942 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:36:57.129613 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m09:36:57.130531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daae75d2-c192-43bb-9094-0cb52f4bb99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb31d0>]}
[0m09:36:57.130800 [debug] [MainThread]: On master: ROLLBACK
[0m09:36:57.131274 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:57.131441 [debug] [MainThread]: On master: BEGIN
[0m09:36:57.132068 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:36:57.132237 [debug] [MainThread]: On master: COMMIT
[0m09:36:57.132385 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:57.132521 [debug] [MainThread]: On master: COMMIT
[0m09:36:57.132892 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:36:57.133051 [debug] [MainThread]: On master: Close
[0m09:36:57.133318 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:36:57.133500 [info ] [MainThread]: 
[0m09:36:57.135861 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m09:36:57.136190 [info ] [Thread-1 (]: 1 of 5 START sql view model dev.stg_customers .................................. [RUN]
[0m09:36:57.136454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m09:36:57.136644 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m09:36:57.141388 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m09:36:57.142100 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m09:36:57.161246 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m09:36:57.162178 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:36:57.162371 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m09:36:57.162524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:57.168818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m09:36:57.169059 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:36:57.169227 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m09:36:57.170616 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m09:36:57.173780 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:36:57.173975 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m09:36:57.174728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:36:57.176354 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:36:57.176580 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m09:36:57.177245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:57.185498 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:36:57.185713 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:36:57.185869 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:36:57.187194 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:36:57.190266 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m09:36:57.192753 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:36:57.192958 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m09:36:57.194612 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:36:57.195951 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m09:36:57.196673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daae75d2-c192-43bb-9094-0cb52f4bb99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc8890>]}
[0m09:36:57.196995 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m09:36:57.197337 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m09:36:57.197557 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m09:36:57.197805 [info ] [Thread-1 (]: 2 of 5 START sql view model dev.stg_orders ..................................... [RUN]
[0m09:36:57.198010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m09:36:57.198168 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m09:36:57.199690 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m09:36:57.200506 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m09:36:57.201953 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m09:36:57.202588 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:36:57.202756 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m09:36:57.202903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:57.209615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:36:57.209854 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:36:57.210017 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m09:36:57.211901 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:36:57.213918 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:36:57.214161 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m09:36:57.215289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:36:57.217377 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:36:57.217605 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m09:36:57.218263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:57.219039 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:36:57.219210 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:36:57.219358 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:36:57.220271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:36:57.221248 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m09:36:57.221567 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:36:57.221736 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m09:36:57.222736 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:36:57.223463 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m09:36:57.223778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daae75d2-c192-43bb-9094-0cb52f4bb99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b3e30>]}
[0m09:36:57.224091 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.03s]
[0m09:36:57.224376 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m09:36:57.224575 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m09:36:57.224809 [info ] [Thread-1 (]: 3 of 5 START sql view model dev.stg_payments ................................... [RUN]
[0m09:36:57.225010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m09:36:57.225168 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m09:36:57.226414 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m09:36:57.227189 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m09:36:57.229154 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m09:36:57.229992 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:36:57.230466 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m09:36:57.230693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:57.237044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m09:36:57.237358 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:36:57.237547 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    amount / 100 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m09:36:57.238593 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m09:36:57.240091 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:36:57.240287 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m09:36:57.240822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:57.242366 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:36:57.242548 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m09:36:57.243023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:57.243787 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m09:36:57.244014 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:36:57.244215 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m09:36:57.245387 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:36:57.246939 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m09:36:57.247399 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:36:57.247586 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m09:36:57.249218 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:36:57.249951 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m09:36:57.250221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daae75d2-c192-43bb-9094-0cb52f4bb99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f36650>]}
[0m09:36:57.250517 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.03s]
[0m09:36:57.250787 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m09:36:57.251167 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m09:36:57.251379 [info ] [Thread-1 (]: 4 of 5 START sql table model dev.fct_orders .................................... [RUN]
[0m09:36:57.251650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m09:36:57.251844 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m09:36:57.253202 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m09:36:57.253952 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m09:36:57.266660 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m09:36:57.267738 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:36:57.267904 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m09:36:57.268051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:57.274461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m09:36:57.274716 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:36:57.274892 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    

  create  table "dbt"."dev"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
  
[0m09:36:57.284611 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.009 seconds
[0m09:36:57.286184 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:36:57.286367 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders" rename to "fct_orders__dbt_backup"
[0m09:36:57.286878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:57.288112 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:36:57.288277 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m09:36:57.288710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:57.293400 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m09:36:57.293624 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:36:57.293788 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m09:36:57.294959 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:36:57.296102 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m09:36:57.297611 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:36:57.297803 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m09:36:57.299835 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m09:36:57.300643 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m09:36:57.300936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daae75d2-c192-43bb-9094-0cb52f4bb99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071084b0>]}
[0m09:36:57.301239 [info ] [Thread-1 (]: 4 of 5 OK created sql table model dev.fct_orders ............................... [[32mSELECT 99[0m in 0.05s]
[0m09:36:57.301521 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m09:36:57.301846 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m09:36:57.302095 [info ] [Thread-1 (]: 5 of 5 START sql table model dev.dim_customers ................................. [RUN]
[0m09:36:57.302391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.dim_customers)
[0m09:36:57.302594 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m09:36:57.304040 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m09:36:57.304760 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m09:36:57.306551 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m09:36:57.307138 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:36:57.307297 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m09:36:57.307520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:36:57.314760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:36:57.315028 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:36:57.315216 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."dev"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m09:36:57.317682 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.002 seconds
[0m09:36:57.319168 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:36:57.319343 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers" rename to "dim_customers__dbt_backup"
[0m09:36:57.319824 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:57.321054 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:36:57.321215 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m09:36:57.321704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:36:57.322560 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m09:36:57.322741 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:36:57.322895 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m09:36:57.323735 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:36:57.325022 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m09:36:57.325354 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:36:57.325517 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m09:36:57.327087 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:36:57.327978 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m09:36:57.328331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daae75d2-c192-43bb-9094-0cb52f4bb99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecfef0>]}
[0m09:36:57.328679 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dev.dim_customers ............................ [[32mSELECT 100[0m in 0.03s]
[0m09:36:57.329032 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m09:36:57.329643 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:57.329830 [debug] [MainThread]: On master: BEGIN
[0m09:36:57.329993 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:36:57.335994 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:36:57.336236 [debug] [MainThread]: On master: COMMIT
[0m09:36:57.336386 [debug] [MainThread]: Using postgres connection "master"
[0m09:36:57.339105 [debug] [MainThread]: On master: COMMIT
[0m09:36:57.339508 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:36:57.339654 [debug] [MainThread]: On master: Close
[0m09:36:57.339865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:36:57.339992 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m09:36:57.340183 [info ] [MainThread]: 
[0m09:36:57.340419 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m09:36:57.341217 [debug] [MainThread]: Command end result
[0m09:36:57.359157 [info ] [MainThread]: 
[0m09:36:57.359436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:36:57.359894 [info ] [MainThread]: 
[0m09:36:57.360110 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:36:57.361754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6728207, "process_user_time": 0.971948, "process_kernel_time": 0.166948, "process_mem_max_rss": "116588544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:36:57.362109 [debug] [MainThread]: Command `dbt run` succeeded at 09:36:57.362059 after 0.67 seconds
[0m09:36:57.362336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10604a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107107b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107107a70>]}
[0m09:36:57.362697 [debug] [MainThread]: Flushing usage events
[0m09:41:21.111449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a95fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063efed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063efd90>]}


============================== 09:41:21.122032 | f93c0cb0-f4da-4fb6-a098-ab35bf04bbed ==============================
[0m09:41:21.122032 [info ] [MainThread]: Running with dbt=1.8.8
[0m09:41:21.122358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'version_check': 'True', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:41:21.122562 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:41:21.122724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f93c0cb0-f4da-4fb6-a098-ab35bf04bbed', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106424d60>]}
[0m09:41:21.202952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f93c0cb0-f4da-4fb6-a098-ab35bf04bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e38a0>]}
[0m09:41:21.225774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f93c0cb0-f4da-4fb6-a098-ab35bf04bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10619f550>]}
[0m09:41:21.226246 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:41:21.235496 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m09:41:21.297391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:41:21.297667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:41:21.300384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m09:41:21.320404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f93c0cb0-f4da-4fb6-a098-ab35bf04bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106accd70>]}
[0m09:41:21.387497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f93c0cb0-f4da-4fb6-a098-ab35bf04bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107214e50>]}
[0m09:41:21.387780 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 423 macros
[0m09:41:21.387945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f93c0cb0-f4da-4fb6-a098-ab35bf04bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720d3d0>]}
[0m09:41:21.388955 [info ] [MainThread]: 
[0m09:41:21.389249 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:41:21.391139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m09:41:21.435728 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:41:21.435990 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m09:41:21.436123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:21.498147 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m09:41:21.498427 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:41:21.498586 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:41:21.506320 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m09:41:21.507251 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m09:41:21.507774 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m09:41:21.511084 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:21.511321 [debug] [MainThread]: On master: BEGIN
[0m09:41:21.511468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:41:21.519065 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:41:21.519314 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:21.519571 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:41:21.524276 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m09:41:21.525102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f93c0cb0-f4da-4fb6-a098-ab35bf04bbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714f350>]}
[0m09:41:21.525362 [debug] [MainThread]: On master: ROLLBACK
[0m09:41:21.525802 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:21.525999 [debug] [MainThread]: On master: BEGIN
[0m09:41:21.526573 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:41:21.526757 [debug] [MainThread]: On master: COMMIT
[0m09:41:21.526916 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:21.527058 [debug] [MainThread]: On master: COMMIT
[0m09:41:21.527415 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:41:21.527630 [debug] [MainThread]: On master: Close
[0m09:41:21.527927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:41:21.528112 [info ] [MainThread]: 
[0m09:41:21.529633 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:41:21.529889 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [RUN]
[0m09:41:21.530139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m09:41:21.530338 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:41:21.541141 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:41:21.541852 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:41:21.550321 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:41:21.551030 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:41:21.551223 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: BEGIN
[0m09:41:21.551413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:21.562616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:41:21.562887 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:41:21.563085 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','return_pending','placed'
)



      
    ) dbt_internal_test
[0m09:41:21.564392 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:41:21.566829 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: ROLLBACK
[0m09:41:21.567362 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: Close
[0m09:41:21.567747 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [[32mPASS[0m in 0.04s]
[0m09:41:21.568084 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:41:21.568317 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:41:21.568506 [info ] [Thread-1 (]: 2 of 4 START test not_null_stg_orders_order_id ................................. [RUN]
[0m09:41:21.568774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m09:41:21.568987 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:41:21.572755 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:41:21.573222 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:41:21.574366 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:41:21.574811 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:41:21.574998 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m09:41:21.575159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:21.583535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:41:21.583802 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:41:21.583982 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt"."dev"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m09:41:21.584880 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:41:21.585788 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m09:41:21.586318 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m09:41:21.586670 [info ] [Thread-1 (]: 2 of 4 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m09:41:21.587004 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:41:21.587229 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:41:21.587422 [info ] [Thread-1 (]: 3 of 4 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m09:41:21.588036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m09:41:21.588245 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:41:21.593284 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:41:21.593845 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:41:21.594896 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:41:21.595282 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:41:21.595458 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m09:41:21.595614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:21.603085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:41:21.603327 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:41:21.603526 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt"."dev"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt"."dev"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:41:21.604736 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:41:21.605616 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m09:41:21.606117 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m09:41:21.606445 [info ] [Thread-1 (]: 3 of 4 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.02s]
[0m09:41:21.606759 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:41:21.606965 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:41:21.607168 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_orders_order_id ................................... [RUN]
[0m09:41:21.607366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m09:41:21.607539 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:41:21.611422 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:41:21.612236 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:41:21.613971 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:41:21.614496 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:41:21.614682 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m09:41:21.614842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:41:21.622275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:41:21.622505 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:41:21.622724 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:41:21.623935 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:41:21.624784 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m09:41:21.625187 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m09:41:21.625517 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.02s]
[0m09:41:21.625923 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:41:21.627247 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:21.627458 [debug] [MainThread]: On master: BEGIN
[0m09:41:21.627592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:41:21.634778 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:41:21.635041 [debug] [MainThread]: On master: COMMIT
[0m09:41:21.635188 [debug] [MainThread]: Using postgres connection "master"
[0m09:41:21.635319 [debug] [MainThread]: On master: COMMIT
[0m09:41:21.635698 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:41:21.635884 [debug] [MainThread]: On master: Close
[0m09:41:21.636141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:21.636283 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m09:41:21.636451 [info ] [MainThread]: 
[0m09:41:21.636612 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m09:41:21.637167 [debug] [MainThread]: Command end result
[0m09:41:21.653976 [info ] [MainThread]: 
[0m09:41:21.654242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:41:21.654403 [info ] [MainThread]: 
[0m09:41:21.655435 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:41:21.656724 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.575645, "process_user_time": 0.912185, "process_kernel_time": 0.163235, "process_mem_max_rss": "117522432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:41:21.657008 [debug] [MainThread]: Command `dbt test` succeeded at 09:41:21.656961 after 0.58 seconds
[0m09:41:21.657200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f6170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f6350>]}
[0m09:41:21.657376 [debug] [MainThread]: Flushing usage events
[0m09:42:42.689657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107185fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cfbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cfbd90>]}


============================== 09:42:42.702388 | 269db6f2-1dd3-4c09-b117-b4b105854293 ==============================
[0m09:42:42.702388 [info ] [MainThread]: Running with dbt=1.8.8
[0m09:42:42.702713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:42:42.702922 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:42:42.703081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '269db6f2-1dd3-4c09-b117-b4b105854293', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d34d60>]}
[0m09:42:42.803534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '269db6f2-1dd3-4c09-b117-b4b105854293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ef8a0>]}
[0m09:42:42.828548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '269db6f2-1dd3-4c09-b117-b4b105854293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109beb550>]}
[0m09:42:42.829365 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:42:42.838695 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m09:42:42.905259 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m09:42:42.905594 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://tests/positive_total_payments.sql
[0m09:42:42.905738 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://tests/assert_positive_total_payments.sql
[0m09:42:42.981972 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m09:42:42.987452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '269db6f2-1dd3-4c09-b117-b4b105854293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abcef30>]}
[0m09:42:43.051038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '269db6f2-1dd3-4c09-b117-b4b105854293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c85dc50>]}
[0m09:42:43.051330 [info ] [MainThread]: Found 5 models, 5 data tests, 3 sources, 423 macros
[0m09:42:43.051497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '269db6f2-1dd3-4c09-b117-b4b105854293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c833930>]}
[0m09:42:43.052487 [info ] [MainThread]: 
[0m09:42:43.052770 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:42:43.054603 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m09:42:43.099793 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:42:43.100029 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m09:42:43.100163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:43.121069 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m09:42:43.121320 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:42:43.121478 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:42:43.126710 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m09:42:43.127574 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m09:42:43.128029 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m09:42:43.130681 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:43.130888 [debug] [MainThread]: On master: BEGIN
[0m09:42:43.131028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:43.139192 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:42:43.139444 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:43.139672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:42:43.147936 [debug] [MainThread]: SQL status: SELECT 3 in 0.008 seconds
[0m09:42:43.148909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '269db6f2-1dd3-4c09-b117-b4b105854293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbc41d0>]}
[0m09:42:43.149205 [debug] [MainThread]: On master: ROLLBACK
[0m09:42:43.149710 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:43.149898 [debug] [MainThread]: On master: BEGIN
[0m09:42:43.150631 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:42:43.150801 [debug] [MainThread]: On master: COMMIT
[0m09:42:43.150952 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:43.151097 [debug] [MainThread]: On master: COMMIT
[0m09:42:43.152168 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:42:43.152355 [debug] [MainThread]: On master: Close
[0m09:42:43.152652 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:42:43.152843 [info ] [MainThread]: 
[0m09:42:43.154631 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:42:43.154944 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [RUN]
[0m09:42:43.155238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m09:42:43.155459 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:42:43.166807 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:42:43.167766 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:42:43.176089 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:42:43.177014 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:42:43.177223 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: BEGIN
[0m09:42:43.177388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:43.183572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m09:42:43.183790 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:42:43.183976 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','return_pending','placed'
)



      
    ) dbt_internal_test
[0m09:42:43.185074 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:42:43.187298 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: ROLLBACK
[0m09:42:43.187744 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: Close
[0m09:42:43.188060 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [[32mPASS[0m in 0.03s]
[0m09:42:43.188354 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:42:43.188577 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:42:43.188747 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m09:42:43.188949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m09:42:43.189112 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:42:43.192803 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:42:43.193453 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:42:43.194402 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:42:43.195030 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:42:43.195204 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m09:42:43.195483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:43.205479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:42:43.205746 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:42:43.205923 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt"."dev"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m09:42:43.207083 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:42:43.207909 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m09:42:43.208337 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m09:42:43.208664 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m09:42:43.209130 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:42:43.209372 [debug] [Thread-1 (]: Began running node test.jaffle_shop.positive_total_payments
[0m09:42:43.209588 [info ] [Thread-1 (]: 3 of 5 START test positive_total_payments ...................................... [RUN]
[0m09:42:43.209837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.positive_total_payments)
[0m09:42:43.210050 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.positive_total_payments
[0m09:42:43.211405 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.positive_total_payments"
[0m09:42:43.211937 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.positive_total_payments
[0m09:42:43.214891 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.positive_total_payments"
[0m09:42:43.215705 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.positive_total_payments"
[0m09:42:43.215883 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: BEGIN
[0m09:42:43.216027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:43.221765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m09:42:43.221981 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.positive_total_payments"
[0m09:42:43.222143 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.positive_total_payments"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with payments as (
    select
        *
    from
        "dbt"."dev"."stg_payments"
),

test_data as (
    select
        order_id,
        sum(amount) as total_amount
    from payments
    group by order_id
)

select *
from
    test_data
where
    total_amount < 0
      
    ) dbt_internal_test
[0m09:42:43.223106 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:42:43.223895 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: ROLLBACK
[0m09:42:43.224269 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: Close
[0m09:42:43.224579 [info ] [Thread-1 (]: 3 of 5 PASS positive_total_payments ............................................ [[32mPASS[0m in 0.01s]
[0m09:42:43.224864 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.positive_total_payments
[0m09:42:43.225070 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:42:43.225316 [info ] [Thread-1 (]: 4 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m09:42:43.225588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.positive_total_payments, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m09:42:43.225817 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:42:43.230267 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:42:43.231117 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:42:43.232069 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:42:43.232551 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:42:43.232719 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m09:42:43.232878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:43.240073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:42:43.240302 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:42:43.240490 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt"."dev"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt"."dev"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:42:43.241531 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:42:43.242329 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m09:42:43.242853 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m09:42:43.243178 [info ] [Thread-1 (]: 4 of 5 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.02s]
[0m09:42:43.243458 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:42:43.243664 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:42:43.243868 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m09:42:43.244121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m09:42:43.244360 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:42:43.247807 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:42:43.248621 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:42:43.249559 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:42:43.250271 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:42:43.250439 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m09:42:43.250732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:43.259448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:42:43.259741 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:42:43.259931 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:42:43.261370 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:42:43.262379 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m09:42:43.263018 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m09:42:43.263332 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.02s]
[0m09:42:43.263673 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:42:43.264358 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:43.264524 [debug] [MainThread]: On master: BEGIN
[0m09:42:43.264657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:42:43.270878 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:42:43.271092 [debug] [MainThread]: On master: COMMIT
[0m09:42:43.271226 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:43.271347 [debug] [MainThread]: On master: COMMIT
[0m09:42:43.271717 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:42:43.271892 [debug] [MainThread]: On master: Close
[0m09:42:43.272119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:43.272253 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m09:42:43.272415 [info ] [MainThread]: 
[0m09:42:43.272575 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m09:42:43.273119 [debug] [MainThread]: Command end result
[0m09:42:43.287834 [info ] [MainThread]: 
[0m09:42:43.288084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:42:43.288231 [info ] [MainThread]: 
[0m09:42:43.288375 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:42:43.289883 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6345771, "process_user_time": 0.983801, "process_kernel_time": 0.163037, "process_mem_max_rss": "118980608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:42:43.290180 [debug] [MainThread]: Command `dbt test` succeeded at 09:42:43.290135 after 0.63 seconds
[0m09:42:43.290369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8c55a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc5f570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc5ceb0>]}
[0m09:42:43.290536 [debug] [MainThread]: Flushing usage events
[0m09:43:15.117188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d51fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffbd90>]}


============================== 09:43:15.120421 | f58a40f6-9eff-4f6f-946c-e6360343b9c2 ==============================
[0m09:43:15.120421 [info ] [MainThread]: Running with dbt=1.8.8
[0m09:43:15.120756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select test_type:singular', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:43:15.120971 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:43:15.121136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f58a40f6-9eff-4f6f-946c-e6360343b9c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107034d60>]}
[0m09:43:15.201683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f58a40f6-9eff-4f6f-946c-e6360343b9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bef8a0>]}
[0m09:43:15.224873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f58a40f6-9eff-4f6f-946c-e6360343b9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee7550>]}
[0m09:43:15.225399 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:43:15.235183 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m09:43:15.310093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:43:15.310341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:43:15.312908 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m09:43:15.334273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f58a40f6-9eff-4f6f-946c-e6360343b9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc8d70>]}
[0m09:43:15.397076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f58a40f6-9eff-4f6f-946c-e6360343b9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a4e50>]}
[0m09:43:15.397360 [info ] [MainThread]: Found 5 models, 5 data tests, 3 sources, 423 macros
[0m09:43:15.397525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f58a40f6-9eff-4f6f-946c-e6360343b9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888d980>]}
[0m09:43:15.398305 [info ] [MainThread]: 
[0m09:43:15.398577 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:43:15.400428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m09:43:15.434100 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:43:15.434337 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m09:43:15.434471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:15.456481 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m09:43:15.456783 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:43:15.456962 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:43:15.469757 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m09:43:15.470710 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m09:43:15.471189 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m09:43:15.474468 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:15.474688 [debug] [MainThread]: On master: BEGIN
[0m09:43:15.474840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:43:15.482721 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:43:15.482939 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:15.483161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:43:15.487466 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m09:43:15.488514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f58a40f6-9eff-4f6f-946c-e6360343b9c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd34d0>]}
[0m09:43:15.488817 [debug] [MainThread]: On master: ROLLBACK
[0m09:43:15.489447 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:15.489634 [debug] [MainThread]: On master: BEGIN
[0m09:43:15.490576 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:43:15.490981 [debug] [MainThread]: On master: COMMIT
[0m09:43:15.491164 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:15.491314 [debug] [MainThread]: On master: COMMIT
[0m09:43:15.492055 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:43:15.492284 [debug] [MainThread]: On master: Close
[0m09:43:15.492620 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:43:15.493442 [info ] [MainThread]: 
[0m09:43:15.495850 [debug] [Thread-1 (]: Began running node test.jaffle_shop.positive_total_payments
[0m09:43:15.496149 [info ] [Thread-1 (]: 1 of 1 START test positive_total_payments ...................................... [RUN]
[0m09:43:15.496418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now test.jaffle_shop.positive_total_payments)
[0m09:43:15.496600 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.positive_total_payments
[0m09:43:15.501621 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.positive_total_payments"
[0m09:43:15.502605 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.positive_total_payments
[0m09:43:15.511205 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.positive_total_payments"
[0m09:43:15.511753 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.positive_total_payments"
[0m09:43:15.511933 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: BEGIN
[0m09:43:15.512086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:15.519400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:43:15.519628 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.positive_total_payments"
[0m09:43:15.519799 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.positive_total_payments"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with payments as (
    select
        *
    from
        "dbt"."dev"."stg_payments"
),

test_data as (
    select
        order_id,
        sum(amount) as total_amount
    from payments
    group by order_id
)

select *
from
    test_data
where
    total_amount < 0
      
    ) dbt_internal_test
[0m09:43:15.521352 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:43:15.523591 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: ROLLBACK
[0m09:43:15.524087 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: Close
[0m09:43:15.524487 [info ] [Thread-1 (]: 1 of 1 PASS positive_total_payments ............................................ [[32mPASS[0m in 0.03s]
[0m09:43:15.524856 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.positive_total_payments
[0m09:43:15.525506 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:15.525683 [debug] [MainThread]: On master: BEGIN
[0m09:43:15.525819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:43:15.533428 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:43:15.533680 [debug] [MainThread]: On master: COMMIT
[0m09:43:15.533816 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:15.533941 [debug] [MainThread]: On master: COMMIT
[0m09:43:15.534324 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:43:15.534508 [debug] [MainThread]: On master: Close
[0m09:43:15.534730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:15.534891 [debug] [MainThread]: Connection 'test.jaffle_shop.positive_total_payments' was properly closed.
[0m09:43:15.535045 [info ] [MainThread]: 
[0m09:43:15.535201 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m09:43:15.535521 [debug] [MainThread]: Command end result
[0m09:43:15.550009 [info ] [MainThread]: 
[0m09:43:15.550267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:43:15.550414 [info ] [MainThread]: 
[0m09:43:15.550562 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:43:15.552251 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.4673759, "process_user_time": 0.887971, "process_kernel_time": 0.151099, "process_mem_max_rss": "116736000", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:43:15.552562 [debug] [MainThread]: Command `dbt test` succeeded at 09:43:15.552514 after 0.47 seconds
[0m09:43:15.552789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf49f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b77d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f140f0>]}
[0m09:43:15.552969 [debug] [MainThread]: Flushing usage events
[0m09:44:27.149479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107199fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af3d90>]}


============================== 09:44:27.159472 | 3332271c-eb68-4174-96c3-8d2af4da8519 ==============================
[0m09:44:27.159472 [info ] [MainThread]: Running with dbt=1.8.8
[0m09:44:27.159803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select test_type:generic', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:44:27.160017 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:44:27.160178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3332271c-eb68-4174-96c3-8d2af4da8519', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2cd60>]}
[0m09:44:27.241112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3332271c-eb68-4174-96c3-8d2af4da8519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e78a0>]}
[0m09:44:27.267667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3332271c-eb68-4174-96c3-8d2af4da8519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a7550>]}
[0m09:44:27.268481 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:44:27.282423 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m09:44:27.352836 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading jaffle_shop: schema.yml - Runtime Error
    Syntax error near line 25
    ------------------------------
    22 |                to: ref('stg_customers')
    23 |                field: customer_id
    24 | 
    25 |   - name: stg_customers
    26 |     columns: 
    27 |       - name: customer_id
    28 |         tests:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 2
    did not find expected '-' indicator
      in "<unicode string>", line 25, column 3
[0m09:44:27.354528 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.23834692, "process_user_time": 0.712255, "process_kernel_time": 0.118707, "process_mem_max_rss": "106020864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:44:27.354865 [debug] [MainThread]: Command `dbt test` failed at 09:44:27.354810 after 0.24 seconds
[0m09:44:27.355090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108893e70>]}
[0m09:44:27.355265 [debug] [MainThread]: Flushing usage events
[0m09:45:20.588639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107209fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b67ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b67d90>]}


============================== 09:45:20.605247 | 605b7457-f810-4290-b964-5c07f1eaf4a0 ==============================
[0m09:45:20.605247 [info ] [MainThread]: Running with dbt=1.8.8
[0m09:45:20.605600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select test_type:generic', 'send_anonymous_usage_stats': 'True'}
[0m09:45:20.605809 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:45:20.605970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '605b7457-f810-4290-b964-5c07f1eaf4a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b9cd60>]}
[0m09:45:20.687769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '605b7457-f810-4290-b964-5c07f1eaf4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088578a0>]}
[0m09:45:20.712412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '605b7457-f810-4290-b964-5c07f1eaf4a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108913550>]}
[0m09:45:20.713033 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:45:20.722037 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m09:45:20.772871 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading jaffle_shop: schema.yml - Runtime Error
    Syntax error near line 24
    ------------------------------
    21 |          - relationships:
    22 |                to: ref('stg_customers')
    23 |                field: customer_id
    24 |   - name: stg_customers
    25 |     columns: 
    26 |       - name: customer_id
    27 |         tests:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 4, column 2
    did not find expected '-' indicator
      in "<unicode string>", line 24, column 3
[0m09:45:20.774629 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.22649692, "process_user_time": 0.715758, "process_kernel_time": 0.119606, "process_mem_max_rss": "104923136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:45:20.774960 [debug] [MainThread]: Command `dbt test` failed at 09:45:20.774899 after 0.23 seconds
[0m09:45:20.775201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092406e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092407d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f7e70>]}
[0m09:45:20.775379 [debug] [MainThread]: Flushing usage events
[0m09:46:09.839255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b95fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f3d90>]}


============================== 09:46:09.860120 | 17e5b92c-6cc4-43f8-bb7a-e11e2e87e289 ==============================
[0m09:46:09.860120 [info ] [MainThread]: Running with dbt=1.8.8
[0m09:46:09.860741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select test_type:generic', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:46:09.861266 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:46:09.861645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17e5b92c-6cc4-43f8-bb7a-e11e2e87e289', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106528d60>]}
[0m09:46:09.947787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17e5b92c-6cc4-43f8-bb7a-e11e2e87e289', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e38a0>]}
[0m09:46:09.974161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17e5b92c-6cc4-43f8-bb7a-e11e2e87e289', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629f550>]}
[0m09:46:09.974788 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:46:09.984178 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m09:46:10.036439 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading jaffle_shop: schema.yml - Runtime Error
    Syntax error near line 25
    ------------------------------
    22 |                to: ref('stg_customers')
    23 |                field: customer_id
    24 | 
    25 | - name: stg_customers
    26 |   columns: 
    27 |     - name: customer_id
    28 |       tests:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 25, column 1
[0m09:46:10.038355 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.23315454, "process_user_time": 0.718953, "process_kernel_time": 0.121029, "process_mem_max_rss": "104202240", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:46:10.038675 [debug] [MainThread]: Command `dbt test` failed at 09:46:10.038620 after 0.23 seconds
[0m09:46:10.038885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc87d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10628fe70>]}
[0m09:46:10.039054 [debug] [MainThread]: Flushing usage events
[0m09:47:08.440098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103551fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dffed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dffd90>]}


============================== 09:47:08.452568 | 99fafe5d-a4c9-4b2c-af40-1db9b85cb4f5 ==============================
[0m09:47:08.452568 [info ] [MainThread]: Running with dbt=1.8.8
[0m09:47:08.452904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select test_type:generic', 'send_anonymous_usage_stats': 'True'}
[0m09:47:08.453107 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:47:08.453264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '99fafe5d-a4c9-4b2c-af40-1db9b85cb4f5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e34d60>]}
[0m09:47:08.536899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99fafe5d-a4c9-4b2c-af40-1db9b85cb4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aef8a0>]}
[0m09:47:08.562499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99fafe5d-a4c9-4b2c-af40-1db9b85cb4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce7550>]}
[0m09:47:08.563306 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:47:08.572667 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m09:47:08.633079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:47:08.633311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:47:08.635870 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m09:47:08.656485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99fafe5d-a4c9-4b2c-af40-1db9b85cb4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106435310>]}
[0m09:47:08.722944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99fafe5d-a4c9-4b2c-af40-1db9b85cb4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da8e50>]}
[0m09:47:08.723225 [info ] [MainThread]: Found 5 models, 7 data tests, 3 sources, 423 macros
[0m09:47:08.723395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99fafe5d-a4c9-4b2c-af40-1db9b85cb4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d95b20>]}
[0m09:47:08.724301 [info ] [MainThread]: 
[0m09:47:08.724616 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:47:08.726541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m09:47:08.774687 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:47:08.774946 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m09:47:08.775082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:47:08.797920 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m09:47:08.798181 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:47:08.798334 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:47:08.808055 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m09:47:08.808957 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m09:47:08.809472 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m09:47:08.812430 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:08.812635 [debug] [MainThread]: On master: BEGIN
[0m09:47:08.812780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:47:08.819146 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:47:08.819347 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:08.819558 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:47:08.822539 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m09:47:08.823357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99fafe5d-a4c9-4b2c-af40-1db9b85cb4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd34d0>]}
[0m09:47:08.823621 [debug] [MainThread]: On master: ROLLBACK
[0m09:47:08.824073 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:08.824277 [debug] [MainThread]: On master: BEGIN
[0m09:47:08.824923 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:47:08.825088 [debug] [MainThread]: On master: COMMIT
[0m09:47:08.825238 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:08.825381 [debug] [MainThread]: On master: COMMIT
[0m09:47:08.825736 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:47:08.825883 [debug] [MainThread]: On master: Close
[0m09:47:08.826118 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:47:08.826283 [info ] [MainThread]: 
[0m09:47:08.827821 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:47:08.828081 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [RUN]
[0m09:47:08.828327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m09:47:08.828524 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:47:08.839619 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:47:08.840781 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:47:08.848974 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:47:08.849728 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:47:08.849909 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: BEGIN
[0m09:47:08.850067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:08.859764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:47:08.860008 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:47:08.860207 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','return_pending','placed'
)



      
    ) dbt_internal_test
[0m09:47:08.861776 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:47:08.864050 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: ROLLBACK
[0m09:47:08.864500 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: Close
[0m09:47:08.864890 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [[32mPASS[0m in 0.04s]
[0m09:47:08.865344 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:47:08.865613 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:47:08.865816 [info ] [Thread-1 (]: 2 of 6 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m09:47:08.866100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m09:47:08.866316 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:47:08.870097 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:47:08.870582 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:47:08.871715 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:47:08.872219 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:47:08.872423 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m09:47:08.872592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:08.881500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:47:08.881783 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:47:08.881978 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt"."dev"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m09:47:08.882856 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:47:08.883738 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m09:47:08.884175 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m09:47:08.884513 [info ] [Thread-1 (]: 2 of 6 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.02s]
[0m09:47:08.884815 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:47:08.885023 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:47:08.885195 [info ] [Thread-1 (]: 3 of 6 START test not_null_stg_orders_order_id ................................. [RUN]
[0m09:47:08.885456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m09:47:08.885662 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:47:08.888183 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:47:08.888997 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:47:08.889980 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:47:08.890535 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:47:08.890706 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m09:47:08.890864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:08.897973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:47:08.898242 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:47:08.898657 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt"."dev"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m09:47:08.899700 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:47:08.900530 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m09:47:08.901140 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m09:47:08.901449 [info ] [Thread-1 (]: 3 of 6 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m09:47:08.901732 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:47:08.901933 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:47:08.902170 [info ] [Thread-1 (]: 4 of 6 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m09:47:08.902368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m09:47:08.902544 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:47:08.907096 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:47:08.908352 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:47:08.910042 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:47:08.910802 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:47:08.910979 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m09:47:08.911133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:08.921932 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:47:08.922164 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:47:08.922356 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt"."dev"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt"."dev"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:47:08.923678 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:47:08.924623 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m09:47:08.925362 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m09:47:08.925766 [info ] [Thread-1 (]: 4 of 6 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.02s]
[0m09:47:08.926167 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:47:08.926395 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:47:08.926579 [info ] [Thread-1 (]: 5 of 6 START test unique_stg_customers_customer_id ............................. [RUN]
[0m09:47:08.926828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m09:47:08.927033 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:47:08.930265 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:47:08.930696 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:47:08.931668 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:47:08.932200 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:47:08.932423 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m09:47:08.932599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:08.940066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:47:08.940311 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:47:08.940488 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:47:08.941501 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:47:08.942504 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m09:47:08.943060 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m09:47:08.943389 [info ] [Thread-1 (]: 5 of 6 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.02s]
[0m09:47:08.943677 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:47:08.943871 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:47:08.944056 [info ] [Thread-1 (]: 6 of 6 START test unique_stg_orders_order_id ................................... [RUN]
[0m09:47:08.944248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m09:47:08.944406 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:47:08.946665 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:47:08.947317 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:47:08.948227 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:47:08.948900 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:47:08.949057 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m09:47:08.949201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:08.957291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:47:08.957550 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:47:08.957745 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:47:08.959254 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:47:08.960150 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m09:47:08.960625 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m09:47:08.960947 [info ] [Thread-1 (]: 6 of 6 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.02s]
[0m09:47:08.961234 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:47:08.961850 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:08.961999 [debug] [MainThread]: On master: BEGIN
[0m09:47:08.962125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:47:08.970043 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:47:08.970281 [debug] [MainThread]: On master: COMMIT
[0m09:47:08.970430 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:08.970568 [debug] [MainThread]: On master: COMMIT
[0m09:47:08.970950 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:47:08.971091 [debug] [MainThread]: On master: Close
[0m09:47:08.971299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:47:08.971432 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m09:47:08.971593 [info ] [MainThread]: 
[0m09:47:08.971756 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m09:47:08.972397 [debug] [MainThread]: Command end result
[0m09:47:08.989892 [info ] [MainThread]: 
[0m09:47:08.990158 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:47:08.990308 [info ] [MainThread]: 
[0m09:47:08.990468 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:47:08.992160 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.58458185, "process_user_time": 0.944775, "process_kernel_time": 0.159448, "process_mem_max_rss": "117571584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:47:08.992554 [debug] [MainThread]: Command `dbt test` succeeded at 09:47:08.992504 after 0.59 seconds
[0m09:47:08.992762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ecd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db1d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db1450>]}
[0m09:47:08.992940 [debug] [MainThread]: Flushing usage events
[0m09:49:50.580967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104441fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d9fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d9fd90>]}


============================== 09:49:50.592609 | 76ed6c7b-1f70-4a79-a720-5e53366d570d ==============================
[0m09:49:50.592609 [info ] [MainThread]: Running with dbt=1.8.8
[0m09:49:50.592939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select test_type:generic', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:49:50.593144 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:49:50.593303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76ed6c7b-1f70-4a79-a720-5e53366d570d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd4d60>]}
[0m09:49:50.676982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76ed6c7b-1f70-4a79-a720-5e53366d570d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8f8a0>]}
[0m09:49:50.701584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76ed6c7b-1f70-4a79-a720-5e53366d570d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4b550>]}
[0m09:49:50.702196 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:49:50.710991 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m09:49:50.770865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:49:50.771097 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:49:50.773547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m09:49:50.794722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76ed6c7b-1f70-4a79-a720-5e53366d570d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647d310>]}
[0m09:49:50.861014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76ed6c7b-1f70-4a79-a720-5e53366d570d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be10f0>]}
[0m09:49:50.861302 [info ] [MainThread]: Found 5 models, 8 data tests, 3 sources, 423 macros
[0m09:49:50.861473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76ed6c7b-1f70-4a79-a720-5e53366d570d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc9d90>]}
[0m09:49:50.862375 [info ] [MainThread]: 
[0m09:49:50.862652 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:49:50.864508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m09:49:50.912665 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:49:50.912901 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m09:49:50.913040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:50.933195 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m09:49:50.933453 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:49:50.933608 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:49:50.939716 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m09:49:50.940623 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m09:49:50.941158 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m09:49:50.944064 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:50.944276 [debug] [MainThread]: On master: BEGIN
[0m09:49:50.944419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:49:50.951340 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:49:50.951574 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:50.951801 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:49:50.955079 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m09:49:50.955909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76ed6c7b-1f70-4a79-a720-5e53366d570d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b134d0>]}
[0m09:49:50.956176 [debug] [MainThread]: On master: ROLLBACK
[0m09:49:50.956634 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:50.956805 [debug] [MainThread]: On master: BEGIN
[0m09:49:50.957410 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:49:50.957602 [debug] [MainThread]: On master: COMMIT
[0m09:49:50.957759 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:50.957904 [debug] [MainThread]: On master: COMMIT
[0m09:49:50.958277 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:49:50.958438 [debug] [MainThread]: On master: Close
[0m09:49:50.958682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:49:50.958856 [info ] [MainThread]: 
[0m09:49:50.960347 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:49:50.960606 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [RUN]
[0m09:49:50.960851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m09:49:50.961046 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:49:50.972080 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:49:50.972846 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:49:50.981073 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:49:50.981881 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:49:50.982076 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: BEGIN
[0m09:49:50.982236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:50.991966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:49:50.992212 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:49:50.992421 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','return_pending','placed'
)



      
    ) dbt_internal_test
[0m09:49:50.993733 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:49:50.995980 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: ROLLBACK
[0m09:49:50.996418 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: Close
[0m09:49:50.996752 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [[32mPASS[0m in 0.04s]
[0m09:49:50.997071 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:49:50.997288 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m09:49:50.997481 [info ] [Thread-1 (]: 2 of 7 START test accepted_values_stg_payments_status__fail__success ........... [RUN]
[0m09:49:50.997730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552)
[0m09:49:50.997906 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m09:49:51.000814 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m09:49:51.001301 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m09:49:51.002272 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m09:49:51.002644 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m09:49:51.002910 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: BEGIN
[0m09:49:51.003165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:51.011825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:49:51.012128 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m09:49:51.012331 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'fail','success'
)



      
    ) dbt_internal_test
[0m09:49:51.013713 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:49:51.014572 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: ROLLBACK
[0m09:49:51.015239 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: Close
[0m09:49:51.015546 [info ] [Thread-1 (]: 2 of 7 PASS accepted_values_stg_payments_status__fail__success ................. [[32mPASS[0m in 0.02s]
[0m09:49:51.015837 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m09:49:51.016041 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:49:51.016266 [info ] [Thread-1 (]: 3 of 7 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m09:49:51.016500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m09:49:51.016682 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:49:51.020600 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:49:51.021289 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:49:51.022470 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:49:51.023034 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:49:51.023225 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m09:49:51.023377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:51.031272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:49:51.031572 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:49:51.031755 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt"."dev"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m09:49:51.032574 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:49:51.033471 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m09:49:51.034000 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m09:49:51.034380 [info ] [Thread-1 (]: 3 of 7 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.02s]
[0m09:49:51.034731 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:49:51.034949 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:49:51.035128 [info ] [Thread-1 (]: 4 of 7 START test not_null_stg_orders_order_id ................................. [RUN]
[0m09:49:51.035378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m09:49:51.035569 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:49:51.037653 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:49:51.038533 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:49:51.039796 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:49:51.040368 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:49:51.041374 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m09:49:51.041592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:51.050219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:49:51.050488 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:49:51.051373 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt"."dev"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m09:49:51.052263 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:49:51.053110 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m09:49:51.053703 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m09:49:51.054034 [info ] [Thread-1 (]: 4 of 7 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m09:49:51.054427 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:49:51.054682 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:49:51.054888 [info ] [Thread-1 (]: 5 of 7 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m09:49:51.055170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m09:49:51.055368 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:49:51.060110 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:49:51.061021 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:49:51.062088 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:49:51.062576 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:49:51.062749 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m09:49:51.062904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:51.070305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:49:51.070542 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:49:51.070738 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt"."dev"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt"."dev"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:49:51.072977 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:49:51.073801 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m09:49:51.074434 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m09:49:51.074793 [info ] [Thread-1 (]: 5 of 7 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.02s]
[0m09:49:51.075259 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:49:51.075489 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:49:51.075708 [info ] [Thread-1 (]: 6 of 7 START test unique_stg_customers_customer_id ............................. [RUN]
[0m09:49:51.075932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m09:49:51.076107 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:49:51.079778 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:49:51.080400 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:49:51.081515 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:49:51.081940 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:49:51.082125 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m09:49:51.082289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:51.091006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:49:51.091275 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:49:51.091471 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:49:51.092984 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:49:51.093889 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m09:49:51.094330 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m09:49:51.094648 [info ] [Thread-1 (]: 6 of 7 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.02s]
[0m09:49:51.094958 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:49:51.095174 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:49:51.095380 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_orders_order_id ................................... [RUN]
[0m09:49:51.095581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m09:49:51.095755 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:49:51.097815 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:49:51.098498 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:49:51.099818 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:49:51.100393 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:49:51.100570 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m09:49:51.100883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:49:51.109696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:49:51.109963 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:49:51.110153 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:49:51.111131 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:49:51.111970 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m09:49:51.112439 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m09:49:51.112787 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.02s]
[0m09:49:51.113092 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:49:51.113749 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:51.113918 [debug] [MainThread]: On master: BEGIN
[0m09:49:51.114053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:49:51.122374 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:49:51.122623 [debug] [MainThread]: On master: COMMIT
[0m09:49:51.122784 [debug] [MainThread]: Using postgres connection "master"
[0m09:49:51.122929 [debug] [MainThread]: On master: COMMIT
[0m09:49:51.123356 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:49:51.123508 [debug] [MainThread]: On master: Close
[0m09:49:51.123733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:51.123870 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m09:49:51.124045 [info ] [MainThread]: 
[0m09:49:51.124400 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m09:49:51.125491 [debug] [MainThread]: Command end result
[0m09:49:51.142368 [info ] [MainThread]: 
[0m09:49:51.142646 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:49:51.142800 [info ] [MainThread]: 
[0m09:49:51.142957 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m09:49:51.144345 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.59617174, "process_user_time": 0.958886, "process_kernel_time": 0.163914, "process_mem_max_rss": "118013952", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:49:51.144647 [debug] [MainThread]: Command `dbt test` succeeded at 09:49:51.144599 after 0.60 seconds
[0m09:49:51.144837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f254f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bedb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bed4f0>]}
[0m09:49:51.145015 [debug] [MainThread]: Flushing usage events
[0m09:51:54.674317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d51fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfbd90>]}


============================== 09:51:54.681972 | e27c7a88-fcab-4db4-9881-a74d7fcf94c9 ==============================
[0m09:51:54.681972 [info ] [MainThread]: Running with dbt=1.8.8
[0m09:51:54.682297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select test_type:generic', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:51:54.682512 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:51:54.682675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e27c7a88-fcab-4db4-9881-a74d7fcf94c9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d34d60>]}
[0m09:51:54.763795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e27c7a88-fcab-4db4-9881-a74d7fcf94c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ef8a0>]}
[0m09:51:54.788528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e27c7a88-fcab-4db4-9881-a74d7fcf94c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be7550>]}
[0m09:51:54.789387 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:51:54.803846 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m09:51:54.896333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:51:54.896589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:51:54.899269 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m09:51:54.920122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e27c7a88-fcab-4db4-9881-a74d7fcf94c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108431310>]}
[0m09:51:54.986510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e27c7a88-fcab-4db4-9881-a74d7fcf94c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa9390>]}
[0m09:51:54.986805 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 423 macros
[0m09:51:54.986970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e27c7a88-fcab-4db4-9881-a74d7fcf94c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f95f30>]}
[0m09:51:54.987879 [info ] [MainThread]: 
[0m09:51:54.988204 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:51:54.990049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m09:51:55.036215 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:51:55.036439 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m09:51:55.036575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:55.059332 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m09:51:55.059603 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:51:55.059777 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:51:55.064321 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m09:51:55.065155 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m09:51:55.065618 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m09:51:55.068330 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:55.068520 [debug] [MainThread]: On master: BEGIN
[0m09:51:55.068639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:51:55.083223 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m09:51:55.083449 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:55.083654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:51:55.087767 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m09:51:55.088569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e27c7a88-fcab-4db4-9881-a74d7fcf94c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108edb590>]}
[0m09:51:55.088824 [debug] [MainThread]: On master: ROLLBACK
[0m09:51:55.089215 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:55.089417 [debug] [MainThread]: On master: BEGIN
[0m09:51:55.089990 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:51:55.090162 [debug] [MainThread]: On master: COMMIT
[0m09:51:55.090305 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:55.090441 [debug] [MainThread]: On master: COMMIT
[0m09:51:55.090768 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:51:55.090939 [debug] [MainThread]: On master: Close
[0m09:51:55.091192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:51:55.091368 [info ] [MainThread]: 
[0m09:51:55.092868 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:51:55.093121 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [RUN]
[0m09:51:55.093368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m09:51:55.093563 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:51:55.105068 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:51:55.106230 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:51:55.114559 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:51:55.115219 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:51:55.115407 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: BEGIN
[0m09:51:55.115566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:55.122890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:51:55.123142 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:51:55.123336 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','return_pending','placed'
)



      
    ) dbt_internal_test
[0m09:51:55.124795 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:51:55.127023 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: ROLLBACK
[0m09:51:55.127513 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: Close
[0m09:51:55.127919 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [[32mPASS[0m in 0.03s]
[0m09:51:55.128286 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:51:55.128525 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683
[0m09:51:55.128727 [info ] [Thread-1 (]: 2 of 8 START test accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card  [RUN]
[0m09:51:55.129009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683)
[0m09:51:55.129243 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683
[0m09:51:55.132695 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683"
[0m09:51:55.133154 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683
[0m09:51:55.134116 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683"
[0m09:51:55.134689 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683"
[0m09:51:55.134877 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683: BEGIN
[0m09:51:55.135039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:55.142390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:51:55.142649 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683"
[0m09:51:55.142844 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_payments"
    group by payment_method

)

select *
from all_values
where value_field not in (
    'coupon','credit_card','bank_transfer','gift_card'
)



      
    ) dbt_internal_test
[0m09:51:55.143946 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:51:55.144799 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683: ROLLBACK
[0m09:51:55.145245 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683: Close
[0m09:51:55.145598 [info ] [Thread-1 (]: 2 of 8 PASS accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card  [[32mPASS[0m in 0.02s]
[0m09:51:55.145916 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683
[0m09:51:55.146133 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m09:51:55.146315 [info ] [Thread-1 (]: 3 of 8 START test accepted_values_stg_payments_status__fail__success ........... [RUN]
[0m09:51:55.146570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683, now test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552)
[0m09:51:55.146804 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m09:51:55.149771 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m09:51:55.150381 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m09:51:55.151394 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m09:51:55.151933 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m09:51:55.152095 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: BEGIN
[0m09:51:55.152242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:55.159613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:51:55.159883 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m09:51:55.160075 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'fail','success'
)



      
    ) dbt_internal_test
[0m09:51:55.161083 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:51:55.161934 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: ROLLBACK
[0m09:51:55.162321 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: Close
[0m09:51:55.162690 [info ] [Thread-1 (]: 3 of 8 PASS accepted_values_stg_payments_status__fail__success ................. [[32mPASS[0m in 0.02s]
[0m09:51:55.162996 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m09:51:55.163205 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:51:55.163414 [info ] [Thread-1 (]: 4 of 8 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m09:51:55.163634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m09:51:55.163815 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:51:55.167268 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:51:55.167960 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:51:55.169418 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:51:55.170264 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:51:55.170442 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m09:51:55.170595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:55.179268 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:51:55.179527 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:51:55.179709 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt"."dev"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m09:51:55.180630 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:51:55.181404 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m09:51:55.181838 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m09:51:55.182172 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.02s]
[0m09:51:55.182473 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:51:55.182674 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:51:55.182843 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_orders_order_id ................................. [RUN]
[0m09:51:55.183079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m09:51:55.183291 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:51:55.185280 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:51:55.185854 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:51:55.186777 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:51:55.187331 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:51:55.187501 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m09:51:55.187649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:55.194820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:51:55.195054 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:51:55.195221 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt"."dev"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m09:51:55.195900 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:51:55.196675 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m09:51:55.197068 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m09:51:55.197370 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.01s]
[0m09:51:55.197641 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:51:55.197834 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:51:55.198055 [info ] [Thread-1 (]: 6 of 8 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m09:51:55.198302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m09:51:55.198483 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:51:55.202847 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:51:55.203614 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:51:55.204633 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:51:55.205193 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:51:55.205369 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m09:51:55.205525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:55.213237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:51:55.213482 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:51:55.213660 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt"."dev"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt"."dev"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:51:55.216034 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:51:55.216853 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m09:51:55.217285 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m09:51:55.217605 [info ] [Thread-1 (]: 6 of 8 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.02s]
[0m09:51:55.217912 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:51:55.218154 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:51:55.218331 [info ] [Thread-1 (]: 7 of 8 START test unique_stg_customers_customer_id ............................. [RUN]
[0m09:51:55.218581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m09:51:55.218811 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:51:55.222043 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:51:55.222699 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:51:55.223926 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:51:55.224481 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:51:55.224667 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m09:51:55.224822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:55.232216 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:51:55.232477 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:51:55.232665 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:51:55.233580 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:51:55.234416 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m09:51:55.234853 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m09:51:55.235182 [info ] [Thread-1 (]: 7 of 8 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.02s]
[0m09:51:55.235481 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:51:55.235685 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:51:55.235883 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_orders_order_id ................................... [RUN]
[0m09:51:55.236078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m09:51:55.236250 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:51:55.238275 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:51:55.238979 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:51:55.239983 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:51:55.240566 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:51:55.240746 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m09:51:55.240913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:55.251563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:51:55.251821 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:51:55.251997 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:51:55.253127 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:51:55.256434 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m09:51:55.257260 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m09:51:55.257608 [info ] [Thread-1 (]: 8 of 8 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.02s]
[0m09:51:55.257908 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:51:55.258767 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:55.258964 [debug] [MainThread]: On master: BEGIN
[0m09:51:55.259104 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:51:55.266094 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:51:55.266348 [debug] [MainThread]: On master: COMMIT
[0m09:51:55.266492 [debug] [MainThread]: Using postgres connection "master"
[0m09:51:55.266626 [debug] [MainThread]: On master: COMMIT
[0m09:51:55.267022 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:51:55.267208 [debug] [MainThread]: On master: Close
[0m09:51:55.267438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:55.267574 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m09:51:55.267747 [info ] [MainThread]: 
[0m09:51:55.267920 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m09:51:55.268701 [debug] [MainThread]: Command end result
[0m09:51:55.284197 [info ] [MainThread]: 
[0m09:51:55.284481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:51:55.284629 [info ] [MainThread]: 
[0m09:51:55.284781 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m09:51:55.286328 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.64598715, "process_user_time": 0.972851, "process_kernel_time": 0.166748, "process_mem_max_rss": "117686272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:51:55.286593 [debug] [MainThread]: Command `dbt test` succeeded at 09:51:55.286551 after 0.65 seconds
[0m09:51:55.286770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abf1650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc0c30>]}
[0m09:51:55.286933 [debug] [MainThread]: Flushing usage events
[0m09:52:03.604130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107751fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111efbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111efbd90>]}


============================== 09:52:03.607267 | 8a3ad94b-628d-41c6-a371-ba3ea8ccc34a ==============================
[0m09:52:03.607267 [info ] [MainThread]: Running with dbt=1.8.8
[0m09:52:03.607770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select test_type:generic', 'send_anonymous_usage_stats': 'True'}
[0m09:52:03.608005 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:52:03.608178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8a3ad94b-628d-41c6-a371-ba3ea8ccc34a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f34d60>]}
[0m09:52:03.686069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a3ad94b-628d-41c6-a371-ba3ea8ccc34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bef8a0>]}
[0m09:52:03.709682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a3ad94b-628d-41c6-a371-ba3ea8ccc34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111deb550>]}
[0m09:52:03.710274 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:52:03.718966 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m09:52:03.780889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:03.781126 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:03.783667 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m09:52:03.803701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a3ad94b-628d-41c6-a371-ba3ea8ccc34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f5310>]}
[0m09:52:03.868629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a3ad94b-628d-41c6-a371-ba3ea8ccc34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e59390>]}
[0m09:52:03.868932 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 423 macros
[0m09:52:03.869105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a3ad94b-628d-41c6-a371-ba3ea8ccc34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e45f30>]}
[0m09:52:03.870064 [info ] [MainThread]: 
[0m09:52:03.870362 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:52:03.872221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m09:52:03.903964 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:52:03.904199 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m09:52:03.904335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:03.921448 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m09:52:03.921688 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:52:03.921841 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:52:03.926032 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m09:52:03.926854 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m09:52:03.927546 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m09:52:03.930081 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:03.930391 [debug] [MainThread]: On master: BEGIN
[0m09:52:03.930542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:03.939857 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:52:03.940849 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:03.941288 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:52:03.946121 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m09:52:03.947004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a3ad94b-628d-41c6-a371-ba3ea8ccc34a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d8f590>]}
[0m09:52:03.947324 [debug] [MainThread]: On master: ROLLBACK
[0m09:52:03.948273 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:03.948475 [debug] [MainThread]: On master: BEGIN
[0m09:52:03.949448 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:52:03.949621 [debug] [MainThread]: On master: COMMIT
[0m09:52:03.949756 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:03.949880 [debug] [MainThread]: On master: COMMIT
[0m09:52:03.950462 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:03.950611 [debug] [MainThread]: On master: Close
[0m09:52:03.950930 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:52:03.951538 [info ] [MainThread]: 
[0m09:52:03.954159 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:52:03.954474 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [RUN]
[0m09:52:03.954783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m09:52:03.955278 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:52:03.969060 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:52:03.969607 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:52:03.977643 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:52:03.978170 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:52:03.978350 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: BEGIN
[0m09:52:03.978502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:03.986655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:52:03.986910 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:52:03.987107 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','return_pending','placed'
)



      
    ) dbt_internal_test
[0m09:52:03.988114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:52:03.990241 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: ROLLBACK
[0m09:52:03.990855 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: Close
[0m09:52:03.991370 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [[32mPASS[0m in 0.04s]
[0m09:52:03.991676 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:52:03.991885 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e
[0m09:52:03.992059 [info ] [Thread-1 (]: 2 of 8 START test accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd  [RUN]
[0m09:52:03.992315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e)
[0m09:52:03.992505 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e
[0m09:52:03.995689 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e"
[0m09:52:03.996148 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e
[0m09:52:03.997011 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e"
[0m09:52:03.997351 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e"
[0m09:52:03.997719 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e: BEGIN
[0m09:52:03.997871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:04.006050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:52:04.006346 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e"
[0m09:52:04.006548 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_payments"
    group by payment_method

)

select *
from all_values
where value_field not in (
    'coupon','credit_card','bank_transfer','gift_crd'
)



      
    ) dbt_internal_test
[0m09:52:04.008628 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:52:04.009502 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e: ROLLBACK
[0m09:52:04.009978 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e: Close
[0m09:52:04.010287 [error] [Thread-1 (]: 2 of 8 FAIL 1 accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd  [[31mFAIL 1[0m in 0.02s]
[0m09:52:04.010590 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e
[0m09:52:04.010788 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m09:52:04.010956 [info ] [Thread-1 (]: 3 of 8 START test accepted_values_stg_payments_status__fail__success ........... [RUN]
[0m09:52:04.011187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd.e43b469b0e, now test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552)
[0m09:52:04.011370 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m09:52:04.013995 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m09:52:04.014420 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m09:52:04.015300 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m09:52:04.015765 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m09:52:04.015931 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: BEGIN
[0m09:52:04.016127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:04.023341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:52:04.023603 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m09:52:04.023783 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'fail','success'
)



      
    ) dbt_internal_test
[0m09:52:04.025101 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:52:04.025922 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: ROLLBACK
[0m09:52:04.026582 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: Close
[0m09:52:04.026938 [info ] [Thread-1 (]: 3 of 8 PASS accepted_values_stg_payments_status__fail__success ................. [[32mPASS[0m in 0.02s]
[0m09:52:04.027239 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m09:52:04.027439 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:52:04.027636 [info ] [Thread-1 (]: 4 of 8 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m09:52:04.027860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m09:52:04.028291 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:52:04.031790 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:52:04.032247 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:52:04.033707 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:52:04.034106 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:52:04.034271 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m09:52:04.034420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:04.041709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:52:04.041994 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m09:52:04.042169 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt"."dev"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m09:52:04.043779 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:52:04.044573 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m09:52:04.045224 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m09:52:04.045516 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.02s]
[0m09:52:04.045783 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m09:52:04.045969 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:52:04.046152 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_orders_order_id ................................. [RUN]
[0m09:52:04.046335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m09:52:04.046491 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:52:04.048414 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:52:04.048811 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:52:04.049693 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:52:04.050012 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:52:04.050168 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m09:52:04.050312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:04.058265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:52:04.058538 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:52:04.058720 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt"."dev"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m09:52:04.060036 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:52:04.060961 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m09:52:04.061478 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m09:52:04.061799 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m09:52:04.062080 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:52:04.062273 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:52:04.062490 [info ] [Thread-1 (]: 6 of 8 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m09:52:04.062731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m09:52:04.062910 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:52:04.067290 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:52:04.067764 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:52:04.068892 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:52:04.069336 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:52:04.069505 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m09:52:04.069659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:04.080077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:52:04.080364 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:52:04.080561 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt"."dev"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt"."dev"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:52:04.081761 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:52:04.082623 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m09:52:04.083069 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m09:52:04.083426 [info ] [Thread-1 (]: 6 of 8 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.02s]
[0m09:52:04.083729 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:52:04.083934 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:52:04.084132 [info ] [Thread-1 (]: 7 of 8 START test unique_stg_customers_customer_id ............................. [RUN]
[0m09:52:04.084349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m09:52:04.084519 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:52:04.087622 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:52:04.088055 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:52:04.089406 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:52:04.089801 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:52:04.089965 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m09:52:04.090164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:04.098133 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:52:04.098400 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m09:52:04.098578 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:52:04.099669 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:52:04.100620 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m09:52:04.101175 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m09:52:04.101541 [info ] [Thread-1 (]: 7 of 8 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.02s]
[0m09:52:04.101830 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m09:52:04.102023 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:52:04.102207 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_orders_order_id ................................... [RUN]
[0m09:52:04.102392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m09:52:04.102548 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:52:04.104353 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:52:04.104786 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:52:04.105668 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:52:04.105984 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:52:04.106136 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m09:52:04.106270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:04.112963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:52:04.113252 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:52:04.113434 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:52:04.114320 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m09:52:04.117215 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m09:52:04.117810 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m09:52:04.118127 [info ] [Thread-1 (]: 8 of 8 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.02s]
[0m09:52:04.118409 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:52:04.119017 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:04.119156 [debug] [MainThread]: On master: BEGIN
[0m09:52:04.119269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:04.126859 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:52:04.127109 [debug] [MainThread]: On master: COMMIT
[0m09:52:04.127247 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:04.127370 [debug] [MainThread]: On master: COMMIT
[0m09:52:04.127700 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:04.127871 [debug] [MainThread]: On master: Close
[0m09:52:04.128086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:04.128212 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m09:52:04.128361 [info ] [MainThread]: 
[0m09:52:04.128512 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m09:52:04.129264 [debug] [MainThread]: Command end result
[0m09:52:04.145501 [info ] [MainThread]: 
[0m09:52:04.145743 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:52:04.145881 [info ] [MainThread]: 
[0m09:52:04.146069 [error] [MainThread]: [31mFailure in test accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_crd (models/schema.yml)[0m
[0m09:52:04.146236 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m09:52:04.146352 [info ] [MainThread]: 
[0m09:52:04.146506 [info ] [MainThread]:   compiled code at target/compiled/jaffle_shop/models/schema.yml/accepted_values_stg_payments_1f17b5a3357b284478c3d6b14446b282.sql
[0m09:52:04.146635 [info ] [MainThread]: 
[0m09:52:04.146776 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m09:52:04.147905 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.5746916, "process_user_time": 0.971585, "process_kernel_time": 0.158187, "process_mem_max_rss": "119963648", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:52:04.148169 [debug] [MainThread]: Command `dbt test` failed at 09:52:04.148127 after 0.58 seconds
[0m09:52:04.148353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132ed4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133c23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133c0c30>]}
[0m09:52:04.148514 [debug] [MainThread]: Flushing usage events
[0m10:02:30.462037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6bd90>]}


============================== 10:02:30.475775 | 1eaa753f-b015-4054-9294-609fce013df3 ==============================
[0m10:02:30.475775 [info ] [MainThread]: Running with dbt=1.8.8
[0m10:02:30.476130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select test_type:generic', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:02:30.476359 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m10:02:30.476521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1eaa753f-b015-4054-9294-609fce013df3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea0d60>]}
[0m10:02:30.559429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eaa753f-b015-4054-9294-609fce013df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b5b8a0>]}
[0m10:02:30.584183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1eaa753f-b015-4054-9294-609fce013df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c17550>]}
[0m10:02:30.584813 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:02:30.594440 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m10:02:30.667412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:02:30.667651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:02:30.670202 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m10:02:30.691567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1eaa753f-b015-4054-9294-609fce013df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108549310>]}
[0m10:02:30.759469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1eaa753f-b015-4054-9294-609fce013df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca9390>]}
[0m10:02:30.759749 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 423 macros
[0m10:02:30.759911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eaa753f-b015-4054-9294-609fce013df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c95f30>]}
[0m10:02:30.760807 [info ] [MainThread]: 
[0m10:02:30.761103 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:02:30.762986 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m10:02:30.809404 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:02:30.809635 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m10:02:30.809772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:30.839586 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m10:02:30.839878 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:02:30.840053 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:02:30.849099 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m10:02:30.850123 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m10:02:30.850704 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m10:02:30.854541 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:30.854827 [debug] [MainThread]: On master: BEGIN
[0m10:02:30.855149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:02:30.864204 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:02:30.864496 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:30.864747 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:02:30.868939 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m10:02:30.869782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eaa753f-b015-4054-9294-609fce013df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdf590>]}
[0m10:02:30.870058 [debug] [MainThread]: On master: ROLLBACK
[0m10:02:30.870538 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:30.870724 [debug] [MainThread]: On master: BEGIN
[0m10:02:30.871378 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:02:30.871542 [debug] [MainThread]: On master: COMMIT
[0m10:02:30.871685 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:30.871821 [debug] [MainThread]: On master: COMMIT
[0m10:02:30.872204 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:02:30.872398 [debug] [MainThread]: On master: Close
[0m10:02:30.872665 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:02:30.872844 [info ] [MainThread]: 
[0m10:02:30.874943 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m10:02:30.875192 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [RUN]
[0m10:02:30.875439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m10:02:30.875644 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m10:02:30.886888 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m10:02:30.888115 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m10:02:30.896506 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m10:02:30.897295 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m10:02:30.897498 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: BEGIN
[0m10:02:30.897661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:30.904672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:02:30.904925 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m10:02:30.905117 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','return_pending','placed'
)



      
    ) dbt_internal_test
[0m10:02:30.906444 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:02:30.908735 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: ROLLBACK
[0m10:02:30.909180 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: Close
[0m10:02:30.909499 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [[32mPASS[0m in 0.03s]
[0m10:02:30.909798 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m10:02:30.910025 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683
[0m10:02:30.910241 [info ] [Thread-1 (]: 2 of 8 START test accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card  [RUN]
[0m10:02:30.910440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683)
[0m10:02:30.910604 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683
[0m10:02:30.914013 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683"
[0m10:02:30.915251 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683
[0m10:02:30.916308 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683"
[0m10:02:30.917410 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683"
[0m10:02:30.917621 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683: BEGIN
[0m10:02:30.917788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:30.925003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:02:30.925275 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683"
[0m10:02:30.925466 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_payments"
    group by payment_method

)

select *
from all_values
where value_field not in (
    'coupon','credit_card','bank_transfer','gift_card'
)



      
    ) dbt_internal_test
[0m10:02:30.926770 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:02:30.927678 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683: ROLLBACK
[0m10:02:30.928077 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683: Close
[0m10:02:30.928402 [info ] [Thread-1 (]: 2 of 8 PASS accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card  [[32mPASS[0m in 0.02s]
[0m10:02:30.928713 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683
[0m10:02:30.928932 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m10:02:30.929145 [info ] [Thread-1 (]: 3 of 8 START test accepted_values_stg_payments_status__fail__success ........... [RUN]
[0m10:02:30.929343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_payments_payment_method__coupon__credit_card__bank_transfer__gift_card.1f2f05a683, now test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552)
[0m10:02:30.929508 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m10:02:30.932326 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m10:02:30.933007 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m10:02:30.933943 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m10:02:30.934881 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m10:02:30.935067 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: BEGIN
[0m10:02:30.935223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:30.942053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:02:30.942305 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"
[0m10:02:30.942488 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_payments"
    group by status

)

select *
from all_values
where value_field not in (
    'fail','success'
)



      
    ) dbt_internal_test
[0m10:02:30.943497 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:02:30.944297 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: ROLLBACK
[0m10:02:30.944644 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552: Close
[0m10:02:30.944938 [info ] [Thread-1 (]: 3 of 8 PASS accepted_values_stg_payments_status__fail__success ................. [[32mPASS[0m in 0.02s]
[0m10:02:30.945227 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552
[0m10:02:30.945421 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:02:30.945606 [info ] [Thread-1 (]: 4 of 8 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m10:02:30.945790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_payments_status__fail__success.ed64b31552, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m10:02:30.945948 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:02:30.949250 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:02:30.949892 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:02:30.951256 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:02:30.952017 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:02:30.952204 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m10:02:30.952360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:30.962511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:02:30.962797 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:02:30.962996 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt"."dev"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m10:02:30.963973 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:02:30.964845 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m10:02:30.965310 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m10:02:30.965671 [info ] [Thread-1 (]: 4 of 8 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.02s]
[0m10:02:30.966001 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:02:30.966216 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:02:30.966391 [info ] [Thread-1 (]: 5 of 8 START test not_null_stg_orders_order_id ................................. [RUN]
[0m10:02:30.966635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m10:02:30.966827 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:02:30.968940 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:02:30.969560 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:02:30.970475 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:02:30.971044 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:02:30.971209 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m10:02:30.971353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:30.977991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:02:30.978239 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:02:30.978410 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt"."dev"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m10:02:30.979170 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:02:30.979984 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m10:02:30.980440 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m10:02:30.980731 [info ] [Thread-1 (]: 5 of 8 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.01s]
[0m10:02:30.980999 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:02:30.981192 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:02:30.981356 [info ] [Thread-1 (]: 6 of 8 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m10:02:30.981573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m10:02:30.981759 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:02:30.986194 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m10:02:30.986769 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:02:30.987839 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m10:02:30.988472 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m10:02:30.988643 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m10:02:30.988794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:30.995658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:02:30.995895 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m10:02:30.996074 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt"."dev"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt"."dev"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m10:02:30.997052 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:02:30.997917 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m10:02:30.998356 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m10:02:30.998664 [info ] [Thread-1 (]: 6 of 8 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.02s]
[0m10:02:30.998940 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:02:30.999132 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:02:30.999321 [info ] [Thread-1 (]: 7 of 8 START test unique_stg_customers_customer_id ............................. [RUN]
[0m10:02:30.999524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m10:02:30.999693 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:02:31.002801 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m10:02:31.003484 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:02:31.004753 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m10:02:31.005524 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m10:02:31.005695 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m10:02:31.005873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:31.012982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:02:31.013232 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m10:02:31.013423 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:02:31.015940 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:02:31.016762 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m10:02:31.017775 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m10:02:31.018068 [info ] [Thread-1 (]: 7 of 8 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.02s]
[0m10:02:31.018344 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m10:02:31.018543 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:02:31.018755 [info ] [Thread-1 (]: 8 of 8 START test unique_stg_orders_order_id ................................... [RUN]
[0m10:02:31.018990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m10:02:31.019174 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:02:31.021296 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m10:02:31.022341 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:02:31.023551 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m10:02:31.024523 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m10:02:31.024711 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m10:02:31.024868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:31.032643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m10:02:31.032886 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m10:02:31.033072 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:02:31.034047 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:02:31.037258 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m10:02:31.037831 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m10:02:31.038200 [info ] [Thread-1 (]: 8 of 8 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.02s]
[0m10:02:31.038516 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:02:31.039419 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:31.039648 [debug] [MainThread]: On master: BEGIN
[0m10:02:31.039790 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:02:31.048258 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:02:31.048476 [debug] [MainThread]: On master: COMMIT
[0m10:02:31.048614 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:31.048744 [debug] [MainThread]: On master: COMMIT
[0m10:02:31.049161 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:02:31.049299 [debug] [MainThread]: On master: Close
[0m10:02:31.049520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:31.049651 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m10:02:31.049811 [info ] [MainThread]: 
[0m10:02:31.049969 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m10:02:31.050714 [debug] [MainThread]: Command end result
[0m10:02:31.070102 [info ] [MainThread]: 
[0m10:02:31.070790 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:02:31.070975 [info ] [MainThread]: 
[0m10:02:31.071170 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m10:02:31.072886 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.64988136, "process_user_time": 0.970706, "process_kernel_time": 0.170237, "process_mem_max_rss": "117489664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:02:31.073273 [debug] [MainThread]: Command `dbt test` succeeded at 10:02:31.073222 after 0.65 seconds
[0m10:02:31.073473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ff1650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090c0c30>]}
[0m10:02:31.073656 [debug] [MainThread]: Flushing usage events
[0m10:34:09.661158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a59fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b7d90>]}


============================== 10:34:09.675208 | 9761580a-dd08-4f70-bfba-06cd0e857117 ==============================
[0m10:34:09.675208 [info ] [MainThread]: Running with dbt=1.8.8
[0m10:34:09.675543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:34:09.675752 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m10:34:09.675911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9761580a-dd08-4f70-bfba-06cd0e857117', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e8d60>]}
[0m10:34:09.765979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9761580a-dd08-4f70-bfba-06cd0e857117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a78a0>]}
[0m10:34:09.788827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9761580a-dd08-4f70-bfba-06cd0e857117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104167550>]}
[0m10:34:09.789329 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:34:09.799137 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m10:34:09.875244 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m10:34:09.875582 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/marts/order_payment_method_amounts.sql
[0m10:34:09.875729 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/marts/order_payments_method.sql
[0m10:34:09.980615 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m10:34:09.986353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9761580a-dd08-4f70-bfba-06cd0e857117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a96030>]}
[0m10:34:10.043730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9761580a-dd08-4f70-bfba-06cd0e857117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516c9f0>]}
[0m10:34:10.044024 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 423 macros
[0m10:34:10.044194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9761580a-dd08-4f70-bfba-06cd0e857117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513c1f0>]}
[0m10:34:10.045187 [info ] [MainThread]: 
[0m10:34:10.045458 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:34:10.047318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m10:34:10.093658 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m10:34:10.093883 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m10:34:10.094021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:10.178231 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.084 seconds
[0m10:34:10.179182 [debug] [ThreadPool]: On list_dbt: Close
[0m10:34:10.180159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m10:34:10.183316 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:34:10.183505 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m10:34:10.183652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:34:10.192784 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m10:34:10.193066 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:34:10.193229 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:34:10.196722 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:34:10.197573 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m10:34:10.197976 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m10:34:10.200803 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:10.201008 [debug] [MainThread]: On master: BEGIN
[0m10:34:10.201147 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:10.208056 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:34:10.208295 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:10.208521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:34:10.213229 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m10:34:10.214061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9761580a-dd08-4f70-bfba-06cd0e857117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105498410>]}
[0m10:34:10.214325 [debug] [MainThread]: On master: ROLLBACK
[0m10:34:10.214721 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:10.214877 [debug] [MainThread]: On master: BEGIN
[0m10:34:10.215429 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:34:10.215629 [debug] [MainThread]: On master: COMMIT
[0m10:34:10.215794 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:10.215939 [debug] [MainThread]: On master: COMMIT
[0m10:34:10.216284 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:34:10.216462 [debug] [MainThread]: On master: Close
[0m10:34:10.216717 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:34:10.216893 [info ] [MainThread]: 
[0m10:34:10.218338 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m10:34:10.218647 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.stg_customers .................................. [RUN]
[0m10:34:10.218900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m10:34:10.219083 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m10:34:10.223534 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m10:34:10.224664 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m10:34:10.242484 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m10:34:10.243647 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:34:10.243812 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m10:34:10.243954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:10.256882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:34:10.257113 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:34:10.257278 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m10:34:10.259825 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:34:10.262990 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:34:10.263198 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m10:34:10.264368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:34:10.265742 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:34:10.265925 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m10:34:10.266553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:34:10.277340 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:34:10.277597 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:34:10.277770 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:34:10.281330 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:34:10.284424 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m10:34:10.286939 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:34:10.287147 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m10:34:10.290696 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:34:10.292009 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m10:34:10.292807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9761580a-dd08-4f70-bfba-06cd0e857117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050df800>]}
[0m10:34:10.293159 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m10:34:10.293492 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m10:34:10.293723 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m10:34:10.293979 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.stg_orders ..................................... [RUN]
[0m10:34:10.294194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m10:34:10.294365 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m10:34:10.295615 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m10:34:10.296316 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m10:34:10.298165 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m10:34:10.298742 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:34:10.298905 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m10:34:10.299058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:10.306493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:34:10.306751 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:34:10.306915 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m10:34:10.307893 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:34:10.309401 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:34:10.309587 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m10:34:10.310157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:34:10.311459 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:34:10.311628 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:34:10.312067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:34:10.313116 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:34:10.313285 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:34:10.313434 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:34:10.315166 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:34:10.316226 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m10:34:10.316563 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:34:10.316737 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m10:34:10.319059 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:34:10.319717 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m10:34:10.320012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9761580a-dd08-4f70-bfba-06cd0e857117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105566ad0>]}
[0m10:34:10.320422 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.03s]
[0m10:34:10.320797 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m10:34:10.321011 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m10:34:10.321261 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.stg_payments ................................... [RUN]
[0m10:34:10.321518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m10:34:10.321689 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m10:34:10.323007 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m10:34:10.323591 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m10:34:10.325429 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m10:34:10.326076 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:34:10.326243 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m10:34:10.326396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:10.333225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:34:10.333482 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:34:10.333665 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    amount / 100 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m10:34:10.334881 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:34:10.336480 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:34:10.336690 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m10:34:10.337347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:34:10.338785 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:34:10.338976 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m10:34:10.339865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:34:10.340795 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:34:10.340993 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:34:10.341155 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:34:10.342379 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:34:10.343750 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m10:34:10.344099 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:34:10.344265 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m10:34:10.346025 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:34:10.346680 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m10:34:10.346936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9761580a-dd08-4f70-bfba-06cd0e857117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105461d50>]}
[0m10:34:10.347230 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.03s]
[0m10:34:10.347510 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m10:34:10.347912 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m10:34:10.348178 [info ] [Thread-1 (]: 4 of 6 START sql table model dev.fct_orders .................................... [RUN]
[0m10:34:10.348417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m10:34:10.348595 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m10:34:10.350072 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m10:34:10.350899 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m10:34:10.362409 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m10:34:10.363038 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:34:10.363217 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m10:34:10.363365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:10.373243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:34:10.373557 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:34:10.373738 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    

  create  table "dbt"."dev"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
  
[0m10:34:10.377384 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.003 seconds
[0m10:34:10.378961 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:34:10.379144 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders" rename to "fct_orders__dbt_backup"
[0m10:34:10.379723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:34:10.381114 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:34:10.381302 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m10:34:10.381771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:34:10.384527 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:34:10.384722 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:34:10.384886 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:34:10.385542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m10:34:10.387200 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m10:34:10.388805 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:34:10.389003 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m10:34:10.392504 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:34:10.393244 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m10:34:10.393520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9761580a-dd08-4f70-bfba-06cd0e857117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055aa3c0>]}
[0m10:34:10.393838 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dev.fct_orders ............................... [[32mSELECT 99[0m in 0.05s]
[0m10:34:10.394137 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m10:34:10.394347 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m10:34:10.394651 [info ] [Thread-1 (]: 5 of 6 START sql table model dev.order_payment_method_amounts .................. [RUN]
[0m10:34:10.394942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m10:34:10.395131 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m10:34:10.396848 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:34:10.397529 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m10:34:10.399398 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:34:10.399770 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:34:10.399954 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m10:34:10.400125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:10.408919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m10:34:10.409186 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:34:10.409386 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  
    

  create  table "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
  
  
    as
  
  (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
  
[0m10:34:10.411332 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.002 seconds
[0m10:34:10.412983 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:34:10.413180 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m10:34:10.413891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:34:10.414773 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:34:10.414970 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:34:10.415138 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:34:10.417678 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:34:10.418675 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m10:34:10.419022 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:34:10.419201 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop table if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m10:34:10.420423 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:34:10.421185 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m10:34:10.421498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9761580a-dd08-4f70-bfba-06cd0e857117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105553530>]}
[0m10:34:10.421812 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dev.order_payment_method_amounts ............. [[32mSELECT 99[0m in 0.03s]
[0m10:34:10.422098 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m10:34:10.422301 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m10:34:10.422510 [info ] [Thread-1 (]: 6 of 6 START sql table model dev.dim_customers ................................. [RUN]
[0m10:34:10.422740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.dim_customers)
[0m10:34:10.422907 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m10:34:10.424693 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m10:34:10.425484 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m10:34:10.427017 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m10:34:10.427671 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:34:10.427843 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m10:34:10.428000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:34:10.435730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m10:34:10.435974 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:34:10.436171 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."dev"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m10:34:10.440191 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.004 seconds
[0m10:34:10.441895 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:34:10.442100 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers" rename to "dim_customers__dbt_backup"
[0m10:34:10.442783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:34:10.444477 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:34:10.444665 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m10:34:10.445144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:34:10.446036 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:34:10.446221 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:34:10.446382 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:34:10.447143 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:34:10.448183 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m10:34:10.448572 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:34:10.448788 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m10:34:10.450644 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:34:10.451329 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m10:34:10.451600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9761580a-dd08-4f70-bfba-06cd0e857117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105553c50>]}
[0m10:34:10.451907 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dev.dim_customers ............................ [[32mSELECT 100[0m in 0.03s]
[0m10:34:10.452198 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m10:34:10.452935 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:10.453111 [debug] [MainThread]: On master: BEGIN
[0m10:34:10.453288 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:34:10.459472 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:34:10.459724 [debug] [MainThread]: On master: COMMIT
[0m10:34:10.459881 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:10.460020 [debug] [MainThread]: On master: COMMIT
[0m10:34:10.460381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:34:10.460562 [debug] [MainThread]: On master: Close
[0m10:34:10.460794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:34:10.460932 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m10:34:10.461138 [info ] [MainThread]: 
[0m10:34:10.461306 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m10:34:10.461967 [debug] [MainThread]: Command end result
[0m10:34:10.478295 [info ] [MainThread]: 
[0m10:34:10.478560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:34:10.478711 [info ] [MainThread]: 
[0m10:34:10.478872 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:34:10.480359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8569658, "process_user_time": 1.087162, "process_kernel_time": 0.199776, "process_mem_max_rss": "119717888", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:34:10.480645 [debug] [MainThread]: Command `dbt run` succeeded at 10:34:10.480598 after 0.86 seconds
[0m10:34:10.480828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10416f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105417530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054172f0>]}
[0m10:34:10.481012 [debug] [MainThread]: Flushing usage events
[0m10:35:17.369121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d7d90>]}


============================== 10:35:17.380818 | 194f466c-0097-4382-9b57-dee025635c37 ==============================
[0m10:35:17.380818 [info ] [MainThread]: Running with dbt=1.8.8
[0m10:35:17.381174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:35:17.381385 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m10:35:17.381546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '194f466c-0097-4382-9b57-dee025635c37', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106710d60>]}
[0m10:35:17.474010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '194f466c-0097-4382-9b57-dee025635c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063cb8a0>]}
[0m10:35:17.497041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '194f466c-0097-4382-9b57-dee025635c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106487550>]}
[0m10:35:17.497590 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:35:17.507067 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m10:35:17.575045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:35:17.575279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:35:17.577813 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m10:35:17.598772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '194f466c-0097-4382-9b57-dee025635c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db5040>]}
[0m10:35:17.657323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '194f466c-0097-4382-9b57-dee025635c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c6dd0>]}
[0m10:35:17.657609 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 423 macros
[0m10:35:17.657781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '194f466c-0097-4382-9b57-dee025635c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073736c0>]}
[0m10:35:17.658793 [info ] [MainThread]: 
[0m10:35:17.659078 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:35:17.660962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m10:35:17.706590 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m10:35:17.706824 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m10:35:17.706967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:17.772721 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.066 seconds
[0m10:35:17.773677 [debug] [ThreadPool]: On list_dbt: Close
[0m10:35:17.774830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m10:35:17.778511 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:35:17.778747 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m10:35:17.778908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:17.785648 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:35:17.785852 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:35:17.786004 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:35:17.789254 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:35:17.790163 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m10:35:17.790643 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m10:35:17.793716 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:17.793968 [debug] [MainThread]: On master: BEGIN
[0m10:35:17.794120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:35:17.802042 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:35:17.802333 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:17.802572 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:35:17.806595 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m10:35:17.807390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '194f466c-0097-4382-9b57-dee025635c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da7890>]}
[0m10:35:17.807642 [debug] [MainThread]: On master: ROLLBACK
[0m10:35:17.808098 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:17.808290 [debug] [MainThread]: On master: BEGIN
[0m10:35:17.808971 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:35:17.809143 [debug] [MainThread]: On master: COMMIT
[0m10:35:17.809288 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:17.809430 [debug] [MainThread]: On master: COMMIT
[0m10:35:17.809799 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:35:17.809971 [debug] [MainThread]: On master: Close
[0m10:35:17.810232 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:35:17.810411 [info ] [MainThread]: 
[0m10:35:17.812004 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m10:35:17.812319 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.stg_customers .................................. [RUN]
[0m10:35:17.812567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m10:35:17.812752 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m10:35:17.817676 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m10:35:17.818672 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m10:35:17.836382 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m10:35:17.837362 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:35:17.837540 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m10:35:17.837681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:17.844797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:35:17.845018 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:35:17.845187 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m10:35:17.846650 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:35:17.849902 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:35:17.850096 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m10:35:17.851585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:35:17.853015 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:35:17.853176 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m10:35:17.854051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:35:17.861910 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:35:17.862113 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:35:17.862279 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:35:17.864263 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:35:17.867002 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m10:35:17.869420 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:35:17.869603 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m10:35:17.872784 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:35:17.874012 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m10:35:17.874752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f466c-0097-4382-9b57-dee025635c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734a620>]}
[0m10:35:17.875074 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m10:35:17.875380 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m10:35:17.875592 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m10:35:17.875883 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.stg_orders ..................................... [RUN]
[0m10:35:17.876154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m10:35:17.876352 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m10:35:17.877929 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m10:35:17.878630 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m10:35:17.880177 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m10:35:17.880755 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:35:17.880925 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m10:35:17.881086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:17.889247 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m10:35:17.889534 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:35:17.889722 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m10:35:17.890933 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m10:35:17.892526 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:35:17.892726 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m10:35:17.893212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:35:17.894763 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:35:17.894949 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:35:17.896207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:35:17.897075 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:35:17.897263 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:35:17.897433 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:35:17.899153 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:35:17.900155 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m10:35:17.900486 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:35:17.900654 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m10:35:17.902416 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:35:17.903088 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m10:35:17.903391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f466c-0097-4382-9b57-dee025635c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b83ec10>]}
[0m10:35:17.903704 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.03s]
[0m10:35:17.904008 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m10:35:17.904227 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m10:35:17.904522 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.stg_payments ................................... [RUN]
[0m10:35:17.904777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m10:35:17.904972 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m10:35:17.906644 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m10:35:17.907386 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m10:35:17.908911 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m10:35:17.909548 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:35:17.909721 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m10:35:17.909934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:17.917485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m10:35:17.917749 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:35:17.917938 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    amount / 100 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m10:35:17.919704 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:35:17.921480 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:35:17.921712 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m10:35:17.922421 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:35:17.924095 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:35:17.924288 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m10:35:17.924774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:35:17.925615 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:35:17.925803 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:35:17.925969 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:35:17.927434 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:35:17.928428 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m10:35:17.928747 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:35:17.928910 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m10:35:17.931259 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:35:17.931931 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m10:35:17.932200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f466c-0097-4382-9b57-dee025635c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ebed0>]}
[0m10:35:17.932502 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.03s]
[0m10:35:17.932789 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m10:35:17.933115 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m10:35:17.933433 [info ] [Thread-1 (]: 4 of 6 START sql table model dev.fct_orders .................................... [RUN]
[0m10:35:17.933678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m10:35:17.933877 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m10:35:17.935345 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m10:35:17.936052 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m10:35:17.947496 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m10:35:17.948156 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:35:17.948336 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m10:35:17.948486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:17.958861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:35:17.959143 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:35:17.959341 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    

  create  table "dbt"."dev"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
  
[0m10:35:17.962352 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.003 seconds
[0m10:35:17.964038 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:35:17.964240 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders" rename to "fct_orders__dbt_backup"
[0m10:35:17.964816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:35:17.968369 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:35:17.968580 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m10:35:17.969251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:35:17.972284 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:35:17.972517 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:35:17.972687 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:35:17.973615 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:35:17.974771 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m10:35:17.976306 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:35:17.976502 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m10:35:17.978514 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:35:17.979298 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m10:35:17.979607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f466c-0097-4382-9b57-dee025635c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b88f1c0>]}
[0m10:35:17.979947 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dev.fct_orders ............................... [[32mSELECT 99[0m in 0.05s]
[0m10:35:17.980265 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m10:35:17.980481 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m10:35:17.980742 [info ] [Thread-1 (]: 5 of 6 START sql table model dev.order_payment_method_amounts .................. [RUN]
[0m10:35:17.981024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m10:35:17.981225 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m10:35:17.982973 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:35:17.983700 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m10:35:17.985568 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:35:17.986189 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:35:17.986369 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m10:35:17.986518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:17.994305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m10:35:17.994571 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:35:17.994861 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  
    

  create  table "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
  
  
    as
  
  (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
  
[0m10:35:17.996311 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.001 seconds
[0m10:35:17.997891 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:35:17.998097 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m10:35:17.998711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:35:17.999568 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:35:17.999769 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:35:17.999944 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:35:18.001789 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:35:18.003080 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m10:35:18.003518 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:35:18.003731 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop table if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m10:35:18.005098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:35:18.007510 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m10:35:18.007804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f466c-0097-4382-9b57-dee025635c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772f170>]}
[0m10:35:18.008136 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dev.order_payment_method_amounts ............. [[32mSELECT 99[0m in 0.03s]
[0m10:35:18.008450 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m10:35:18.008669 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m10:35:18.008921 [info ] [Thread-1 (]: 6 of 6 START sql table model dev.dim_customers ................................. [RUN]
[0m10:35:18.009152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.dim_customers)
[0m10:35:18.009334 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m10:35:18.010839 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m10:35:18.011797 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m10:35:18.013351 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m10:35:18.014111 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:35:18.014435 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m10:35:18.014671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:18.023601 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m10:35:18.024121 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:35:18.024361 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."dev"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m10:35:18.035778 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.011 seconds
[0m10:35:18.038014 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:35:18.038848 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers" rename to "dim_customers__dbt_backup"
[0m10:35:18.039808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:35:18.041710 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:35:18.041954 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m10:35:18.042699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:35:18.043757 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:35:18.043972 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:35:18.044163 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:35:18.045261 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:35:18.046632 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m10:35:18.047264 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:35:18.047647 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m10:35:18.049719 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:35:18.050665 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m10:35:18.051004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '194f466c-0097-4382-9b57-dee025635c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772e0f0>]}
[0m10:35:18.051386 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dev.dim_customers ............................ [[32mSELECT 100[0m in 0.04s]
[0m10:35:18.051759 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m10:35:18.052486 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:18.052671 [debug] [MainThread]: On master: BEGIN
[0m10:35:18.052823 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:35:18.061017 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:35:18.061308 [debug] [MainThread]: On master: COMMIT
[0m10:35:18.061474 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:18.061629 [debug] [MainThread]: On master: COMMIT
[0m10:35:18.062564 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:35:18.063023 [debug] [MainThread]: On master: Close
[0m10:35:18.063312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:18.063482 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m10:35:18.063706 [info ] [MainThread]: 
[0m10:35:18.063901 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m10:35:18.064719 [debug] [MainThread]: Command end result
[0m10:35:18.081871 [info ] [MainThread]: 
[0m10:35:18.082134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:35:18.082289 [info ] [MainThread]: 
[0m10:35:18.082450 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:35:18.084052 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7509142, "process_user_time": 1.012627, "process_kernel_time": 0.185592, "process_mem_max_rss": "115982336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:35:18.084332 [debug] [MainThread]: Command `dbt run` succeeded at 10:35:18.084286 after 0.75 seconds
[0m10:35:18.084526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106495190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b897b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b897b30>]}
[0m10:35:18.084698 [debug] [MainThread]: Flushing usage events
[0m10:36:12.258481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103751fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efbd90>]}


============================== 10:36:12.272037 | ed213bbd-4985-463e-8d96-34a24dfa5fe8 ==============================
[0m10:36:12.272037 [info ] [MainThread]: Running with dbt=1.8.8
[0m10:36:12.272376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:36:12.272578 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m10:36:12.272735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ed213bbd-4985-463e-8d96-34a24dfa5fe8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f34d60>]}
[0m10:36:12.367012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed213bbd-4985-463e-8d96-34a24dfa5fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf38a0>]}
[0m10:36:12.392639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed213bbd-4985-463e-8d96-34a24dfa5fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de7550>]}
[0m10:36:12.393520 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:36:12.404542 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m10:36:12.476849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:36:12.477080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:36:12.479628 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m10:36:12.500736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed213bbd-4985-463e-8d96-34a24dfa5fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d31040>]}
[0m10:36:12.559261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed213bbd-4985-463e-8d96-34a24dfa5fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6c670>]}
[0m10:36:12.559544 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 423 macros
[0m10:36:12.559710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed213bbd-4985-463e-8d96-34a24dfa5fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfedd0>]}
[0m10:36:12.560740 [info ] [MainThread]: 
[0m10:36:12.561040 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:36:12.562876 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m10:36:12.612907 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:36:12.613183 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m10:36:12.613327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:12.750093 [debug] [ThreadPool]: SQL status: BEGIN in 0.137 seconds
[0m10:36:12.750510 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:36:12.750782 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:36:12.759965 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m10:36:12.761270 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m10:36:12.761959 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m10:36:12.766426 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:12.766723 [debug] [MainThread]: On master: BEGIN
[0m10:36:12.766918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:36:12.781271 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m10:36:12.781599 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:12.781910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:36:12.787427 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m10:36:12.788667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed213bbd-4985-463e-8d96-34a24dfa5fe8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0f590>]}
[0m10:36:12.789027 [debug] [MainThread]: On master: ROLLBACK
[0m10:36:12.789720 [debug] [MainThread]: On master: Close
[0m10:36:12.790162 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:36:12.790436 [info ] [MainThread]: 
[0m10:36:12.792641 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m10:36:12.793053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m10:36:12.793327 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m10:36:12.800057 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m10:36:12.801817 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m10:36:12.803134 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m10:36:12.803542 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m10:36:12.803880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m10:36:12.804125 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m10:36:12.805803 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m10:36:12.806609 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m10:36:12.807047 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m10:36:12.807287 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m10:36:12.807553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m10:36:12.807802 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m10:36:12.809311 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m10:36:12.809948 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m10:36:12.810341 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m10:36:12.810580 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m10:36:12.810826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m10:36:12.811064 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m10:36:12.819246 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m10:36:12.820371 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m10:36:12.820731 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m10:36:12.820932 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:36:12.821130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m10:36:12.821300 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:36:12.825441 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:36:12.826027 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:36:12.826352 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m10:36:12.826547 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:36:12.826735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m10:36:12.826902 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:36:12.831092 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m10:36:12.831592 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:36:12.831944 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m10:36:12.832142 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:36:12.832335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m10:36:12.832512 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:36:12.835355 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m10:36:12.835872 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:36:12.836179 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m10:36:12.836366 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m10:36:12.836553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now model.jaffle_shop.fct_orders)
[0m10:36:12.836742 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m10:36:12.837970 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m10:36:12.838604 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m10:36:12.838885 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m10:36:12.839054 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m10:36:12.839232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m10:36:12.839417 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m10:36:12.841099 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:36:12.841720 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m10:36:12.842013 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m10:36:12.842186 [debug] [Thread-1 (]: Began running node test.jaffle_shop.positive_total_payments
[0m10:36:12.842351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now test.jaffle_shop.positive_total_payments)
[0m10:36:12.842495 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.positive_total_payments
[0m10:36:12.843516 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.positive_total_payments"
[0m10:36:12.844135 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.positive_total_payments
[0m10:36:12.844413 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.positive_total_payments
[0m10:36:12.844580 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m10:36:12.844736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.positive_total_payments, now model.jaffle_shop.dim_customers)
[0m10:36:12.844875 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m10:36:12.846003 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m10:36:12.846597 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m10:36:12.846871 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m10:36:12.847337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:12.847482 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m10:36:12.848274 [debug] [MainThread]: Command end result
[0m10:36:12.863117 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.64122736, "process_user_time": 0.904197, "process_kernel_time": 0.174847, "process_mem_max_rss": "115359744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:36:12.863426 [debug] [MainThread]: Command `dbt compile` succeeded at 10:36:12.863378 after 0.64 seconds
[0m10:36:12.863608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118027a70>]}
[0m10:36:12.863771 [debug] [MainThread]: Flushing usage events
[0m11:15:17.206351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c6dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c7d90>]}


============================== 11:15:17.218800 | e91a82eb-239f-41bf-80d0-a6283b767145 ==============================
[0m11:15:17.218800 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:15:17.219126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:15:17.219330 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:15:17.219488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e91a82eb-239f-41bf-80d0-a6283b767145', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104600d60>]}
[0m11:15:17.310724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e91a82eb-239f-41bf-80d0-a6283b767145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042bb8a0>]}
[0m11:15:17.333506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e91a82eb-239f-41bf-80d0-a6283b767145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104377550>]}
[0m11:15:17.334012 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:15:17.344149 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:15:17.410456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:17.410689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:17.413239 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:15:17.434615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e91a82eb-239f-41bf-80d0-a6283b767145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca9040>]}
[0m11:15:17.493721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e91a82eb-239f-41bf-80d0-a6283b767145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b6dd0>]}
[0m11:15:17.494019 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:15:17.494194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e91a82eb-239f-41bf-80d0-a6283b767145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105267860>]}
[0m11:15:17.495218 [info ] [MainThread]: 
[0m11:15:17.495525 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:15:17.497411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:15:17.543203 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:15:17.543433 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:15:17.543577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:17.729437 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.186 seconds
[0m11:15:17.730789 [debug] [ThreadPool]: On list_dbt: Close
[0m11:15:17.732205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m11:15:17.736777 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:15:17.737096 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:15:17.737308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:17.746606 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m11:15:17.747003 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:15:17.747473 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:15:17.753788 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m11:15:17.754986 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:15:17.758722 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:15:17.762925 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:17.763231 [debug] [MainThread]: On master: BEGIN
[0m11:15:17.763436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:17.775657 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:15:17.775970 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:17.776223 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:15:17.782085 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m11:15:17.782931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e91a82eb-239f-41bf-80d0-a6283b767145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c73890>]}
[0m11:15:17.783188 [debug] [MainThread]: On master: ROLLBACK
[0m11:15:17.783620 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:17.783764 [debug] [MainThread]: On master: BEGIN
[0m11:15:17.784406 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:15:17.784601 [debug] [MainThread]: On master: COMMIT
[0m11:15:17.784759 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:17.784902 [debug] [MainThread]: On master: COMMIT
[0m11:15:17.785354 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:15:17.785510 [debug] [MainThread]: On master: Close
[0m11:15:17.785761 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:15:17.785977 [info ] [MainThread]: 
[0m11:15:17.787985 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m11:15:17.788274 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.stg_customers .................................. [RUN]
[0m11:15:17.788658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m11:15:17.789362 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m11:15:17.795312 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m11:15:17.796558 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m11:15:17.823087 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m11:15:17.824378 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:15:17.824593 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m11:15:17.824766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:17.833804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:15:17.834069 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:15:17.834239 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m11:15:17.836270 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:15:17.841021 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:15:17.842080 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:15:17.842943 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:15:17.845418 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:15:17.845624 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:15:17.846350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:15:17.856078 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:15:17.856348 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:15:17.856515 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:15:17.859872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:15:17.863038 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m11:15:17.865345 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:15:17.865549 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m11:15:17.867184 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:15:17.868462 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m11:15:17.869170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e91a82eb-239f-41bf-80d0-a6283b767145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105256ba0>]}
[0m11:15:17.869483 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m11:15:17.869777 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m11:15:17.869981 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m11:15:17.870226 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.stg_orders ..................................... [RUN]
[0m11:15:17.870427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m11:15:17.870585 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m11:15:17.872192 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m11:15:17.872947 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m11:15:17.874296 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m11:15:17.875189 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:15:17.875342 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m11:15:17.875485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:17.884066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:15:17.884317 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:15:17.884485 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m11:15:17.885547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:15:17.886964 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:15:17.887143 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m11:15:17.887712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:15:17.889462 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:15:17.889675 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:15:17.890354 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:15:17.891012 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:15:17.891178 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:15:17.891324 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:15:17.891895 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m11:15:17.892825 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m11:15:17.893062 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:15:17.893221 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m11:15:17.894057 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:15:17.894688 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m11:15:17.894951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e91a82eb-239f-41bf-80d0-a6283b767145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a2cb0>]}
[0m11:15:17.895242 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.02s]
[0m11:15:17.895515 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m11:15:17.895708 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m11:15:17.895954 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.stg_payments ................................... [RUN]
[0m11:15:17.896149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m11:15:17.896307 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m11:15:17.898396 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m11:15:17.899401 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m11:15:17.900724 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m11:15:17.901508 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:15:17.901696 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m11:15:17.901845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:17.914853 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m11:15:17.915131 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:15:17.915314 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    
    (amount / 100)::numeric(16, 2)
 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m11:15:17.917769 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:15:17.919380 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:15:17.919583 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m11:15:17.920701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:15:17.923479 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:15:17.923747 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m11:15:17.925289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:15:17.926112 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:15:17.926311 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:15:17.926473 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:15:17.927366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:15:17.928426 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m11:15:17.928690 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:15:17.928853 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m11:15:17.930255 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:15:17.931023 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m11:15:17.931311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e91a82eb-239f-41bf-80d0-a6283b767145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054dab50>]}
[0m11:15:17.931613 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.04s]
[0m11:15:17.931928 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m11:15:17.932334 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m11:15:17.932605 [info ] [Thread-1 (]: 4 of 6 START sql table model dev.fct_orders .................................... [RUN]
[0m11:15:17.932844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m11:15:17.933022 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m11:15:17.934641 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m11:15:17.935799 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m11:15:17.947524 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m11:15:17.948308 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:15:17.948486 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m11:15:17.948635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:17.958326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m11:15:17.958601 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:15:17.958792 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    

  create  table "dbt"."dev"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
  
[0m11:15:17.962794 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.004 seconds
[0m11:15:17.964357 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:15:17.964551 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders" rename to "fct_orders__dbt_backup"
[0m11:15:17.965174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:15:17.968650 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:15:17.968869 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m11:15:17.969587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:15:17.972316 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m11:15:17.972536 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:15:17.972709 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m11:15:17.973595 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:15:17.974653 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m11:15:17.976107 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:15:17.976299 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m11:15:17.977820 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:15:17.978593 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m11:15:17.978872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e91a82eb-239f-41bf-80d0-a6283b767145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b7150>]}
[0m11:15:17.979191 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dev.fct_orders ............................... [[32mSELECT 99[0m in 0.05s]
[0m11:15:17.979483 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m11:15:17.979691 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m11:15:17.979946 [info ] [Thread-1 (]: 5 of 6 START sql table model dev.order_payment_method_amounts .................. [RUN]
[0m11:15:17.980195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m11:15:17.980371 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m11:15:17.982110 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:15:17.983034 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m11:15:17.984813 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:15:17.985574 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:15:17.985766 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m11:15:17.985930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:17.998162 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m11:15:17.998454 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:15:17.998659 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  
    

  create  table "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
  
  
    as
  
  (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
  
[0m11:15:18.000907 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.002 seconds
[0m11:15:18.002506 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:15:18.002723 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts" rename to "order_payment_method_amounts__dbt_backup"
[0m11:15:18.003303 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:15:18.004802 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:15:18.005021 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m11:15:18.005676 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:15:18.006828 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m11:15:18.007031 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:15:18.007206 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m11:15:18.008054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:15:18.009119 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m11:15:18.009739 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:15:18.009933 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop table if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m11:15:18.015693 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m11:15:18.016441 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m11:15:18.016737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e91a82eb-239f-41bf-80d0-a6283b767145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105569d30>]}
[0m11:15:18.017077 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dev.order_payment_method_amounts ............. [[32mSELECT 99[0m in 0.04s]
[0m11:15:18.017480 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m11:15:18.017733 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m11:15:18.017989 [info ] [Thread-1 (]: 6 of 6 START sql table model dev.dim_customers ................................. [RUN]
[0m11:15:18.018267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.dim_customers)
[0m11:15:18.018460 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m11:15:18.020123 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m11:15:18.021334 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m11:15:18.024632 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m11:15:18.025806 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:15:18.026036 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m11:15:18.026216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:18.034878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:15:18.035165 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:15:18.035385 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."dev"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m11:15:18.038273 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.003 seconds
[0m11:15:18.040090 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:15:18.040319 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers" rename to "dim_customers__dbt_backup"
[0m11:15:18.041061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:15:18.042525 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:15:18.042734 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m11:15:18.043988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:15:18.044703 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m11:15:18.044892 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:15:18.045062 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m11:15:18.046918 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:15:18.048259 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m11:15:18.048540 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:15:18.049091 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m11:15:18.052218 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:15:18.052949 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m11:15:18.053476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e91a82eb-239f-41bf-80d0-a6283b767145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3f710>]}
[0m11:15:18.053807 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dev.dim_customers ............................ [[32mSELECT 100[0m in 0.04s]
[0m11:15:18.054349 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m11:15:18.055008 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:18.055183 [debug] [MainThread]: On master: BEGIN
[0m11:15:18.055332 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:18.064978 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:15:18.065406 [debug] [MainThread]: On master: COMMIT
[0m11:15:18.065659 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:18.065817 [debug] [MainThread]: On master: COMMIT
[0m11:15:18.066419 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:15:18.066607 [debug] [MainThread]: On master: Close
[0m11:15:18.066860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:18.067014 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m11:15:18.067235 [info ] [MainThread]: 
[0m11:15:18.067452 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m11:15:18.068397 [debug] [MainThread]: Command end result
[0m11:15:18.086779 [info ] [MainThread]: 
[0m11:15:18.087175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:18.087333 [info ] [MainThread]: 
[0m11:15:18.087485 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:15:18.089573 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9185835, "process_user_time": 1.046984, "process_kernel_time": 0.195598, "process_mem_max_rss": "117178368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:15:18.089986 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:18.089934 after 0.92 seconds
[0m11:15:18.090319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105707dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105707950>]}
[0m11:15:18.090515 [debug] [MainThread]: Flushing usage events
[0m11:15:38.173021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cfbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cfbed0>]}


============================== 11:15:38.176656 | 19417730-d3f5-4687-8f9f-f6b8fa756a6c ==============================
[0m11:15:38.176656 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:15:38.177010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt source freshness', 'send_anonymous_usage_stats': 'True'}
[0m11:15:38.177220 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:15:38.177382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '19417730-d3f5-4687-8f9f-f6b8fa756a6c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d30e90>]}
[0m11:15:38.252203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19417730-d3f5-4687-8f9f-f6b8fa756a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129ef8a0>]}
[0m11:15:38.275012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19417730-d3f5-4687-8f9f-f6b8fa756a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112beb550>]}
[0m11:15:38.276450 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:15:38.286035 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:15:38.360369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:38.360656 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:38.363820 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:15:38.384947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19417730-d3f5-4687-8f9f-f6b8fa756a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11332d130>]}
[0m11:15:38.442210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19417730-d3f5-4687-8f9f-f6b8fa756a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112deaf90>]}
[0m11:15:38.442504 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:15:38.442673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19417730-d3f5-4687-8f9f-f6b8fa756a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d7ea90>]}
[0m11:15:38.443625 [info ] [MainThread]: 
[0m11:15:38.443905 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:15:38.445794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m11:15:38.478663 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:15:38.478878 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:15:38.479011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:38.502417 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m11:15:38.502668 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:15:38.502825 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:15:38.507124 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m11:15:38.508057 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:15:38.508504 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:15:38.511505 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:38.511701 [debug] [MainThread]: On master: BEGIN
[0m11:15:38.511836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:38.519110 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:15:38.519380 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:38.519605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:15:38.523562 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m11:15:38.524889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19417730-d3f5-4687-8f9f-f6b8fa756a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132ff650>]}
[0m11:15:38.525207 [debug] [MainThread]: On master: ROLLBACK
[0m11:15:38.525758 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:38.525954 [debug] [MainThread]: On master: BEGIN
[0m11:15:38.526653 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:15:38.526816 [debug] [MainThread]: On master: COMMIT
[0m11:15:38.526952 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:38.527080 [debug] [MainThread]: On master: COMMIT
[0m11:15:38.527388 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:15:38.527528 [debug] [MainThread]: On master: Close
[0m11:15:38.527779 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:15:38.527941 [info ] [MainThread]: 
[0m11:15:38.529425 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.customers
[0m11:15:38.529650 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.customers ................................ [RUN]
[0m11:15:38.529850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now source.jaffle_shop.jaffle_shop.customers)
[0m11:15:38.530006 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.customers
[0m11:15:38.530159 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.customers
[0m11:15:38.530401 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:15:38.530548 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: BEGIN
[0m11:15:38.530688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:38.537788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m11:15:38.538128 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:15:38.538307 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:15:38.538465 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:15:38.538919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m11:15:38.539162 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: Close
[0m11:15:38.540999 [debug] [Thread-1 (]: Runtime Error in source customers (models/sources.yml)
  Could not compute freshness for source customers: no 'loaded_at_field' provided and postgres adapter does not support metadata-based freshness checks.
[0m11:15:38.541286 [error] [Thread-1 (]: 1 of 1 ERROR freshness of jaffle_shop.customers ................................ [[31mERROR[0m in 0.01s]
[0m11:15:38.541567 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.customers
[0m11:15:38.542151 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:38.542326 [debug] [MainThread]: On master: BEGIN
[0m11:15:38.542465 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:38.549649 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:15:38.549951 [debug] [MainThread]: On master: COMMIT
[0m11:15:38.550097 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:38.550229 [debug] [MainThread]: On master: COMMIT
[0m11:15:38.550593 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:15:38.550756 [debug] [MainThread]: On master: Close
[0m11:15:38.550975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:38.551106 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.customers' was properly closed.
[0m11:15:38.551253 [info ] [MainThread]: 
[0m11:15:38.551408 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m11:15:38.565057 [info ] [MainThread]: 
[0m11:15:38.565332 [error] [MainThread]:   Runtime Error in source customers (models/sources.yml)
  Could not compute freshness for source customers: no 'loaded_at_field' provided and postgres adapter does not support metadata-based freshness checks.
[0m11:15:38.565481 [info ] [MainThread]: Done.
[0m11:15:38.567064 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 0.4253896, "process_user_time": 0.860172, "process_kernel_time": 0.14565, "process_mem_max_rss": "115523584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:15:38.567420 [debug] [MainThread]: Command `dbt source freshness` failed at 11:15:38.567368 after 0.43 seconds
[0m11:15:38.567644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aea990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dd2a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dd2b70>]}
[0m11:15:38.567817 [debug] [MainThread]: Flushing usage events
[0m11:23:14.383633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fbed0>]}


============================== 11:23:14.400865 | 56cebd2e-66fd-4f34-8fb6-12009db44806 ==============================
[0m11:23:14.400865 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:23:14.401196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:23:14.401400 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:23:14.401563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '56cebd2e-66fd-4f34-8fb6-12009db44806', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108230e90>]}
[0m11:23:14.493656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56cebd2e-66fd-4f34-8fb6-12009db44806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107def8a0>]}
[0m11:23:14.516460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56cebd2e-66fd-4f34-8fb6-12009db44806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e7550>]}
[0m11:23:14.516940 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:23:14.528274 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:23:14.600047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:14.600280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:14.602770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:23:14.624539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56cebd2e-66fd-4f34-8fb6-12009db44806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10882d130>]}
[0m11:23:14.687374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56cebd2e-66fd-4f34-8fb6-12009db44806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082eaf90>]}
[0m11:23:14.687664 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:23:14.687829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56cebd2e-66fd-4f34-8fb6-12009db44806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827ea90>]}
[0m11:23:14.688759 [info ] [MainThread]: 
[0m11:23:14.689045 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:23:14.690937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m11:23:14.737310 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:23:14.737534 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:23:14.737670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:14.784617 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m11:23:14.784902 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:23:14.785070 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:23:14.790983 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m11:23:14.791908 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:23:14.792346 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:23:14.795367 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:14.795558 [debug] [MainThread]: On master: BEGIN
[0m11:23:14.795693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:14.802696 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:23:14.802915 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:14.803129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:23:14.806504 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m11:23:14.807289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56cebd2e-66fd-4f34-8fb6-12009db44806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108803650>]}
[0m11:23:14.807542 [debug] [MainThread]: On master: ROLLBACK
[0m11:23:14.807950 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:14.808148 [debug] [MainThread]: On master: BEGIN
[0m11:23:14.808786 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:23:14.808932 [debug] [MainThread]: On master: COMMIT
[0m11:23:14.809064 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:14.809191 [debug] [MainThread]: On master: COMMIT
[0m11:23:14.809592 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:23:14.809753 [debug] [MainThread]: On master: Close
[0m11:23:14.809995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:14.810158 [info ] [MainThread]: 
[0m11:23:14.811649 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.customers
[0m11:23:14.811890 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.customers ................................ [RUN]
[0m11:23:14.812129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now source.jaffle_shop.jaffle_shop.customers)
[0m11:23:14.812313 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.customers
[0m11:23:14.812482 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.customers
[0m11:23:14.812743 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:23:14.812904 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: BEGIN
[0m11:23:14.813052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:14.821054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:23:14.821372 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:23:14.821552 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:23:14.821718 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:23:14.822131 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m11:23:14.822364 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: Close
[0m11:23:14.824247 [debug] [Thread-1 (]: Runtime Error in source customers (models/sources.yml)
  Could not compute freshness for source customers: no 'loaded_at_field' provided and postgres adapter does not support metadata-based freshness checks.
[0m11:23:14.824543 [error] [Thread-1 (]: 1 of 1 ERROR freshness of jaffle_shop.customers ................................ [[31mERROR[0m in 0.01s]
[0m11:23:14.824855 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.customers
[0m11:23:14.825494 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:14.825661 [debug] [MainThread]: On master: BEGIN
[0m11:23:14.825797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:14.832668 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:23:14.832918 [debug] [MainThread]: On master: COMMIT
[0m11:23:14.833057 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:14.833178 [debug] [MainThread]: On master: COMMIT
[0m11:23:14.833604 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:23:14.833770 [debug] [MainThread]: On master: Close
[0m11:23:14.833982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:14.834110 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.customers' was properly closed.
[0m11:23:14.834263 [info ] [MainThread]: 
[0m11:23:14.834427 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m11:23:14.848113 [info ] [MainThread]: 
[0m11:23:14.848364 [error] [MainThread]:   Runtime Error in source customers (models/sources.yml)
  Could not compute freshness for source customers: no 'loaded_at_field' provided and postgres adapter does not support metadata-based freshness checks.
[0m11:23:14.848504 [info ] [MainThread]: Done.
[0m11:23:14.850075 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 0.50173116, "process_user_time": 0.850722, "process_kernel_time": 0.175432, "process_mem_max_rss": "114393088", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:14.850498 [debug] [MainThread]: Command `dbt source freshness` failed at 11:23:14.850443 after 0.50 seconds
[0m11:23:14.850716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd2a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd2b70>]}
[0m11:23:14.850901 [debug] [MainThread]: Flushing usage events
[0m11:23:28.932795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106559fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb7d90>]}


============================== 11:23:28.936077 | 3579063b-1882-4e7b-a81c-33f818ab6ce8 ==============================
[0m11:23:28.936077 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:23:28.936409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:23:28.936634 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:23:28.936795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3579063b-1882-4e7b-a81c-33f818ab6ce8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eecd60>]}
[0m11:23:29.011920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3579063b-1882-4e7b-a81c-33f818ab6ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bab8a0>]}
[0m11:23:29.034565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3579063b-1882-4e7b-a81c-33f818ab6ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c63550>]}
[0m11:23:29.035233 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:23:29.044724 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:23:29.112446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:29.112733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:29.115485 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:23:29.137682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3579063b-1882-4e7b-a81c-33f818ab6ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108591040>]}
[0m11:23:29.194459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3579063b-1882-4e7b-a81c-33f818ab6ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa2dd0>]}
[0m11:23:29.194757 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:23:29.194929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3579063b-1882-4e7b-a81c-33f818ab6ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b53860>]}
[0m11:23:29.195926 [info ] [MainThread]: 
[0m11:23:29.196210 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:23:29.198086 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:23:29.230911 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:23:29.231157 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:23:29.231295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:29.248414 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.017 seconds
[0m11:23:29.249226 [debug] [ThreadPool]: On list_dbt: Close
[0m11:23:29.250146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m11:23:29.253148 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:23:29.253421 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:23:29.253587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:29.260195 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m11:23:29.260443 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:23:29.260594 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:23:29.263046 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m11:23:29.263849 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:23:29.264215 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:23:29.269186 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:29.270288 [debug] [MainThread]: On master: BEGIN
[0m11:23:29.270718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:29.286914 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m11:23:29.287201 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:29.287407 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:23:29.293060 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m11:23:29.293874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3579063b-1882-4e7b-a81c-33f818ab6ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10855f890>]}
[0m11:23:29.294131 [debug] [MainThread]: On master: ROLLBACK
[0m11:23:29.294613 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:29.294763 [debug] [MainThread]: On master: BEGIN
[0m11:23:29.295540 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:23:29.295696 [debug] [MainThread]: On master: COMMIT
[0m11:23:29.295832 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:29.295963 [debug] [MainThread]: On master: COMMIT
[0m11:23:29.296358 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:23:29.296510 [debug] [MainThread]: On master: Close
[0m11:23:29.296815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:29.297003 [info ] [MainThread]: 
[0m11:23:29.298705 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m11:23:29.299007 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.stg_customers .................................. [RUN]
[0m11:23:29.299256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m11:23:29.299893 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m11:23:29.304130 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m11:23:29.304987 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m11:23:29.323393 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m11:23:29.324260 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:23:29.324454 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m11:23:29.324613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:29.330761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m11:23:29.331014 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:23:29.331244 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m11:23:29.333625 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:23:29.336797 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:23:29.336999 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:23:29.337577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:23:29.339051 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:23:29.339226 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:23:29.339667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:23:29.347647 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:23:29.347848 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:23:29.348008 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:23:29.349583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:23:29.352532 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m11:23:29.354795 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:23:29.354983 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m11:23:29.356365 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:23:29.357554 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m11:23:29.358272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3579063b-1882-4e7b-a81c-33f818ab6ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b42ba0>]}
[0m11:23:29.358590 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m11:23:29.358893 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m11:23:29.359095 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m11:23:29.359337 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.stg_orders ..................................... [RUN]
[0m11:23:29.359544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m11:23:29.359700 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m11:23:29.361161 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m11:23:29.361871 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m11:23:29.363186 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m11:23:29.363765 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:23:29.363930 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m11:23:29.364078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:29.370658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m11:23:29.370906 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:23:29.371075 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m11:23:29.372038 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:23:29.373492 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:23:29.373677 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m11:23:29.374189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:23:29.375664 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:23:29.375842 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:23:29.376367 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:23:29.377084 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:23:29.377271 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:23:29.377430 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:23:29.378285 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:23:29.379205 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m11:23:29.379439 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:23:29.379599 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m11:23:29.380431 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:23:29.381064 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m11:23:29.381327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3579063b-1882-4e7b-a81c-33f818ab6ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d042cb0>]}
[0m11:23:29.381613 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.02s]
[0m11:23:29.381882 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m11:23:29.382077 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m11:23:29.382390 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.stg_payments ................................... [RUN]
[0m11:23:29.382850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m11:23:29.383032 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m11:23:29.385193 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m11:23:29.385990 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m11:23:29.387276 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m11:23:29.387797 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:23:29.387966 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m11:23:29.388254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:29.394124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m11:23:29.394350 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:23:29.394519 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    
    (amount / 100)::numeric(16, 2)
 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m11:23:29.395663 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:23:29.397082 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:23:29.397266 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m11:23:29.398613 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:23:29.400217 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:23:29.400443 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m11:23:29.401490 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:23:29.402338 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:23:29.402520 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:23:29.402671 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:23:29.404361 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:23:29.405413 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m11:23:29.405676 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:23:29.405847 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m11:23:29.407850 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:23:29.408523 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m11:23:29.408785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3579063b-1882-4e7b-a81c-33f818ab6ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc6b50>]}
[0m11:23:29.409082 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.03s]
[0m11:23:29.409364 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m11:23:29.409762 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m11:23:29.410010 [info ] [Thread-1 (]: 4 of 6 START sql table model dev.fct_orders .................................... [RUN]
[0m11:23:29.410225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m11:23:29.410398 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m11:23:29.411850 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m11:23:29.412631 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m11:23:29.424250 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m11:23:29.425040 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:23:29.425232 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m11:23:29.425387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:29.435796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m11:23:29.436503 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:23:29.436735 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    

  create  table "dbt"."dev"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
  
[0m11:23:29.440092 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.003 seconds
[0m11:23:29.441954 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:23:29.442174 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders" rename to "fct_orders__dbt_backup"
[0m11:23:29.442734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:23:29.446455 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:23:29.446692 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m11:23:29.447360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:23:29.451084 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m11:23:29.451293 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:23:29.451461 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m11:23:29.453080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:23:29.454081 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m11:23:29.455499 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:23:29.455707 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m11:23:29.459232 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:23:29.459980 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m11:23:29.460406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3579063b-1882-4e7b-a81c-33f818ab6ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0527b0>]}
[0m11:23:29.460864 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dev.fct_orders ............................... [[32mSELECT 99[0m in 0.05s]
[0m11:23:29.461186 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m11:23:29.461405 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m11:23:29.461731 [info ] [Thread-1 (]: 5 of 6 START sql table model dev.order_payment_method_amounts .................. [RUN]
[0m11:23:29.461998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m11:23:29.462207 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m11:23:29.463956 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:23:29.464618 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m11:23:29.466467 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:23:29.467155 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:23:29.467452 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m11:23:29.467640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:29.476069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:23:29.476316 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:23:29.476505 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  
    

  create  table "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
  
  
    as
  
  (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
  
[0m11:23:29.479464 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.003 seconds
[0m11:23:29.481113 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:23:29.481333 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts" rename to "order_payment_method_amounts__dbt_backup"
[0m11:23:29.481854 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:23:29.483375 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:23:29.483601 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m11:23:29.484448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:23:29.485796 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m11:23:29.486028 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:23:29.486202 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m11:23:29.487131 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:23:29.488215 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m11:23:29.488498 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:23:29.488682 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop table if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m11:23:29.490349 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:23:29.491095 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m11:23:29.491381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3579063b-1882-4e7b-a81c-33f818ab6ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e55cd0>]}
[0m11:23:29.491715 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dev.order_payment_method_amounts ............. [[32mSELECT 99[0m in 0.03s]
[0m11:23:29.492036 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m11:23:29.492251 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m11:23:29.492487 [info ] [Thread-1 (]: 6 of 6 START sql table model dev.dim_customers ................................. [RUN]
[0m11:23:29.492696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.dim_customers)
[0m11:23:29.492860 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m11:23:29.494385 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m11:23:29.495286 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m11:23:29.497013 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m11:23:29.497478 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:23:29.497657 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m11:23:29.497819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:29.506169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:23:29.506428 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:23:29.506657 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."dev"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m11:23:29.509922 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.003 seconds
[0m11:23:29.511535 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:23:29.511737 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers" rename to "dim_customers__dbt_backup"
[0m11:23:29.512258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:23:29.513695 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:23:29.513919 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m11:23:29.514368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:23:29.515100 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m11:23:29.515284 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:23:29.515454 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m11:23:29.516722 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:23:29.518351 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m11:23:29.518695 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:23:29.518876 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m11:23:29.520772 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m11:23:29.521641 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m11:23:29.521960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3579063b-1882-4e7b-a81c-33f818ab6ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b81910>]}
[0m11:23:29.522303 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dev.dim_customers ............................ [[32mSELECT 100[0m in 0.03s]
[0m11:23:29.522626 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m11:23:29.523278 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:29.523452 [debug] [MainThread]: On master: BEGIN
[0m11:23:29.523591 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:29.532461 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:23:29.532749 [debug] [MainThread]: On master: COMMIT
[0m11:23:29.532909 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:29.533061 [debug] [MainThread]: On master: COMMIT
[0m11:23:29.533458 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:23:29.533681 [debug] [MainThread]: On master: Close
[0m11:23:29.533964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:29.534127 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m11:23:29.534361 [info ] [MainThread]: 
[0m11:23:29.534558 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m11:23:29.535383 [debug] [MainThread]: Command end result
[0m11:23:29.555478 [info ] [MainThread]: 
[0m11:23:29.555760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:29.555915 [info ] [MainThread]: 
[0m11:23:29.556069 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:23:29.557358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.66430813, "process_user_time": 1.010404, "process_kernel_time": 0.159129, "process_mem_max_rss": "115015680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:29.557708 [debug] [MainThread]: Command `dbt run` succeeded at 11:23:29.557655 after 0.66 seconds
[0m11:23:29.557921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d83a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d09ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d09b9b0>]}
[0m11:23:29.558111 [debug] [MainThread]: Flushing usage events
[0m11:23:35.166328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107119fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a73d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a73ed0>]}


============================== 11:23:35.169432 | e5c8d35a-ba5d-4c72-ab78-5b42fc7702ea ==============================
[0m11:23:35.169432 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:23:35.169762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt source freshness', 'send_anonymous_usage_stats': 'True'}
[0m11:23:35.169974 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:23:35.170130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e5c8d35a-ba5d-4c72-ab78-5b42fc7702ea', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa8e90>]}
[0m11:23:35.246370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5c8d35a-ba5d-4c72-ab78-5b42fc7702ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087678a0>]}
[0m11:23:35.269058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5c8d35a-ba5d-4c72-ab78-5b42fc7702ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108823550>]}
[0m11:23:35.269764 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:23:35.278259 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:23:35.355837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:35.356101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:35.358941 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:23:35.382089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5c8d35a-ba5d-4c72-ab78-5b42fc7702ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109149130>]}
[0m11:23:35.439344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5c8d35a-ba5d-4c72-ab78-5b42fc7702ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b62f90>]}
[0m11:23:35.439615 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:23:35.439778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5c8d35a-ba5d-4c72-ab78-5b42fc7702ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af6a90>]}
[0m11:23:35.440731 [info ] [MainThread]: 
[0m11:23:35.441014 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:23:35.442894 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m11:23:35.475319 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:23:35.475551 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:23:35.475690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:35.495442 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m11:23:35.495704 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:23:35.495864 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:23:35.500627 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m11:23:35.501432 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:23:35.501859 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:23:35.504936 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:35.505161 [debug] [MainThread]: On master: BEGIN
[0m11:23:35.505306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:35.523795 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m11:23:35.524064 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:35.524286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:23:35.527596 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m11:23:35.528411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5c8d35a-ba5d-4c72-ab78-5b42fc7702ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10912f650>]}
[0m11:23:35.528661 [debug] [MainThread]: On master: ROLLBACK
[0m11:23:35.529063 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:35.529210 [debug] [MainThread]: On master: BEGIN
[0m11:23:35.529794 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:23:35.529938 [debug] [MainThread]: On master: COMMIT
[0m11:23:35.530068 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:35.530194 [debug] [MainThread]: On master: COMMIT
[0m11:23:35.530509 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:23:35.530672 [debug] [MainThread]: On master: Close
[0m11:23:35.530932 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:35.531117 [info ] [MainThread]: 
[0m11:23:35.533060 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.customers
[0m11:23:35.533282 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.customers ................................ [RUN]
[0m11:23:35.533534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now source.jaffle_shop.jaffle_shop.customers)
[0m11:23:35.533756 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.customers
[0m11:23:35.533938 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.customers
[0m11:23:35.534220 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:23:35.534383 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: BEGIN
[0m11:23:35.534530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:35.543067 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:23:35.543313 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:23:35.543466 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:23:35.543615 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:23:35.544008 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m11:23:35.544253 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: Close
[0m11:23:35.546047 [debug] [Thread-1 (]: Runtime Error in source customers (models/sources.yml)
  Could not compute freshness for source customers: no 'loaded_at_field' provided and postgres adapter does not support metadata-based freshness checks.
[0m11:23:35.546317 [error] [Thread-1 (]: 1 of 1 ERROR freshness of jaffle_shop.customers ................................ [[31mERROR[0m in 0.01s]
[0m11:23:35.546601 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.customers
[0m11:23:35.547187 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:35.547359 [debug] [MainThread]: On master: BEGIN
[0m11:23:35.547494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:35.554039 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m11:23:35.554257 [debug] [MainThread]: On master: COMMIT
[0m11:23:35.554387 [debug] [MainThread]: Using postgres connection "master"
[0m11:23:35.554511 [debug] [MainThread]: On master: COMMIT
[0m11:23:35.554874 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:23:35.555066 [debug] [MainThread]: On master: Close
[0m11:23:35.555294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:35.555435 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.customers' was properly closed.
[0m11:23:35.555590 [info ] [MainThread]: 
[0m11:23:35.555750 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m11:23:35.569147 [info ] [MainThread]: 
[0m11:23:35.569451 [error] [MainThread]:   Runtime Error in source customers (models/sources.yml)
  Could not compute freshness for source customers: no 'loaded_at_field' provided and postgres adapter does not support metadata-based freshness checks.
[0m11:23:35.569603 [info ] [MainThread]: Done.
[0m11:23:35.570647 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 0.44054046, "process_user_time": 0.855616, "process_kernel_time": 0.146896, "process_mem_max_rss": "112001024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:35.570960 [debug] [MainThread]: Command `dbt source freshness` failed at 11:23:35.570914 after 0.44 seconds
[0m11:23:35.571153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099daa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099dab70>]}
[0m11:23:35.571315 [debug] [MainThread]: Flushing usage events
[0m11:25:33.183797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105751fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100bfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100bfd90>]}


============================== 11:25:33.207898 | 0fa22aa1-7db2-4fb7-87ca-98b88ffc289d ==============================
[0m11:25:33.207898 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:25:33.208223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:25:33.208443 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:25:33.208600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0fa22aa1-7db2-4fb7-87ca-98b88ffc289d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f8d60>]}
[0m11:25:33.290742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fa22aa1-7db2-4fb7-87ca-98b88ffc289d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bef8a0>]}
[0m11:25:33.314894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fa22aa1-7db2-4fb7-87ca-98b88ffc289d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107caf550>]}
[0m11:25:33.315513 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:25:33.325148 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:25:33.398772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:25:33.399042 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:25:33.401747 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:25:33.424386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fa22aa1-7db2-4fb7-87ca-98b88ffc289d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107cd040>]}
[0m11:25:33.483330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fa22aa1-7db2-4fb7-87ca-98b88ffc289d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110608750>]}
[0m11:25:33.483622 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:25:33.483800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fa22aa1-7db2-4fb7-87ca-98b88ffc289d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a6f70>]}
[0m11:25:33.484852 [info ] [MainThread]: 
[0m11:25:33.485151 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:25:33.487111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m11:25:33.533932 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:25:33.534157 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:25:33.534295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:33.567973 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m11:25:33.568250 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:25:33.568416 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:25:33.573843 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m11:25:33.574848 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:25:33.575496 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:25:33.579164 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:33.579467 [debug] [MainThread]: On master: BEGIN
[0m11:25:33.579874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:25:33.588024 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:25:33.588308 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:33.588554 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:25:33.591984 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m11:25:33.592798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fa22aa1-7db2-4fb7-87ca-98b88ffc289d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11079b590>]}
[0m11:25:33.593046 [debug] [MainThread]: On master: ROLLBACK
[0m11:25:33.593507 [debug] [MainThread]: On master: Close
[0m11:25:33.593772 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:25:33.593948 [info ] [MainThread]: 
[0m11:25:33.596523 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m11:25:33.596817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m11:25:33.597025 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m11:25:33.602165 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m11:25:33.603634 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m11:25:33.604125 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m11:25:33.604339 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m11:25:33.604533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m11:25:33.604702 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m11:25:33.606056 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m11:25:33.606904 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m11:25:33.607271 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m11:25:33.607475 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m11:25:33.607687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m11:25:33.607902 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m11:25:33.609902 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m11:25:33.610522 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m11:25:33.610852 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m11:25:33.611057 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m11:25:33.611266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m11:25:33.611463 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m11:25:33.619057 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m11:25:33.620173 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m11:25:33.620541 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m11:25:33.620739 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:25:33.620938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m11:25:33.621097 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:25:33.624945 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:25:33.625635 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:25:33.625935 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:25:33.626115 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:25:33.626291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m11:25:33.626446 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:25:33.630327 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:25:33.631035 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:25:33.631359 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:25:33.631541 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:25:33.631723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m11:25:33.631877 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:25:33.634595 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:25:33.635265 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:25:33.635588 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:25:33.635771 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m11:25:33.635952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now model.jaffle_shop.fct_orders)
[0m11:25:33.636101 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m11:25:33.637337 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m11:25:33.638029 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m11:25:33.638328 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m11:25:33.638506 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m11:25:33.638740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m11:25:33.638958 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m11:25:33.640852 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:25:33.641641 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m11:25:33.641962 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m11:25:33.642148 [debug] [Thread-1 (]: Began running node test.jaffle_shop.positive_total_payments
[0m11:25:33.642333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now test.jaffle_shop.positive_total_payments)
[0m11:25:33.642482 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.positive_total_payments
[0m11:25:33.643634 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.positive_total_payments"
[0m11:25:33.644480 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.positive_total_payments
[0m11:25:33.644773 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.positive_total_payments
[0m11:25:33.644948 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m11:25:33.645126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.positive_total_payments, now model.jaffle_shop.dim_customers)
[0m11:25:33.645272 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m11:25:33.646502 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m11:25:33.647207 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m11:25:33.647593 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m11:25:33.648147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:33.648278 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m11:25:33.649077 [debug] [MainThread]: Command end result
[0m11:25:33.666472 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.5180361, "process_user_time": 0.900449, "process_kernel_time": 0.159044, "process_mem_max_rss": "115392512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:25:33.666844 [debug] [MainThread]: Command `dbt compile` succeeded at 11:25:33.666767 after 0.52 seconds
[0m11:25:33.667069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114f7120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124cafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124c8d70>]}
[0m11:25:33.667252 [debug] [MainThread]: Flushing usage events
[0m11:25:40.935322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d51fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066afed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066afd90>]}


============================== 11:25:40.938681 | b28bf390-7539-4f7a-b445-ca4b159cea54 ==============================
[0m11:25:40.938681 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:25:40.939007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:25:40.939221 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:25:40.939380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b28bf390-7539-4f7a-b445-ca4b159cea54', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e4d60>]}
[0m11:25:41.019916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b28bf390-7539-4f7a-b445-ca4b159cea54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639f8a0>]}
[0m11:25:41.045674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b28bf390-7539-4f7a-b445-ca4b159cea54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645b550>]}
[0m11:25:41.046674 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:25:41.056207 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:25:41.126828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:25:41.127101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:25:41.129892 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:25:41.152018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b28bf390-7539-4f7a-b445-ca4b159cea54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d89040>]}
[0m11:25:41.209598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b28bf390-7539-4f7a-b445-ca4b159cea54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679add0>]}
[0m11:25:41.210434 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:25:41.210614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b28bf390-7539-4f7a-b445-ca4b159cea54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734b860>]}
[0m11:25:41.211643 [info ] [MainThread]: 
[0m11:25:41.211926 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:25:41.214458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:25:41.247837 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:25:41.248066 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:25:41.248206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:41.270656 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.022 seconds
[0m11:25:41.271448 [debug] [ThreadPool]: On list_dbt: Close
[0m11:25:41.272266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m11:25:41.275025 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:25:41.275227 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:25:41.275375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:41.282507 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m11:25:41.282734 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:25:41.282898 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:25:41.285628 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m11:25:41.286452 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:25:41.286892 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:25:41.289793 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:41.290005 [debug] [MainThread]: On master: BEGIN
[0m11:25:41.290148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:25:41.296863 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:25:41.297060 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:41.297268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:25:41.300796 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m11:25:41.301636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b28bf390-7539-4f7a-b445-ca4b159cea54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d57890>]}
[0m11:25:41.301899 [debug] [MainThread]: On master: ROLLBACK
[0m11:25:41.302365 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:41.302526 [debug] [MainThread]: On master: BEGIN
[0m11:25:41.303210 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:25:41.303424 [debug] [MainThread]: On master: COMMIT
[0m11:25:41.303593 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:41.303746 [debug] [MainThread]: On master: COMMIT
[0m11:25:41.304152 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:25:41.304315 [debug] [MainThread]: On master: Close
[0m11:25:41.304566 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:25:41.304738 [info ] [MainThread]: 
[0m11:25:41.306198 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m11:25:41.306537 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.stg_customers .................................. [RUN]
[0m11:25:41.306804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m11:25:41.307479 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m11:25:41.311764 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m11:25:41.312318 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m11:25:41.330897 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m11:25:41.331683 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:25:41.331875 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m11:25:41.332031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:41.343973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m11:25:41.344182 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:25:41.344361 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m11:25:41.347425 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:25:41.351481 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:25:41.351759 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:25:41.353213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:25:41.355258 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:25:41.355489 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:25:41.356161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:41.364975 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:25:41.365196 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:25:41.365357 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:25:41.367085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:25:41.370212 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m11:25:41.372643 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:25:41.372847 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m11:25:41.376234 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:25:41.377458 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m11:25:41.378183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b28bf390-7539-4f7a-b445-ca4b159cea54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10733aba0>]}
[0m11:25:41.378511 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m11:25:41.378821 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m11:25:41.379036 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m11:25:41.379308 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.stg_orders ..................................... [RUN]
[0m11:25:41.379536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m11:25:41.379716 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m11:25:41.381241 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m11:25:41.381722 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m11:25:41.383124 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m11:25:41.383621 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:25:41.383790 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m11:25:41.383948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:41.392135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:25:41.392395 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:25:41.392571 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m11:25:41.393674 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:25:41.395224 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:25:41.395428 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m11:25:41.395907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:41.397455 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:25:41.397655 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:25:41.398352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:25:41.399123 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:25:41.399316 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:25:41.399477 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:25:41.400749 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:25:41.401709 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m11:25:41.401968 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:25:41.402139 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m11:25:41.403024 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:25:41.403737 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m11:25:41.404018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b28bf390-7539-4f7a-b445-ca4b159cea54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b83ecb0>]}
[0m11:25:41.404325 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.02s]
[0m11:25:41.404612 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m11:25:41.404815 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m11:25:41.405068 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.stg_payments ................................... [RUN]
[0m11:25:41.405271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m11:25:41.405443 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m11:25:41.407680 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m11:25:41.408091 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m11:25:41.409359 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m11:25:41.409832 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:25:41.409992 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m11:25:41.410152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:41.419119 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:25:41.419354 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:25:41.419524 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    
    (amount / 100)::numeric(16, 2)
 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m11:25:41.420970 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:25:41.422513 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:25:41.422706 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m11:25:41.423193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:41.424690 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:25:41.424872 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m11:25:41.426086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:25:41.426716 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:25:41.426886 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:25:41.427039 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:25:41.428505 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:25:41.429436 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m11:25:41.429684 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:25:41.429852 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m11:25:41.431353 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:25:41.432109 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m11:25:41.432478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b28bf390-7539-4f7a-b445-ca4b159cea54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075beb50>]}
[0m11:25:41.432827 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.03s]
[0m11:25:41.433134 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m11:25:41.433539 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m11:25:41.433808 [info ] [Thread-1 (]: 4 of 6 START sql table model dev.fct_orders .................................... [RUN]
[0m11:25:41.434032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m11:25:41.434208 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m11:25:41.435734 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m11:25:41.436193 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m11:25:41.447248 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m11:25:41.447938 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:25:41.448109 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m11:25:41.448254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:41.457191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:25:41.457476 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:25:41.457676 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    

  create  table "dbt"."dev"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
  
[0m11:25:41.460590 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.003 seconds
[0m11:25:41.462167 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:25:41.462368 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders" rename to "fct_orders__dbt_backup"
[0m11:25:41.462972 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:41.466652 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:25:41.466933 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m11:25:41.467689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:25:41.470354 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m11:25:41.470560 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:25:41.470737 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m11:25:41.473044 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:25:41.474128 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m11:25:41.475895 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:25:41.476090 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m11:25:41.480695 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:25:41.481535 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m11:25:41.481840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b28bf390-7539-4f7a-b445-ca4b159cea54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b84e970>]}
[0m11:25:41.482182 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dev.fct_orders ............................... [[32mSELECT 99[0m in 0.05s]
[0m11:25:41.482496 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m11:25:41.482719 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m11:25:41.482990 [info ] [Thread-1 (]: 5 of 6 START sql table model dev.order_payment_method_amounts .................. [RUN]
[0m11:25:41.483311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m11:25:41.483525 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m11:25:41.485331 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:25:41.485765 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m11:25:41.487511 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:25:41.488017 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:25:41.488192 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m11:25:41.488396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:41.495533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m11:25:41.495817 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:25:41.496017 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  
    

  create  table "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
  
  
    as
  
  (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
  
[0m11:25:41.498442 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.002 seconds
[0m11:25:41.500059 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:25:41.500268 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts" rename to "order_payment_method_amounts__dbt_backup"
[0m11:25:41.500860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:41.502189 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:25:41.502389 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m11:25:41.503656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:25:41.504692 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m11:25:41.504881 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:25:41.505046 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m11:25:41.506492 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:25:41.507442 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m11:25:41.507705 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:25:41.507882 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop table if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m11:25:41.511418 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:25:41.512174 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m11:25:41.512470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b28bf390-7539-4f7a-b445-ca4b159cea54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c75f0>]}
[0m11:25:41.512811 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dev.order_payment_method_amounts ............. [[32mSELECT 99[0m in 0.03s]
[0m11:25:41.513130 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m11:25:41.513354 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m11:25:41.513631 [info ] [Thread-1 (]: 6 of 6 START sql table model dev.dim_customers ................................. [RUN]
[0m11:25:41.513942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.dim_customers)
[0m11:25:41.514153 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m11:25:41.515726 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m11:25:41.516178 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m11:25:41.517895 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m11:25:41.518444 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:25:41.518617 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m11:25:41.518773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:41.528088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:25:41.528361 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:25:41.528570 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."dev"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m11:25:41.532673 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.004 seconds
[0m11:25:41.534227 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:25:41.534424 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers" rename to "dim_customers__dbt_backup"
[0m11:25:41.534917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:41.536166 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:25:41.536347 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m11:25:41.536743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:25:41.537414 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m11:25:41.537583 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:25:41.537736 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m11:25:41.538308 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m11:25:41.539553 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m11:25:41.539803 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:25:41.539972 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m11:25:41.543323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:25:41.544070 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m11:25:41.544357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b28bf390-7539-4f7a-b445-ca4b159cea54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c29eb0>]}
[0m11:25:41.544684 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dev.dim_customers ............................ [[32mSELECT 100[0m in 0.03s]
[0m11:25:41.544996 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m11:25:41.545697 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:41.545883 [debug] [MainThread]: On master: BEGIN
[0m11:25:41.546031 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:25:41.552806 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:25:41.553155 [debug] [MainThread]: On master: COMMIT
[0m11:25:41.553391 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:41.553572 [debug] [MainThread]: On master: COMMIT
[0m11:25:41.554022 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:25:41.554179 [debug] [MainThread]: On master: Close
[0m11:25:41.554403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:41.554544 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m11:25:41.554748 [info ] [MainThread]: 
[0m11:25:41.554931 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m11:25:41.555669 [debug] [MainThread]: Command end result
[0m11:25:41.570491 [info ] [MainThread]: 
[0m11:25:41.570765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:25:41.570921 [info ] [MainThread]: 
[0m11:25:41.571078 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:25:41.572212 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6690005, "process_user_time": 1.03232, "process_kernel_time": 0.158074, "process_mem_max_rss": "114278400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:25:41.572521 [debug] [MainThread]: Command `dbt run` succeeded at 11:25:41.572472 after 0.67 seconds
[0m11:25:41.572719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b89ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b89b9b0>]}
[0m11:25:41.572892 [debug] [MainThread]: Flushing usage events
[0m11:25:43.993121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067fbed0>]}


============================== 11:25:43.995223 | 52f58cd6-bdc7-42f8-abff-a376b7b8b9d1 ==============================
[0m11:25:43.995223 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:25:43.995540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:25:43.995740 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:25:43.995900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '52f58cd6-bdc7-42f8-abff-a376b7b8b9d1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106830e90>]}
[0m11:25:44.068706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52f58cd6-bdc7-42f8-abff-a376b7b8b9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ef8a0>]}
[0m11:25:44.091809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52f58cd6-bdc7-42f8-abff-a376b7b8b9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ab550>]}
[0m11:25:44.092273 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:25:44.100310 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:25:44.162138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:25:44.162544 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:25:44.165616 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:25:44.186822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52f58cd6-bdc7-42f8-abff-a376b7b8b9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed1130>]}
[0m11:25:44.240692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52f58cd6-bdc7-42f8-abff-a376b7b8b9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068eaf90>]}
[0m11:25:44.240977 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:25:44.241144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52f58cd6-bdc7-42f8-abff-a376b7b8b9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687ea90>]}
[0m11:25:44.242098 [info ] [MainThread]: 
[0m11:25:44.242399 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:25:44.244313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m11:25:44.280156 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:25:44.280399 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:25:44.280853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:44.298561 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m11:25:44.298828 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:25:44.299056 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:25:44.301159 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m11:25:44.301944 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:25:44.302321 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:25:44.304968 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:44.305143 [debug] [MainThread]: On master: BEGIN
[0m11:25:44.305370 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:25:44.311419 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m11:25:44.311623 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:44.311815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:25:44.314154 [debug] [MainThread]: SQL status: SELECT 3 in 0.002 seconds
[0m11:25:44.314886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52f58cd6-bdc7-42f8-abff-a376b7b8b9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb7650>]}
[0m11:25:44.315122 [debug] [MainThread]: On master: ROLLBACK
[0m11:25:44.315509 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:44.315673 [debug] [MainThread]: On master: BEGIN
[0m11:25:44.316262 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:25:44.316403 [debug] [MainThread]: On master: COMMIT
[0m11:25:44.316524 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:44.316641 [debug] [MainThread]: On master: COMMIT
[0m11:25:44.316950 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:25:44.317080 [debug] [MainThread]: On master: Close
[0m11:25:44.317301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:25:44.317449 [info ] [MainThread]: 
[0m11:25:44.318532 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.customers
[0m11:25:44.318747 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.customers ................................ [RUN]
[0m11:25:44.318962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now source.jaffle_shop.jaffle_shop.customers)
[0m11:25:44.319117 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.customers
[0m11:25:44.319266 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.customers
[0m11:25:44.319501 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:25:44.319647 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: BEGIN
[0m11:25:44.319780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:44.326721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m11:25:44.326995 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:25:44.327153 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:25:44.327304 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:25:44.327672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m11:25:44.327905 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: Close
[0m11:25:44.329783 [debug] [Thread-1 (]: Runtime Error in source customers (models/sources.yml)
  Could not compute freshness for source customers: no 'loaded_at_field' provided and postgres adapter does not support metadata-based freshness checks.
[0m11:25:44.330058 [error] [Thread-1 (]: 1 of 1 ERROR freshness of jaffle_shop.customers ................................ [[31mERROR[0m in 0.01s]
[0m11:25:44.330353 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.customers
[0m11:25:44.331050 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:44.331249 [debug] [MainThread]: On master: BEGIN
[0m11:25:44.331389 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:25:44.338720 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:25:44.338988 [debug] [MainThread]: On master: COMMIT
[0m11:25:44.339132 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:44.339262 [debug] [MainThread]: On master: COMMIT
[0m11:25:44.339715 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:25:44.339909 [debug] [MainThread]: On master: Close
[0m11:25:44.340154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:44.340294 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.customers' was properly closed.
[0m11:25:44.340452 [info ] [MainThread]: 
[0m11:25:44.340625 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m11:25:44.355059 [info ] [MainThread]: 
[0m11:25:44.355422 [error] [MainThread]:   Runtime Error in source customers (models/sources.yml)
  Could not compute freshness for source customers: no 'loaded_at_field' provided and postgres adapter does not support metadata-based freshness checks.
[0m11:25:44.355607 [info ] [MainThread]: Done.
[0m11:25:44.356532 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 0.3962715, "process_user_time": 0.852321, "process_kernel_time": 0.131028, "process_mem_max_rss": "117489664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:25:44.356866 [debug] [MainThread]: Command `dbt source freshness` failed at 11:25:44.356816 after 0.40 seconds
[0m11:25:44.357080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107762a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107762b70>]}
[0m11:25:44.357261 [debug] [MainThread]: Flushing usage events
[0m11:25:56.850619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f51fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c3d90>]}


============================== 11:25:56.853671 | f1e60e20-47bc-4028-bb5e-9fd3cdb03a31 ==============================
[0m11:25:56.853671 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:25:56.853987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:25:56.854192 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:25:56.854352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f1e60e20-47bc-4028-bb5e-9fd3cdb03a31', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f0d60>]}
[0m11:25:56.900736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1e60e20-47bc-4028-bb5e-9fd3cdb03a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf3bd0>]}
[0m11:25:56.923151 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10202471, "process_user_time": 0.617693, "process_kernel_time": 0.111025, "process_mem_max_rss": "99041280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:25:56.923486 [debug] [MainThread]: Command `dbt clean` succeeded at 11:25:56.923423 after 0.10 seconds
[0m11:25:56.923671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd7c50>]}
[0m11:25:56.923850 [debug] [MainThread]: Flushing usage events
[0m11:26:02.889254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105119fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a77ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a77d90>]}


============================== 11:26:02.892636 | 3d7a9e37-9df5-4858-a952-bc33a30930ec ==============================
[0m11:26:02.892636 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:26:02.893012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m11:26:02.893256 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:26:02.893429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d7a9e37-9df5-4858-a952-bc33a30930ec', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aacd60>]}
[0m11:26:02.975659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d7a9e37-9df5-4858-a952-bc33a30930ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067678a0>]}
[0m11:26:02.999131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d7a9e37-9df5-4858-a952-bc33a30930ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106823550>]}
[0m11:26:02.999776 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:26:03.009488 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:26:03.010203 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:26:03.010428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d7a9e37-9df5-4858-a952-bc33a30930ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aca8a0>]}
[0m11:26:03.471493 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:26:03.471779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d7a9e37-9df5-4858-a952-bc33a30930ec', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d7070>]}
[0m11:26:03.591352 [warn ] [MainThread]: The configured adapter does not support metadata-based freshness. A loaded_at_field must be specified for source 'jaffle_shop.customers'.
[0m11:26:03.623385 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:26:03.628346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d7a9e37-9df5-4858-a952-bc33a30930ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714b6c0>]}
[0m11:26:03.684619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d7a9e37-9df5-4858-a952-bc33a30930ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761a810>]}
[0m11:26:03.684896 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:26:03.685069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d7a9e37-9df5-4858-a952-bc33a30930ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10775c940>]}
[0m11:26:03.686084 [info ] [MainThread]: 
[0m11:26:03.686346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:26:03.688211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m11:26:03.721682 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:26:03.721915 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:26:03.722048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:03.750044 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m11:26:03.750328 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:26:03.750504 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:26:03.754949 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m11:26:03.755843 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:26:03.756298 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:26:03.759437 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:03.759647 [debug] [MainThread]: On master: BEGIN
[0m11:26:03.759797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:03.767710 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:26:03.767956 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:03.768190 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:26:03.771620 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m11:26:03.772401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d7a9e37-9df5-4858-a952-bc33a30930ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107177890>]}
[0m11:26:03.772647 [debug] [MainThread]: On master: ROLLBACK
[0m11:26:03.773104 [debug] [MainThread]: On master: Close
[0m11:26:03.773396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:26:03.773580 [info ] [MainThread]: 
[0m11:26:03.775020 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m11:26:03.775271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m11:26:03.775461 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m11:26:03.781537 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m11:26:03.782358 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m11:26:03.782744 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m11:26:03.782958 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m11:26:03.783311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m11:26:03.783527 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m11:26:03.785007 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m11:26:03.785478 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m11:26:03.785830 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m11:26:03.786023 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m11:26:03.786222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m11:26:03.786422 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m11:26:03.787740 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m11:26:03.788109 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m11:26:03.788419 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m11:26:03.788651 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m11:26:03.788888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m11:26:03.789095 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m11:26:03.791330 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m11:26:03.791778 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m11:26:03.792089 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m11:26:03.792273 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:26:03.792454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m11:26:03.792612 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:26:03.796430 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:26:03.796787 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:26:03.797128 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m11:26:03.797340 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:26:03.797556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m11:26:03.797759 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:26:03.800067 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m11:26:03.800480 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:26:03.800795 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m11:26:03.800978 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:26:03.801165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m11:26:03.801332 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:26:03.804382 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m11:26:03.804729 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:26:03.805024 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m11:26:03.805212 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m11:26:03.805401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now model.jaffle_shop.fct_orders)
[0m11:26:03.805581 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m11:26:03.806723 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m11:26:03.807601 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m11:26:03.807873 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m11:26:03.808041 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m11:26:03.808225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m11:26:03.808398 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m11:26:03.810188 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:26:03.810519 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m11:26:03.810805 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m11:26:03.810980 [debug] [Thread-1 (]: Began running node test.jaffle_shop.positive_total_payments
[0m11:26:03.811142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now test.jaffle_shop.positive_total_payments)
[0m11:26:03.811580 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.positive_total_payments
[0m11:26:03.812589 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.positive_total_payments"
[0m11:26:03.812965 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.positive_total_payments
[0m11:26:03.813234 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.positive_total_payments
[0m11:26:03.813395 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m11:26:03.813558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.positive_total_payments, now model.jaffle_shop.dim_customers)
[0m11:26:03.813708 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m11:26:03.814840 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m11:26:03.815133 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m11:26:03.815400 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m11:26:03.815833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:03.815968 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m11:26:03.816744 [debug] [MainThread]: Command end result
[0m11:26:03.833531 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.9746701, "process_user_time": 1.402065, "process_kernel_time": 0.15918, "process_mem_max_rss": "119554048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:26:03.833863 [debug] [MainThread]: Command `dbt compile` succeeded at 11:26:03.833816 after 0.98 seconds
[0m11:26:03.834058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c94250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fbad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa9240>]}
[0m11:26:03.834234 [debug] [MainThread]: Flushing usage events
[0m11:26:07.562463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f99fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f3d90>]}


============================== 11:26:07.566206 | 4732419e-beb3-4e6e-8fa8-b80c92aa17f7 ==============================
[0m11:26:07.566206 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:26:07.566543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:26:07.566746 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:26:07.566910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4732419e-beb3-4e6e-8fa8-b80c92aa17f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692cd60>]}
[0m11:26:07.651984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4732419e-beb3-4e6e-8fa8-b80c92aa17f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e78a0>]}
[0m11:26:07.676078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4732419e-beb3-4e6e-8fa8-b80c92aa17f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a3550>]}
[0m11:26:07.676759 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:26:07.688913 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:26:07.762970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:26:07.763232 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:26:07.765817 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:26:07.787083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4732419e-beb3-4e6e-8fa8-b80c92aa17f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd5040>]}
[0m11:26:07.845024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4732419e-beb3-4e6e-8fa8-b80c92aa17f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e2dd0>]}
[0m11:26:07.845315 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:26:07.845490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4732419e-beb3-4e6e-8fa8-b80c92aa17f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107593860>]}
[0m11:26:07.846470 [info ] [MainThread]: 
[0m11:26:07.846754 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:26:07.848625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:26:07.892091 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:26:07.892325 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:26:07.892463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:07.913031 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.021 seconds
[0m11:26:07.913817 [debug] [ThreadPool]: On list_dbt: Close
[0m11:26:07.914598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m11:26:07.917444 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:26:07.917672 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:26:07.917818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:07.927834 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:26:07.928290 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:26:07.928769 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:26:07.932180 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m11:26:07.933097 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:26:07.934672 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:26:07.938475 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:07.951984 [debug] [MainThread]: On master: BEGIN
[0m11:26:07.952276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:07.966666 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m11:26:07.966917 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:07.967123 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:26:07.969927 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m11:26:07.970726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4732419e-beb3-4e6e-8fa8-b80c92aa17f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb3890>]}
[0m11:26:07.970974 [debug] [MainThread]: On master: ROLLBACK
[0m11:26:07.971423 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:07.971599 [debug] [MainThread]: On master: BEGIN
[0m11:26:07.972222 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:26:07.972370 [debug] [MainThread]: On master: COMMIT
[0m11:26:07.972500 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:07.972625 [debug] [MainThread]: On master: COMMIT
[0m11:26:07.972987 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:26:07.973174 [debug] [MainThread]: On master: Close
[0m11:26:07.973432 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:26:07.973604 [info ] [MainThread]: 
[0m11:26:07.974767 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m11:26:07.975045 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.stg_customers .................................. [RUN]
[0m11:26:07.975291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m11:26:07.975934 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m11:26:07.979913 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m11:26:07.980372 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m11:26:07.998030 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m11:26:07.998897 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:26:07.999066 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m11:26:07.999217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:08.008524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:26:08.008771 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:26:08.009112 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m11:26:08.011271 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:26:08.014510 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:26:08.014721 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:26:08.016184 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:26:08.017696 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:26:08.017867 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:26:08.019111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:26:08.027165 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:26:08.028082 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:26:08.028400 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:26:08.030173 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:26:08.033386 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m11:26:08.035840 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:26:08.036051 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m11:26:08.039180 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:26:08.040434 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m11:26:08.041179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4732419e-beb3-4e6e-8fa8-b80c92aa17f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107582ba0>]}
[0m11:26:08.041502 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m11:26:08.041810 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m11:26:08.042027 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m11:26:08.042311 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.stg_orders ..................................... [RUN]
[0m11:26:08.042544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m11:26:08.042721 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m11:26:08.044280 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m11:26:08.044723 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m11:26:08.046098 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m11:26:08.046654 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:26:08.046823 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m11:26:08.047134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:08.057495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m11:26:08.057766 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:26:08.057946 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m11:26:08.059254 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:26:08.060763 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:26:08.060959 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m11:26:08.061438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:26:08.062932 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:26:08.063121 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:26:08.063668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:26:08.064520 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:26:08.064752 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:26:08.064967 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:26:08.066149 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:26:08.067208 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m11:26:08.067472 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:26:08.067640 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m11:26:08.068590 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:26:08.069295 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m11:26:08.069572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4732419e-beb3-4e6e-8fa8-b80c92aa17f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079cacb0>]}
[0m11:26:08.069887 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.03s]
[0m11:26:08.070183 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m11:26:08.070388 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m11:26:08.070635 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.stg_payments ................................... [RUN]
[0m11:26:08.070846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m11:26:08.071014 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m11:26:08.073249 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m11:26:08.073709 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m11:26:08.075097 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m11:26:08.075487 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:26:08.075656 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m11:26:08.075814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:08.083387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m11:26:08.083710 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:26:08.083889 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    
    (amount / 100)::numeric(16, 2)
 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m11:26:08.085504 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:26:08.087043 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:26:08.087246 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m11:26:08.087820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:26:08.089413 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:26:08.089607 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m11:26:08.090095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:26:08.090758 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:26:08.090935 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:26:08.091093 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:26:08.092000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:26:08.093055 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m11:26:08.093340 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:26:08.093517 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m11:26:08.094405 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:26:08.095071 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m11:26:08.095335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4732419e-beb3-4e6e-8fa8-b80c92aa17f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107806b50>]}
[0m11:26:08.095643 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.02s]
[0m11:26:08.095935 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m11:26:08.096303 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m11:26:08.096567 [info ] [Thread-1 (]: 4 of 6 START sql table model dev.fct_orders .................................... [RUN]
[0m11:26:08.096822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m11:26:08.097005 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m11:26:08.098614 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m11:26:08.099075 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m11:26:08.109970 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m11:26:08.110572 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:26:08.110743 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m11:26:08.110894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:08.120222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:26:08.120484 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:26:08.120677 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    

  create  table "dbt"."dev"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
  
[0m11:26:08.126847 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.006 seconds
[0m11:26:08.128480 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:26:08.128680 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders" rename to "fct_orders__dbt_backup"
[0m11:26:08.129241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:26:08.133012 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:26:08.133261 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m11:26:08.134099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:26:08.136765 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m11:26:08.136970 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:26:08.137136 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m11:26:08.138147 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:26:08.139206 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m11:26:08.140637 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:26:08.140827 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m11:26:08.143294 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m11:26:08.144052 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m11:26:08.144351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4732419e-beb3-4e6e-8fa8-b80c92aa17f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d1550>]}
[0m11:26:08.144677 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dev.fct_orders ............................... [[32mSELECT 99[0m in 0.05s]
[0m11:26:08.144987 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m11:26:08.145210 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m11:26:08.145489 [info ] [Thread-1 (]: 5 of 6 START sql table model dev.order_payment_method_amounts .................. [RUN]
[0m11:26:08.145817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m11:26:08.146048 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m11:26:08.147851 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:26:08.148385 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m11:26:08.150379 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:26:08.150839 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:26:08.151036 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m11:26:08.151443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:08.160009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:26:08.160316 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:26:08.160519 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  
    

  create  table "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
  
  
    as
  
  (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
  
[0m11:26:08.163712 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.003 seconds
[0m11:26:08.165504 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:26:08.165727 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts" rename to "order_payment_method_amounts__dbt_backup"
[0m11:26:08.166481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:26:08.167856 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:26:08.168055 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m11:26:08.168570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:26:08.169699 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m11:26:08.169904 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:26:08.170077 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m11:26:08.170910 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:26:08.172098 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m11:26:08.172422 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:26:08.172615 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop table if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m11:26:08.174922 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m11:26:08.175926 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m11:26:08.176287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4732419e-beb3-4e6e-8fa8-b80c92aa17f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107948590>]}
[0m11:26:08.176622 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dev.order_payment_method_amounts ............. [[32mSELECT 99[0m in 0.03s]
[0m11:26:08.176967 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m11:26:08.177200 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m11:26:08.177464 [info ] [Thread-1 (]: 6 of 6 START sql table model dev.dim_customers ................................. [RUN]
[0m11:26:08.177712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.dim_customers)
[0m11:26:08.177899 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m11:26:08.179586 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m11:26:08.180030 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m11:26:08.181942 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m11:26:08.182490 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:26:08.182882 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m11:26:08.183063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:08.190630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:26:08.190899 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:26:08.191097 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."dev"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m11:26:08.193933 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.003 seconds
[0m11:26:08.195452 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:26:08.195645 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers" rename to "dim_customers__dbt_backup"
[0m11:26:08.196173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:26:08.197743 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:26:08.197963 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m11:26:08.198567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:26:08.199287 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m11:26:08.199824 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:26:08.199985 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m11:26:08.200672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:26:08.202068 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m11:26:08.202349 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:26:08.202531 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m11:26:08.204113 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:26:08.204954 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m11:26:08.205254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4732419e-beb3-4e6e-8fa8-b80c92aa17f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782f7d0>]}
[0m11:26:08.205575 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dev.dim_customers ............................ [[32mSELECT 100[0m in 0.03s]
[0m11:26:08.205880 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m11:26:08.206780 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:08.207129 [debug] [MainThread]: On master: BEGIN
[0m11:26:08.207269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:26:08.214648 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:26:08.214899 [debug] [MainThread]: On master: COMMIT
[0m11:26:08.215045 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:08.215179 [debug] [MainThread]: On master: COMMIT
[0m11:26:08.215593 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:26:08.215834 [debug] [MainThread]: On master: Close
[0m11:26:08.216149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:08.216280 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m11:26:08.216509 [info ] [MainThread]: 
[0m11:26:08.216714 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m11:26:08.217375 [debug] [MainThread]: Command end result
[0m11:26:08.232333 [info ] [MainThread]: 
[0m11:26:08.232636 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:26:08.232798 [info ] [MainThread]: 
[0m11:26:08.232972 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:26:08.233938 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.70624584, "process_user_time": 1.046533, "process_kernel_time": 0.168614, "process_mem_max_rss": "110837760", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:26:08.234241 [debug] [MainThread]: Command `dbt run` succeeded at 11:26:08.234193 after 0.71 seconds
[0m11:26:08.234431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047083b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079dba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079db9b0>]}
[0m11:26:08.234607 [debug] [MainThread]: Flushing usage events
[0m11:28:35.704760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106087ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106087d90>]}


============================== 11:28:35.721398 | 350df57f-c529-4517-83b6-f5432d4ec26b ==============================
[0m11:28:35.721398 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:28:35.721719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:28:35.721928 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:28:35.722086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '350df57f-c529-4517-83b6-f5432d4ec26b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c0d60>]}
[0m11:28:35.797738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '350df57f-c529-4517-83b6-f5432d4ec26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7f8a0>]}
[0m11:28:35.820894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '350df57f-c529-4517-83b6-f5432d4ec26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3b550>]}
[0m11:28:35.821645 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:28:35.830384 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:28:35.890603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:28:35.890861 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:28:35.893654 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:28:35.916577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '350df57f-c529-4517-83b6-f5432d4ec26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106769040>]}
[0m11:28:35.973220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '350df57f-c529-4517-83b6-f5432d4ec26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106176dd0>]}
[0m11:28:35.973520 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:28:35.973699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '350df57f-c529-4517-83b6-f5432d4ec26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d27860>]}
[0m11:28:35.974702 [info ] [MainThread]: 
[0m11:28:35.975001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:28:35.976854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:28:36.008158 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:28:36.008388 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:28:36.008530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:36.027191 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.019 seconds
[0m11:28:36.027958 [debug] [ThreadPool]: On list_dbt: Close
[0m11:28:36.029000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m11:28:36.031714 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:28:36.031884 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:28:36.032015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:28:36.039890 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m11:28:36.040093 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:28:36.040243 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:28:36.043642 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m11:28:36.044627 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:28:36.045207 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:28:36.049160 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:36.049428 [debug] [MainThread]: On master: BEGIN
[0m11:28:36.049568 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:28:36.056085 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m11:28:36.056312 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:36.056529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:28:36.059677 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m11:28:36.060519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '350df57f-c529-4517-83b6-f5432d4ec26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106787890>]}
[0m11:28:36.060778 [debug] [MainThread]: On master: ROLLBACK
[0m11:28:36.061237 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:36.061455 [debug] [MainThread]: On master: BEGIN
[0m11:28:36.062090 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:28:36.062271 [debug] [MainThread]: On master: COMMIT
[0m11:28:36.062417 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:36.062551 [debug] [MainThread]: On master: COMMIT
[0m11:28:36.062948 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:28:36.063113 [debug] [MainThread]: On master: Close
[0m11:28:36.063356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:28:36.063533 [info ] [MainThread]: 
[0m11:28:36.065048 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m11:28:36.065435 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.stg_customers .................................. [RUN]
[0m11:28:36.065699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m11:28:36.066371 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m11:28:36.071139 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m11:28:36.072025 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m11:28:36.089988 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m11:28:36.092275 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:28:36.092461 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m11:28:36.092614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:36.104875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m11:28:36.105064 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:28:36.105354 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name,
   loaded_at_field
from
   "dbt"."dev_data"."customers"
  );
[0m11:28:36.108360 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:28:36.111914 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:28:36.112163 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:28:36.112865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:28:36.114640 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:28:36.114861 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:28:36.116383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:28:36.125298 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:28:36.125530 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:28:36.125707 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:28:36.127122 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:28:36.130240 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m11:28:36.132640 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:28:36.132843 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m11:28:36.135508 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:28:36.136725 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m11:28:36.137452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '350df57f-c529-4517-83b6-f5432d4ec26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d16c50>]}
[0m11:28:36.137773 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m11:28:36.138079 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m11:28:36.138292 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m11:28:36.138571 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.stg_orders ..................................... [RUN]
[0m11:28:36.138817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m11:28:36.139004 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m11:28:36.140517 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m11:28:36.141121 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m11:28:36.142506 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m11:28:36.143093 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:28:36.143271 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m11:28:36.143426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:36.151269 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:28:36.151545 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:28:36.151721 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m11:28:36.152781 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:28:36.154243 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:28:36.154426 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m11:28:36.154893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:28:36.156298 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:28:36.156469 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:28:36.157804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:28:36.158441 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:28:36.158612 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:28:36.158766 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:28:36.160333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:28:36.161260 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m11:28:36.161500 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:28:36.161662 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m11:28:36.163653 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:28:36.164358 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m11:28:36.164635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '350df57f-c529-4517-83b6-f5432d4ec26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715ecb0>]}
[0m11:28:36.164944 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.03s]
[0m11:28:36.165235 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m11:28:36.165443 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m11:28:36.165653 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.stg_payments ................................... [RUN]
[0m11:28:36.165968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m11:28:36.166140 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m11:28:36.168366 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m11:28:36.168991 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m11:28:36.170354 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m11:28:36.170719 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:28:36.170892 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m11:28:36.171238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:36.179378 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:28:36.179654 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:28:36.179840 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    
    (amount / 100)::numeric(16, 2)
 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m11:28:36.182036 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:28:36.183529 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:28:36.183713 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m11:28:36.184223 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:28:36.185704 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:28:36.185897 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m11:28:36.186364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:28:36.187019 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:28:36.187199 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:28:36.187359 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:28:36.188188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:28:36.189159 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m11:28:36.189406 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:28:36.189571 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m11:28:36.190707 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:28:36.191410 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m11:28:36.191694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '350df57f-c529-4517-83b6-f5432d4ec26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f9ab50>]}
[0m11:28:36.192017 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.03s]
[0m11:28:36.192316 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m11:28:36.192737 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m11:28:36.193028 [info ] [Thread-1 (]: 4 of 6 START sql table model dev.fct_orders .................................... [RUN]
[0m11:28:36.193303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m11:28:36.193502 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m11:28:36.195041 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m11:28:36.195707 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m11:28:36.206825 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m11:28:36.207596 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:28:36.207774 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m11:28:36.207919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:36.217180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:28:36.217448 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:28:36.217640 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    

  create  table "dbt"."dev"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
  
[0m11:28:36.220857 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.003 seconds
[0m11:28:36.222405 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:28:36.222596 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders" rename to "fct_orders__dbt_backup"
[0m11:28:36.223168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:28:36.226592 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:28:36.226797 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m11:28:36.227447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:28:36.230609 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m11:28:36.230853 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:28:36.231016 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m11:28:36.232215 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:28:36.233339 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m11:28:36.234804 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:28:36.235000 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m11:28:36.239597 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m11:28:36.240326 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m11:28:36.240596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '350df57f-c529-4517-83b6-f5432d4ec26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107166890>]}
[0m11:28:36.240908 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dev.fct_orders ............................... [[32mSELECT 99[0m in 0.05s]
[0m11:28:36.241221 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m11:28:36.241444 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m11:28:36.241711 [info ] [Thread-1 (]: 5 of 6 START sql table model dev.order_payment_method_amounts .................. [RUN]
[0m11:28:36.241975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m11:28:36.242159 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m11:28:36.243910 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:28:36.244511 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m11:28:36.246278 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:28:36.246787 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:28:36.246973 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m11:28:36.247295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:36.254971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:28:36.255268 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:28:36.255470 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  
    

  create  table "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
  
  
    as
  
  (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
  
[0m11:28:36.259212 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.004 seconds
[0m11:28:36.260821 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:28:36.261017 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts" rename to "order_payment_method_amounts__dbt_backup"
[0m11:28:36.261611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:28:36.263192 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:28:36.263418 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m11:28:36.264123 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:28:36.265232 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m11:28:36.265421 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:28:36.265584 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m11:28:36.266565 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:28:36.267550 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m11:28:36.267821 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:28:36.267995 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop table if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m11:28:36.269216 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m11:28:36.269948 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m11:28:36.270239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '350df57f-c529-4517-83b6-f5432d4ec26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e6f30>]}
[0m11:28:36.270576 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dev.order_payment_method_amounts ............. [[32mSELECT 99[0m in 0.03s]
[0m11:28:36.270894 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m11:28:36.271114 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m11:28:36.271363 [info ] [Thread-1 (]: 6 of 6 START sql table model dev.dim_customers ................................. [RUN]
[0m11:28:36.271633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.dim_customers)
[0m11:28:36.271824 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m11:28:36.273363 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m11:28:36.273948 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m11:28:36.275659 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m11:28:36.276194 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:28:36.276361 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m11:28:36.276518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:36.284924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:28:36.285217 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:28:36.285429 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."dev"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m11:28:36.288229 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.003 seconds
[0m11:28:36.289864 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:28:36.290068 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers" rename to "dim_customers__dbt_backup"
[0m11:28:36.290616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:28:36.291872 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:28:36.292053 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m11:28:36.292473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:28:36.293150 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m11:28:36.293643 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:28:36.293801 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m11:28:36.294516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:28:36.296110 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m11:28:36.296448 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:28:36.296632 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m11:28:36.298389 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m11:28:36.299153 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m11:28:36.299453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '350df57f-c529-4517-83b6-f5432d4ec26b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106614fb0>]}
[0m11:28:36.299776 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dev.dim_customers ............................ [[32mSELECT 100[0m in 0.03s]
[0m11:28:36.300075 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m11:28:36.301146 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:36.301440 [debug] [MainThread]: On master: BEGIN
[0m11:28:36.301660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:28:36.308046 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m11:28:36.308325 [debug] [MainThread]: On master: COMMIT
[0m11:28:36.308486 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:36.308638 [debug] [MainThread]: On master: COMMIT
[0m11:28:36.308998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:28:36.309192 [debug] [MainThread]: On master: Close
[0m11:28:36.309428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:36.309575 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m11:28:36.309785 [info ] [MainThread]: 
[0m11:28:36.309965 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m11:28:36.310647 [debug] [MainThread]: Command end result
[0m11:28:36.326234 [info ] [MainThread]: 
[0m11:28:36.326490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:28:36.326640 [info ] [MainThread]: 
[0m11:28:36.326794 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:28:36.328306 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.66090775, "process_user_time": 1.007953, "process_kernel_time": 0.155175, "process_mem_max_rss": "116981760", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:28:36.328595 [debug] [MainThread]: Command `dbt run` succeeded at 11:28:36.328549 after 0.66 seconds
[0m11:28:36.328786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10609e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bbad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bba70>]}
[0m11:28:36.328961 [debug] [MainThread]: Flushing usage events
[0m11:28:39.180255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b7ed0>]}


============================== 11:28:39.182910 | bc74acd3-820f-488f-a533-efdde04c603c ==============================
[0m11:28:39.182910 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:28:39.183218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt source freshness', 'send_anonymous_usage_stats': 'True'}
[0m11:28:39.183423 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:28:39.183577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bc74acd3-820f-488f-a533-efdde04c603c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ece90>]}
[0m11:28:39.255759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc74acd3-820f-488f-a533-efdde04c603c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ab8a0>]}
[0m11:28:39.279056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc74acd3-820f-488f-a533-efdde04c603c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616b550>]}
[0m11:28:39.279602 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:28:39.287944 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:28:39.347783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:28:39.348005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:28:39.350486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:28:39.371313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc74acd3-820f-488f-a533-efdde04c603c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a91130>]}
[0m11:28:39.424919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc74acd3-820f-488f-a533-efdde04c603c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a6f90>]}
[0m11:28:39.425193 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:28:39.425361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc74acd3-820f-488f-a533-efdde04c603c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643aa90>]}
[0m11:28:39.426274 [info ] [MainThread]: 
[0m11:28:39.426562 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:28:39.428432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m11:28:39.458014 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:28:39.458242 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:28:39.458380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:39.476622 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m11:28:39.476855 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:28:39.477001 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:28:39.482512 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m11:28:39.483336 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:28:39.484147 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:28:39.486976 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:39.487165 [debug] [MainThread]: On master: BEGIN
[0m11:28:39.487301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:28:39.495869 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:28:39.496017 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:39.496216 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:28:39.500365 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m11:28:39.501168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc74acd3-820f-488f-a533-efdde04c603c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9b650>]}
[0m11:28:39.501527 [debug] [MainThread]: On master: ROLLBACK
[0m11:28:39.502088 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:39.502277 [debug] [MainThread]: On master: BEGIN
[0m11:28:39.503019 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:28:39.503226 [debug] [MainThread]: On master: COMMIT
[0m11:28:39.503370 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:39.503657 [debug] [MainThread]: On master: COMMIT
[0m11:28:39.504132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:28:39.504341 [debug] [MainThread]: On master: Close
[0m11:28:39.505175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:28:39.505393 [info ] [MainThread]: 
[0m11:28:39.506940 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.customers
[0m11:28:39.507200 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.customers ................................ [RUN]
[0m11:28:39.507463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now source.jaffle_shop.jaffle_shop.customers)
[0m11:28:39.507659 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.customers
[0m11:28:39.507838 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.customers
[0m11:28:39.508119 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:28:39.508296 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: BEGIN
[0m11:28:39.508461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:39.515898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m11:28:39.516178 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:28:39.516349 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:28:39.516516 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:28:39.516942 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m11:28:39.517209 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: Close
[0m11:28:39.519259 [debug] [Thread-1 (]: Runtime Error in source customers (models/sources.yml)
  Could not compute freshness for source customers: no 'loaded_at_field' provided and postgres adapter does not support metadata-based freshness checks.
[0m11:28:39.519560 [error] [Thread-1 (]: 1 of 1 ERROR freshness of jaffle_shop.customers ................................ [[31mERROR[0m in 0.01s]
[0m11:28:39.519886 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.customers
[0m11:28:39.520521 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:39.520679 [debug] [MainThread]: On master: BEGIN
[0m11:28:39.520811 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:28:39.528613 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:28:39.528899 [debug] [MainThread]: On master: COMMIT
[0m11:28:39.529078 [debug] [MainThread]: Using postgres connection "master"
[0m11:28:39.529228 [debug] [MainThread]: On master: COMMIT
[0m11:28:39.529753 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:28:39.529938 [debug] [MainThread]: On master: Close
[0m11:28:39.530173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:39.530315 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.customers' was properly closed.
[0m11:28:39.530471 [info ] [MainThread]: 
[0m11:28:39.530640 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m11:28:39.544418 [info ] [MainThread]: 
[0m11:28:39.544714 [error] [MainThread]:   Runtime Error in source customers (models/sources.yml)
  Could not compute freshness for source customers: no 'loaded_at_field' provided and postgres adapter does not support metadata-based freshness checks.
[0m11:28:39.544864 [info ] [MainThread]: Done.
[0m11:28:39.546092 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 0.39411762, "process_user_time": 0.846214, "process_kernel_time": 0.132982, "process_mem_max_rss": "115720192", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:28:39.546525 [debug] [MainThread]: Command `dbt source freshness` failed at 11:28:39.546471 after 0.39 seconds
[0m11:28:39.546747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703aa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107322990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107322ad0>]}
[0m11:28:39.546925 [debug] [MainThread]: Flushing usage events
[0m11:30:08.145715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106451fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120bffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120bffed0>]}


============================== 11:30:08.168347 | ced50c3b-05e3-4ae0-8e18-bbb54a91550c ==============================
[0m11:30:08.168347 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:30:08.168682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt source freshness', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:30:08.168894 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:30:08.169056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ced50c3b-05e3-4ae0-8e18-bbb54a91550c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c34e90>]}
[0m11:30:08.253210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ced50c3b-05e3-4ae0-8e18-bbb54a91550c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207ef8a0>]}
[0m11:30:08.277771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ced50c3b-05e3-4ae0-8e18-bbb54a91550c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ae7550>]}
[0m11:30:08.278452 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:30:08.288811 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:30:08.349322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:30:08.349548 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:30:08.352036 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:30:08.373203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ced50c3b-05e3-4ae0-8e18-bbb54a91550c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121329130>]}
[0m11:30:08.431697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ced50c3b-05e3-4ae0-8e18-bbb54a91550c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ceef90>]}
[0m11:30:08.431984 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:30:08.432152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ced50c3b-05e3-4ae0-8e18-bbb54a91550c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c7ea90>]}
[0m11:30:08.433086 [info ] [MainThread]: 
[0m11:30:08.433374 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:30:08.435249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m11:30:08.482010 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:30:08.482255 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:30:08.482392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:08.512395 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m11:30:08.512662 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:30:08.512837 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:30:08.517332 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m11:30:08.518217 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:30:08.518708 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:30:08.521668 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:08.521869 [debug] [MainThread]: On master: BEGIN
[0m11:30:08.522010 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:30:08.529744 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:30:08.529992 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:08.530229 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:30:08.533880 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m11:30:08.535022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ced50c3b-05e3-4ae0-8e18-bbb54a91550c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12131f650>]}
[0m11:30:08.535319 [debug] [MainThread]: On master: ROLLBACK
[0m11:30:08.535810 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:08.535973 [debug] [MainThread]: On master: BEGIN
[0m11:30:08.536601 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:30:08.536768 [debug] [MainThread]: On master: COMMIT
[0m11:30:08.536918 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:08.537061 [debug] [MainThread]: On master: COMMIT
[0m11:30:08.537413 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:30:08.537589 [debug] [MainThread]: On master: Close
[0m11:30:08.537860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:30:08.538033 [info ] [MainThread]: 
[0m11:30:08.539725 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.customers
[0m11:30:08.539959 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.customers ................................ [RUN]
[0m11:30:08.540202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now source.jaffle_shop.jaffle_shop.customers)
[0m11:30:08.540385 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.customers
[0m11:30:08.540856 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.customers
[0m11:30:08.541167 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:30:08.541351 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: BEGIN
[0m11:30:08.541519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:08.549473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:30:08.549792 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:30:08.550417 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:30:08.550602 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:30:08.551006 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m11:30:08.555421 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:30:08.555647 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "source.jaffle_shop.jaffle_shop.customers"} */
select
      max(loaded_at_field) as max_loaded_at,
      now() as snapshotted_at
    from "dbt"."dev_data"."customers"
    
  
[0m11:30:08.556884 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m11:30:08.557661 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: Close
[0m11:30:08.558570 [info ] [Thread-1 (]: 1 of 1 PASS freshness of jaffle_shop.customers ................................. [[32mPASS[0m in 0.02s]
[0m11:30:08.558899 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.customers
[0m11:30:08.559573 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:08.559865 [debug] [MainThread]: On master: BEGIN
[0m11:30:08.560005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:08.567590 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:30:08.567855 [debug] [MainThread]: On master: COMMIT
[0m11:30:08.568053 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:08.568249 [debug] [MainThread]: On master: COMMIT
[0m11:30:08.568657 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:30:08.568816 [debug] [MainThread]: On master: Close
[0m11:30:08.569046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:08.569182 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.customers' was properly closed.
[0m11:30:08.569346 [info ] [MainThread]: 
[0m11:30:08.569656 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m11:30:08.585318 [info ] [MainThread]: Done.
[0m11:30:08.586914 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.47373042, "process_user_time": 0.847972, "process_kernel_time": 0.14759, "process_mem_max_rss": "115965952", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:30:08.587249 [debug] [MainThread]: Command `dbt source freshness` succeeded at 11:30:08.587200 after 0.47 seconds
[0m11:30:08.587439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219ee830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ebefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ebe8f0>]}
[0m11:30:08.587603 [debug] [MainThread]: Flushing usage events
[0m11:30:43.814434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10832bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10832bed0>]}


============================== 11:30:43.818167 | 02213876-1f79-4221-944a-61f4c2aaaae3 ==============================
[0m11:30:43.818167 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:30:43.818507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt source freshness', 'send_anonymous_usage_stats': 'True'}
[0m11:30:43.818714 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:30:43.818872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '02213876-1f79-4221-944a-61f4c2aaaae3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835ce90>]}
[0m11:30:43.899451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02213876-1f79-4221-944a-61f4c2aaaae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801b8a0>]}
[0m11:30:43.924291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02213876-1f79-4221-944a-61f4c2aaaae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d7550>]}
[0m11:30:43.924905 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:30:43.934887 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:30:44.005988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:30:44.006235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:30:44.008863 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:30:44.030387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02213876-1f79-4221-944a-61f4c2aaaae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fd130>]}
[0m11:30:44.089693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02213876-1f79-4221-944a-61f4c2aaaae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841af90>]}
[0m11:30:44.089976 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:30:44.090143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02213876-1f79-4221-944a-61f4c2aaaae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083aaa90>]}
[0m11:30:44.091083 [info ] [MainThread]: 
[0m11:30:44.091372 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:30:44.093258 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m11:30:44.140350 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:30:44.140578 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:30:44.140715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:44.162295 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m11:30:44.162552 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:30:44.162710 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:30:44.172761 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m11:30:44.173590 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:30:44.174048 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:30:44.176934 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:44.177126 [debug] [MainThread]: On master: BEGIN
[0m11:30:44.177258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:30:44.183558 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m11:30:44.183764 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:44.183981 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:30:44.187168 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m11:30:44.187989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02213876-1f79-4221-944a-61f4c2aaaae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e3650>]}
[0m11:30:44.188252 [debug] [MainThread]: On master: ROLLBACK
[0m11:30:44.188677 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:44.188861 [debug] [MainThread]: On master: BEGIN
[0m11:30:44.189505 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:30:44.189716 [debug] [MainThread]: On master: COMMIT
[0m11:30:44.189875 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:44.190023 [debug] [MainThread]: On master: COMMIT
[0m11:30:44.190399 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:30:44.190567 [debug] [MainThread]: On master: Close
[0m11:30:44.190824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:30:44.190999 [info ] [MainThread]: 
[0m11:30:44.192465 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.customers
[0m11:30:44.192715 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.customers ................................ [RUN]
[0m11:30:44.192961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now source.jaffle_shop.jaffle_shop.customers)
[0m11:30:44.193147 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.customers
[0m11:30:44.193325 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.customers
[0m11:30:44.193596 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:30:44.193768 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: BEGIN
[0m11:30:44.193937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:44.201468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m11:30:44.201709 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:30:44.201883 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:30:44.202068 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:30:44.202539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m11:30:44.207034 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:30:44.207267 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "source.jaffle_shop.jaffle_shop.customers"} */
select
      max(loaded_at_field) as max_loaded_at,
      now() as snapshotted_at
    from "dbt"."dev_data"."customers"
    
  
[0m11:30:44.208489 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m11:30:44.209241 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: Close
[0m11:30:44.210147 [info ] [Thread-1 (]: 1 of 1 PASS freshness of jaffle_shop.customers ................................. [[32mPASS[0m in 0.02s]
[0m11:30:44.210524 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.customers
[0m11:30:44.212519 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:44.212716 [debug] [MainThread]: On master: BEGIN
[0m11:30:44.212850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:44.224603 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:30:44.224884 [debug] [MainThread]: On master: COMMIT
[0m11:30:44.225052 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:44.225206 [debug] [MainThread]: On master: COMMIT
[0m11:30:44.225586 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:30:44.225762 [debug] [MainThread]: On master: Close
[0m11:30:44.225998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:44.226146 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.customers' was properly closed.
[0m11:30:44.226313 [info ] [MainThread]: 
[0m11:30:44.226490 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m11:30:44.244046 [info ] [MainThread]: Done.
[0m11:30:44.245768 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.46427408, "process_user_time": 0.877359, "process_kernel_time": 0.158689, "process_mem_max_rss": "114524160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:30:44.246234 [debug] [MainThread]: Command `dbt source freshness` succeeded at 11:30:44.246111 after 0.46 seconds
[0m11:30:44.246709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108faa830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10937efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10937e8f0>]}
[0m11:30:44.246923 [debug] [MainThread]: Flushing usage events
[0m11:30:54.035538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107851fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ffed0>]}


============================== 11:30:54.038892 | 4234875d-c417-41f3-ab87-612b8b0828e0 ==============================
[0m11:30:54.038892 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:30:54.039228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:30:54.039445 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:30:54.039608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4234875d-c417-41f3-ab87-612b8b0828e0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a130e90>]}
[0m11:30:54.115253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4234875d-c417-41f3-ab87-612b8b0828e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109def8a0>]}
[0m11:30:54.138010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4234875d-c417-41f3-ab87-612b8b0828e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109feb550>]}
[0m11:30:54.139010 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:30:54.154178 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:30:54.214912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:30:54.215182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:30:54.217905 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:30:54.239660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4234875d-c417-41f3-ab87-612b8b0828e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb5130>]}
[0m11:30:54.297732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4234875d-c417-41f3-ab87-612b8b0828e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1eaf90>]}
[0m11:30:54.298008 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:30:54.298175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4234875d-c417-41f3-ab87-612b8b0828e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a17ea90>]}
[0m11:30:54.299133 [info ] [MainThread]: 
[0m11:30:54.299429 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:30:54.301291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m11:30:54.361280 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:30:54.361511 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:30:54.361688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:54.381361 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m11:30:54.381600 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:30:54.381764 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:30:54.385795 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m11:30:54.386585 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:30:54.387008 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:30:54.389678 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:54.389853 [debug] [MainThread]: On master: BEGIN
[0m11:30:54.389979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:30:54.398028 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:30:54.398303 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:54.398523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:30:54.401857 [debug] [MainThread]: SQL status: SELECT 3 in 0.003 seconds
[0m11:30:54.402694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4234875d-c417-41f3-ab87-612b8b0828e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad97650>]}
[0m11:30:54.402961 [debug] [MainThread]: On master: ROLLBACK
[0m11:30:54.403369 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:54.403518 [debug] [MainThread]: On master: BEGIN
[0m11:30:54.404155 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:30:54.404365 [debug] [MainThread]: On master: COMMIT
[0m11:30:54.404532 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:54.404680 [debug] [MainThread]: On master: COMMIT
[0m11:30:54.405084 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:30:54.405239 [debug] [MainThread]: On master: Close
[0m11:30:54.405492 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:30:54.405664 [info ] [MainThread]: 
[0m11:30:54.407134 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.customers
[0m11:30:54.407362 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.customers ................................ [RUN]
[0m11:30:54.407588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now source.jaffle_shop.jaffle_shop.customers)
[0m11:30:54.407758 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.customers
[0m11:30:54.407922 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.customers
[0m11:30:54.408176 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:30:54.408336 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: BEGIN
[0m11:30:54.408483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:54.416153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:30:54.416439 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:30:54.416618 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:30:54.416786 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:30:54.417164 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m11:30:54.421564 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:30:54.421811 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "source.jaffle_shop.jaffle_shop.customers"} */
select
      max(loaded_at_field) as max_loaded_at,
      now() as snapshotted_at
    from "dbt"."dev_data"."customers"
    
  
[0m11:30:54.422956 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m11:30:54.423719 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: Close
[0m11:30:54.424626 [warn ] [Thread-1 (]: 1 of 1 WARN freshness of jaffle_shop.customers ................................. [[33mWARN[0m in 0.02s]
[0m11:30:54.424960 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.customers
[0m11:30:54.425623 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:54.425799 [debug] [MainThread]: On master: BEGIN
[0m11:30:54.425939 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:54.433789 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:30:54.434018 [debug] [MainThread]: On master: COMMIT
[0m11:30:54.434149 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:54.434270 [debug] [MainThread]: On master: COMMIT
[0m11:30:54.435172 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:30:54.435301 [debug] [MainThread]: On master: Close
[0m11:30:54.435495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:54.435613 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.customers' was properly closed.
[0m11:30:54.435753 [info ] [MainThread]: 
[0m11:30:54.435906 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m11:30:54.450930 [info ] [MainThread]: Done.
[0m11:30:54.452886 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.45041096, "process_user_time": 0.863429, "process_kernel_time": 0.155984, "process_mem_max_rss": "115949568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:30:54.453257 [debug] [MainThread]: Command `dbt source freshness` succeeded at 11:30:54.453199 after 0.45 seconds
[0m11:30:54.453466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeda830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2aafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2aa8f0>]}
[0m11:30:54.453649 [debug] [MainThread]: Flushing usage events
[0m11:37:38.402227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aadfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104407d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104407ed0>]}


============================== 11:37:38.432323 | 4d1b159a-cbac-4d9d-ab48-3dbf953071d0 ==============================
[0m11:37:38.432323 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:37:38.432697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt source freshness', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:37:38.432917 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:37:38.433140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4d1b159a-cbac-4d9d-ab48-3dbf953071d0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10443ce90>]}
[0m11:37:38.526123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d1b159a-cbac-4d9d-ab48-3dbf953071d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040fb8a0>]}
[0m11:37:38.549455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d1b159a-cbac-4d9d-ab48-3dbf953071d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041bb550>]}
[0m11:37:38.550019 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:37:38.559347 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:37:38.618958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:38.619192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:38.621662 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:37:38.642514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d1b159a-cbac-4d9d-ab48-3dbf953071d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104add130>]}
[0m11:37:38.703753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d1b159a-cbac-4d9d-ab48-3dbf953071d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f6f90>]}
[0m11:37:38.704046 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:37:38.704218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d1b159a-cbac-4d9d-ab48-3dbf953071d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448aa90>]}
[0m11:37:38.705192 [info ] [MainThread]: 
[0m11:37:38.705506 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:37:38.707556 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m11:37:38.756026 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:37:38.789471 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:37:38.789770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:38.863517 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m11:37:38.863821 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:37:38.864154 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:37:38.870328 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m11:37:38.871431 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:37:38.872061 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:37:38.875867 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:38.876107 [debug] [MainThread]: On master: BEGIN
[0m11:37:38.876266 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:37:38.884414 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:37:38.884664 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:38.884904 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:37:38.889143 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m11:37:38.889995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d1b159a-cbac-4d9d-ab48-3dbf953071d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad3650>]}
[0m11:37:38.890262 [debug] [MainThread]: On master: ROLLBACK
[0m11:37:38.890692 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:38.890913 [debug] [MainThread]: On master: BEGIN
[0m11:37:38.891566 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:37:38.891749 [debug] [MainThread]: On master: COMMIT
[0m11:37:38.891902 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:38.892049 [debug] [MainThread]: On master: COMMIT
[0m11:37:38.892434 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:37:38.892611 [debug] [MainThread]: On master: Close
[0m11:37:38.892885 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:38.893074 [info ] [MainThread]: 
[0m11:37:38.894622 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.customers
[0m11:37:38.894869 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.customers ................................ [RUN]
[0m11:37:38.895120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now source.jaffle_shop.jaffle_shop.customers)
[0m11:37:38.895306 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.customers
[0m11:37:38.895484 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.customers
[0m11:37:38.895759 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:37:38.895936 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: BEGIN
[0m11:37:38.896100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:38.904607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:37:38.904901 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:37:38.905092 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:37:38.905354 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m11:37:38.905842 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m11:37:38.910428 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m11:37:38.910668 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "source.jaffle_shop.jaffle_shop.customers"} */
select
      max(loaded_at_field) as max_loaded_at,
      now() as snapshotted_at
    from "dbt"."dev_data"."customers"
    
  
[0m11:37:38.912142 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m11:37:38.912915 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: Close
[0m11:37:38.913827 [error] [Thread-1 (]: 1 of 1 ERROR STALE freshness of jaffle_shop.customers .......................... [[31mERROR STALE[0m in 0.02s]
[0m11:37:38.914178 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.customers
[0m11:37:38.915130 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:38.915293 [debug] [MainThread]: On master: BEGIN
[0m11:37:38.915429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:37:38.922154 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:37:38.922412 [debug] [MainThread]: On master: COMMIT
[0m11:37:38.922562 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:38.922701 [debug] [MainThread]: On master: COMMIT
[0m11:37:38.923084 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:37:38.923233 [debug] [MainThread]: On master: Close
[0m11:37:38.923454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:38.923594 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.customers' was properly closed.
[0m11:37:38.923752 [info ] [MainThread]: 
[0m11:37:38.923927 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m11:37:38.939217 [info ] [MainThread]: 
[0m11:37:38.939462 [info ] [MainThread]: Done.
[0m11:37:38.941039 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 0.5739246, "process_user_time": 0.862559, "process_kernel_time": 0.174383, "process_mem_max_rss": "116326400", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:37:38.941409 [debug] [MainThread]: Command `dbt source freshness` failed at 11:37:38.941357 after 0.57 seconds
[0m11:37:38.941794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053aef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053af430>]}
[0m11:37:38.942080 [debug] [MainThread]: Flushing usage events
[0m11:37:44.312144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d51fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cffed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cffd90>]}


============================== 11:37:44.315449 | ca75d538-cce0-4b89-b3ee-46aba28afe27 ==============================
[0m11:37:44.315449 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:37:44.315775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:37:44.315984 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:37:44.316144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ca75d538-cce0-4b89-b3ee-46aba28afe27', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d34d60>]}
[0m11:37:44.392031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca75d538-cce0-4b89-b3ee-46aba28afe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f38a0>]}
[0m11:37:44.414686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca75d538-cce0-4b89-b3ee-46aba28afe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aaf550>]}
[0m11:37:44.416107 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:37:44.424509 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:37:44.484767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:44.485011 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:44.487527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m11:37:44.508861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca75d538-cce0-4b89-b3ee-46aba28afe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf5040>]}
[0m11:37:44.565818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca75d538-cce0-4b89-b3ee-46aba28afe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104deadd0>]}
[0m11:37:44.566112 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m11:37:44.566281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca75d538-cce0-4b89-b3ee-46aba28afe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106407860>]}
[0m11:37:44.567295 [info ] [MainThread]: 
[0m11:37:44.567590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:37:44.569466 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m11:37:44.601300 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m11:37:44.601522 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m11:37:44.601659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:44.620600 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.019 seconds
[0m11:37:44.621529 [debug] [ThreadPool]: On list_dbt: Close
[0m11:37:44.622394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m11:37:44.625400 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:37:44.625635 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m11:37:44.625771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:44.635349 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:37:44.635665 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m11:37:44.635843 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:37:44.638038 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m11:37:44.638939 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m11:37:44.639478 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m11:37:44.642066 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:44.642236 [debug] [MainThread]: On master: BEGIN
[0m11:37:44.642355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:37:44.650138 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:37:44.650309 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:44.650489 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:37:44.655146 [debug] [MainThread]: SQL status: SELECT 3 in 0.004 seconds
[0m11:37:44.655947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca75d538-cce0-4b89-b3ee-46aba28afe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd3890>]}
[0m11:37:44.656171 [debug] [MainThread]: On master: ROLLBACK
[0m11:37:44.656594 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:44.656721 [debug] [MainThread]: On master: BEGIN
[0m11:37:44.657332 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:37:44.657501 [debug] [MainThread]: On master: COMMIT
[0m11:37:44.657635 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:44.657755 [debug] [MainThread]: On master: COMMIT
[0m11:37:44.658088 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:37:44.658260 [debug] [MainThread]: On master: Close
[0m11:37:44.658486 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:44.658643 [info ] [MainThread]: 
[0m11:37:44.659992 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m11:37:44.660247 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.stg_customers .................................. [RUN]
[0m11:37:44.660459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m11:37:44.661007 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m11:37:44.664542 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m11:37:44.664983 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m11:37:44.682150 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m11:37:44.683003 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:37:44.683185 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m11:37:44.683333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:44.692312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:37:44.692474 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:37:44.692619 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m11:37:44.696238 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:37:44.699183 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:37:44.699368 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:37:44.699937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:44.701377 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:37:44.701550 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:37:44.702521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:37:44.710451 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:37:44.710659 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:37:44.710833 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m11:37:44.713222 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:37:44.716236 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m11:37:44.718613 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m11:37:44.718813 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m11:37:44.721603 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:37:44.722843 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m11:37:44.723590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca75d538-cce0-4b89-b3ee-46aba28afe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f6ba0>]}
[0m11:37:44.724117 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m11:37:44.724522 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m11:37:44.724757 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m11:37:44.725040 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.stg_orders ..................................... [RUN]
[0m11:37:44.725270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m11:37:44.725440 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m11:37:44.727028 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m11:37:44.728006 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m11:37:44.729378 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m11:37:44.729912 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:37:44.730090 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m11:37:44.730244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:44.738912 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:37:44.739196 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:37:44.739375 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m11:37:44.740724 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m11:37:44.742178 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:37:44.742358 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m11:37:44.743843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:37:44.745383 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:37:44.745574 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:37:44.746765 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:37:44.747919 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:37:44.748668 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:37:44.748841 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m11:37:44.751653 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:37:44.752633 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m11:37:44.752969 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m11:37:44.753375 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m11:37:44.754705 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:37:44.755424 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m11:37:44.755709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca75d538-cce0-4b89-b3ee-46aba28afe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b03ecb0>]}
[0m11:37:44.756028 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.03s]
[0m11:37:44.756333 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m11:37:44.756547 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m11:37:44.756813 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.stg_payments ................................... [RUN]
[0m11:37:44.757034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m11:37:44.757207 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m11:37:44.759449 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m11:37:44.760205 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m11:37:44.761630 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m11:37:44.762284 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:37:44.762464 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m11:37:44.762624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:44.770833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:37:44.771121 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:37:44.771322 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    
    (amount / 100)::numeric(16, 2)
 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m11:37:44.773103 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:37:44.774781 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:37:44.774985 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m11:37:44.775913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:37:44.777498 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:37:44.777691 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m11:37:44.778922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:37:44.779554 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:37:44.779725 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:37:44.779879 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m11:37:44.781517 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:37:44.782496 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m11:37:44.782750 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m11:37:44.782924 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m11:37:44.785610 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m11:37:44.786312 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m11:37:44.786598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca75d538-cce0-4b89-b3ee-46aba28afe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667ab50>]}
[0m11:37:44.786908 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.03s]
[0m11:37:44.787207 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m11:37:44.787601 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m11:37:44.787900 [info ] [Thread-1 (]: 4 of 6 START sql table model dev.fct_orders .................................... [RUN]
[0m11:37:44.788205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m11:37:44.788402 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m11:37:44.790005 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m11:37:44.790752 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m11:37:44.802679 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m11:37:44.803685 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:37:44.803862 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m11:37:44.804009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:44.813226 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:37:44.813496 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:37:44.813682 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    

  create  table "dbt"."dev"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
  
[0m11:37:44.817122 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.003 seconds
[0m11:37:44.818694 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:37:44.818875 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders" rename to "fct_orders__dbt_backup"
[0m11:37:44.819387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:44.822828 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:37:44.823038 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m11:37:44.823594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:44.826189 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m11:37:44.826379 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:37:44.826539 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m11:37:44.827467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:37:44.828471 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m11:37:44.829827 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m11:37:44.830011 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m11:37:44.833680 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m11:37:44.834375 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m11:37:44.834643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca75d538-cce0-4b89-b3ee-46aba28afe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b046cf0>]}
[0m11:37:44.834964 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dev.fct_orders ............................... [[32mSELECT 99[0m in 0.05s]
[0m11:37:44.835269 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m11:37:44.835492 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m11:37:44.835759 [info ] [Thread-1 (]: 5 of 6 START sql table model dev.order_payment_method_amounts .................. [RUN]
[0m11:37:44.836027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m11:37:44.836207 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m11:37:44.837958 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:37:44.838845 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m11:37:44.840581 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m11:37:44.841437 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:37:44.841623 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m11:37:44.841779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:44.849457 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:37:44.850083 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:37:44.850369 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  
    

  create  table "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
  
  
    as
  
  (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
  
[0m11:37:44.852450 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.002 seconds
[0m11:37:44.853985 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:37:44.854185 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts" rename to "order_payment_method_amounts__dbt_backup"
[0m11:37:44.854809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:44.856339 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:37:44.856568 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m11:37:44.857243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:44.858912 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m11:37:44.859165 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:37:44.859347 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m11:37:44.861579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:37:44.862664 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m11:37:44.862952 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m11:37:44.863137 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop table if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m11:37:44.864856 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m11:37:44.865631 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m11:37:44.866134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca75d538-cce0-4b89-b3ee-46aba28afe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067be930>]}
[0m11:37:44.866504 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dev.order_payment_method_amounts ............. [[32mSELECT 99[0m in 0.03s]
[0m11:37:44.866821 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m11:37:44.867300 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m11:37:44.867586 [info ] [Thread-1 (]: 6 of 6 START sql table model dev.dim_customers ................................. [RUN]
[0m11:37:44.867899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.dim_customers)
[0m11:37:44.868103 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m11:37:44.869738 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m11:37:44.870483 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m11:37:44.872587 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m11:37:44.873378 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:37:44.873567 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m11:37:44.873720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:44.882036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:37:44.882604 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:37:44.882836 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."dev"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m11:37:44.885546 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.002 seconds
[0m11:37:44.887208 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:37:44.887420 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers" rename to "dim_customers__dbt_backup"
[0m11:37:44.888023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:44.889520 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:37:44.889745 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m11:37:44.890468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:37:44.891748 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m11:37:44.891992 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:37:44.892168 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m11:37:44.893450 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:37:44.894962 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m11:37:44.895254 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m11:37:44.895441 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m11:37:44.897576 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m11:37:44.898349 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m11:37:44.898639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca75d538-cce0-4b89-b3ee-46aba28afe27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106697470>]}
[0m11:37:44.898962 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dev.dim_customers ............................ [[32mSELECT 100[0m in 0.03s]
[0m11:37:44.899264 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m11:37:44.899936 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:44.900103 [debug] [MainThread]: On master: BEGIN
[0m11:37:44.900246 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:37:44.907472 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:37:44.907708 [debug] [MainThread]: On master: COMMIT
[0m11:37:44.907847 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:44.907977 [debug] [MainThread]: On master: COMMIT
[0m11:37:44.908365 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:37:44.908544 [debug] [MainThread]: On master: Close
[0m11:37:44.908768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:44.908905 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m11:37:44.909099 [info ] [MainThread]: 
[0m11:37:44.909285 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m11:37:44.909918 [debug] [MainThread]: Command end result
[0m11:37:44.924603 [info ] [MainThread]: 
[0m11:37:44.924990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:44.925162 [info ] [MainThread]: 
[0m11:37:44.925319 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:37:44.926481 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6495632, "process_user_time": 1.006811, "process_kernel_time": 0.146509, "process_mem_max_rss": "118079488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:37:44.926758 [debug] [MainThread]: Command `dbt run` succeeded at 11:37:44.926713 after 0.65 seconds
[0m11:37:44.926949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009bf5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b097b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b097a70>]}
[0m11:37:44.927125 [debug] [MainThread]: Flushing usage events
[0m12:06:11.541544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10279dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f7ed0>]}


============================== 12:06:11.554782 | a5540239-d110-4a80-95eb-4b2b6a9db5f2 ==============================
[0m12:06:11.554782 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:06:11.555152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:06:11.555364 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:06:11.555535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a5540239-d110-4a80-95eb-4b2b6a9db5f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10412ce90>]}
[0m12:06:11.648381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5540239-d110-4a80-95eb-4b2b6a9db5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103deb8a0>]}
[0m12:06:11.672364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5540239-d110-4a80-95eb-4b2b6a9db5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea7550>]}
[0m12:06:11.672969 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:06:11.682910 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:06:11.755143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:06:11.755392 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:06:11.758064 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m12:06:11.779601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5540239-d110-4a80-95eb-4b2b6a9db5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cd130>]}
[0m12:06:11.793399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5540239-d110-4a80-95eb-4b2b6a9db5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477f5b0>]}
[0m12:06:11.793683 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m12:06:11.793854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5540239-d110-4a80-95eb-4b2b6a9db5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d76c30>]}
[0m12:06:11.794917 [info ] [MainThread]: 
[0m12:06:11.795208 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:06:11.797068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m12:06:11.847974 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m12:06:11.848206 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m12:06:11.848344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:12.008576 [debug] [ThreadPool]: SQL status: BEGIN in 0.160 seconds
[0m12:06:12.009005 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m12:06:12.009303 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:06:12.020177 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m12:06:12.021682 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m12:06:12.022493 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m12:06:12.027358 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:12.027687 [debug] [MainThread]: On master: BEGIN
[0m12:06:12.027910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:06:12.037550 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:06:12.037903 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:12.038207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:06:12.043190 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m12:06:12.044293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5540239-d110-4a80-95eb-4b2b6a9db5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f65d0>]}
[0m12:06:12.044614 [debug] [MainThread]: On master: ROLLBACK
[0m12:06:12.045244 [debug] [MainThread]: On master: Close
[0m12:06:12.045683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:06:12.045948 [info ] [MainThread]: 
[0m12:06:12.048028 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m12:06:12.048460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m12:06:12.048735 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m12:06:12.056454 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m12:06:12.057885 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m12:06:12.059082 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m12:06:12.059385 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m12:06:12.059896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m12:06:12.060156 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m12:06:12.061966 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m12:06:12.062647 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m12:06:12.063055 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m12:06:12.063289 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m12:06:12.063542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m12:06:12.063786 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m12:06:12.066050 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m12:06:12.066827 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m12:06:12.067462 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m12:06:12.067822 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m12:06:12.068184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m12:06:12.068694 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m12:06:12.077477 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m12:06:12.078896 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m12:06:12.079386 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m12:06:12.079618 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m12:06:12.079854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m12:06:12.080039 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m12:06:12.085453 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:06:12.086194 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m12:06:12.086755 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m12:06:12.086988 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:06:12.087235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m12:06:12.087461 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:06:12.091923 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:06:12.092629 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:06:12.092986 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:06:12.093183 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m12:06:12.093389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m12:06:12.093552 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m12:06:12.096392 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m12:06:12.098859 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m12:06:12.099227 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m12:06:12.099432 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m12:06:12.099633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now model.jaffle_shop.fct_orders)
[0m12:06:12.099792 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m12:06:12.101194 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m12:06:12.101755 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m12:06:12.102091 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m12:06:12.102273 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m12:06:12.102470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m12:06:12.102657 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m12:06:12.104353 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m12:06:12.104932 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m12:06:12.105231 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m12:06:12.105413 [debug] [Thread-1 (]: Began running node test.jaffle_shop.positive_total_payments
[0m12:06:12.105601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now test.jaffle_shop.positive_total_payments)
[0m12:06:12.105757 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.positive_total_payments
[0m12:06:12.106864 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.positive_total_payments"
[0m12:06:12.107297 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.positive_total_payments
[0m12:06:12.107573 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.positive_total_payments
[0m12:06:12.107744 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m12:06:12.107911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.positive_total_payments, now model.jaffle_shop.dim_customers)
[0m12:06:12.108057 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m12:06:12.109225 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m12:06:12.109598 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m12:06:12.109872 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m12:06:12.110323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:12.110456 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m12:06:12.111271 [debug] [MainThread]: Command end result
[0m12:06:12.167731 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:06:12.167953 [info ] [MainThread]: Building catalog
[0m12:06:12.172701 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt.information_schema'
[0m12:06:12.177634 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
[0m12:06:12.178087 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
[0m12:06:12.178481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:12.188433 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:06:12.188676 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
[0m12:06:12.188887 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_payments')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('dev_data') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('order_payment_method_amounts')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('dev_data') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('fct_orders')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('dev_data') and
           upper(tbl.relname) = upper('payments')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:06:12.198015 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.009 seconds
[0m12:06:12.201681 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
[0m12:06:12.202417 [debug] [ThreadPool]: On dbt.information_schema: Close
[0m12:06:12.224078 [info ] [MainThread]: Catalog written to /Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/target/catalog.json
[0m12:06:12.225786 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.7203527, "process_user_time": 0.951699, "process_kernel_time": 0.184754, "process_mem_max_rss": "115081216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:06:12.226144 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:06:12.226096 after 0.72 seconds
[0m12:06:12.226314 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:06:12.226440 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.
[0m12:06:12.226590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ab960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104627110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505b570>]}
[0m12:06:12.226755 [debug] [MainThread]: Flushing usage events
[0m13:52:27.899519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102795fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f3d90>]}


============================== 13:52:27.912632 | f955e4be-5d46-44de-8d31-0fc39b58a73a ==============================
[0m13:52:27.912632 [info ] [MainThread]: Running with dbt=1.8.8
[0m13:52:27.912962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:52:27.913176 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m13:52:27.913340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f955e4be-5d46-44de-8d31-0fc39b58a73a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104124d60>]}
[0m13:52:28.005268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f955e4be-5d46-44de-8d31-0fc39b58a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103de38a0>]}
[0m13:52:28.029062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f955e4be-5d46-44de-8d31-0fc39b58a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea3550>]}
[0m13:52:28.029637 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:52:28.039693 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m13:52:28.115013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:28.115286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:28.118003 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m13:52:28.139185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f955e4be-5d46-44de-8d31-0fc39b58a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cd040>]}
[0m13:52:28.200119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f955e4be-5d46-44de-8d31-0fc39b58a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041dedd0>]}
[0m13:52:28.200414 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m13:52:28.200600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f955e4be-5d46-44de-8d31-0fc39b58a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8f860>]}
[0m13:52:28.201638 [info ] [MainThread]: 
[0m13:52:28.201935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:52:28.203805 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m13:52:28.254062 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m13:52:28.254291 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m13:52:28.254433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:28.433459 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.179 seconds
[0m13:52:28.434398 [debug] [ThreadPool]: On list_dbt: Close
[0m13:52:28.435341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m13:52:28.438464 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m13:52:28.438687 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m13:52:28.438837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:28.446257 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:52:28.446551 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m13:52:28.446729 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:52:28.451321 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m13:52:28.452281 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m13:52:28.453010 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m13:52:28.457358 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:28.457627 [debug] [MainThread]: On master: BEGIN
[0m13:52:28.457774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:28.466141 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:52:28.466434 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:28.466674 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:52:28.472650 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m13:52:28.473602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f955e4be-5d46-44de-8d31-0fc39b58a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ab890>]}
[0m13:52:28.473952 [debug] [MainThread]: On master: ROLLBACK
[0m13:52:28.474445 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:28.474636 [debug] [MainThread]: On master: BEGIN
[0m13:52:28.475268 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:52:28.475453 [debug] [MainThread]: On master: COMMIT
[0m13:52:28.475606 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:28.475746 [debug] [MainThread]: On master: COMMIT
[0m13:52:28.476117 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:52:28.476276 [debug] [MainThread]: On master: Close
[0m13:52:28.476566 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:28.476953 [info ] [MainThread]: 
[0m13:52:28.478621 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:52:28.478994 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.stg_customers .................................. [RUN]
[0m13:52:28.479276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m13:52:28.479985 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:52:28.485157 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:52:28.485875 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:52:28.506463 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:52:28.507416 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m13:52:28.507612 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m13:52:28.507769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:28.515235 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:52:28.515508 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m13:52:28.515691 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m13:52:28.523379 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:52:28.535218 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m13:52:28.535529 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:52:28.537311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:28.539225 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m13:52:28.539454 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:52:28.540293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:28.549237 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:52:28.549533 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m13:52:28.549707 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:52:28.551922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:52:28.555237 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m13:52:28.557527 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m13:52:28.557727 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m13:52:28.561193 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:52:28.563719 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:52:28.565236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f955e4be-5d46-44de-8d31-0fc39b58a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7eba0>]}
[0m13:52:28.565698 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m13:52:28.566020 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:52:28.566240 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m13:52:28.566507 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.stg_orders ..................................... [RUN]
[0m13:52:28.566744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m13:52:28.566910 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:52:28.568521 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:52:28.569223 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:52:28.570562 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:52:28.571143 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m13:52:28.571315 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m13:52:28.571466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:28.581938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:52:28.584114 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m13:52:28.584688 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m13:52:28.589051 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:52:28.591420 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m13:52:28.591690 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:52:28.592712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:28.594467 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m13:52:28.594668 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:52:28.595499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:28.596260 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m13:52:28.596449 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m13:52:28.596606 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m13:52:28.597319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:52:28.598658 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m13:52:28.598995 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m13:52:28.599159 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m13:52:28.600327 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:52:28.601081 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m13:52:28.601359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f955e4be-5d46-44de-8d31-0fc39b58a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c6cb0>]}
[0m13:52:28.601665 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.03s]
[0m13:52:28.601959 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:52:28.602159 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m13:52:28.602478 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.stg_payments ................................... [RUN]
[0m13:52:28.602703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m13:52:28.602867 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:52:28.605017 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:52:28.605675 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:52:28.607066 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:52:28.607550 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m13:52:28.607743 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m13:52:28.608095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:28.614638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:52:28.614914 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m13:52:28.615084 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    
    (amount / 100)::numeric(16, 2)
 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m13:52:28.617030 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:52:28.619064 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m13:52:28.619365 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m13:52:28.620207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:28.621781 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m13:52:28.621958 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m13:52:28.622457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:28.623067 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m13:52:28.623231 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m13:52:28.623379 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m13:52:28.624254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:52:28.625322 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m13:52:28.625575 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m13:52:28.625740 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m13:52:28.627192 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:52:28.627880 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m13:52:28.628142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f955e4be-5d46-44de-8d31-0fc39b58a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105002b50>]}
[0m13:52:28.628482 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.03s]
[0m13:52:28.628790 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:52:28.629182 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m13:52:28.629481 [info ] [Thread-1 (]: 4 of 6 START sql table model dev.fct_orders .................................... [RUN]
[0m13:52:28.629739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m13:52:28.629909 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m13:52:28.631416 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m13:52:28.632980 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m13:52:28.650812 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m13:52:28.651998 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m13:52:28.652288 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m13:52:28.652451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:28.659532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:52:28.659799 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m13:52:28.659982 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    

  create  table "dbt"."dev"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
  
[0m13:52:28.664615 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.004 seconds
[0m13:52:28.666281 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m13:52:28.666477 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:52:28.667153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:28.670632 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m13:52:28.670849 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:52:28.671542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:28.674083 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m13:52:28.674283 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m13:52:28.674448 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m13:52:28.675423 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:52:28.676397 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m13:52:28.677760 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m13:52:28.677940 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m13:52:28.680647 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:52:28.681428 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m13:52:28.681749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f955e4be-5d46-44de-8d31-0fc39b58a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051cbbd0>]}
[0m13:52:28.682071 [info ] [Thread-1 (]: 4 of 6 OK created sql table model dev.fct_orders ............................... [[32mSELECT 99[0m in 0.05s]
[0m13:52:28.682444 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m13:52:28.682701 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m13:52:28.683005 [info ] [Thread-1 (]: 5 of 6 START sql table model dev.order_payment_method_amounts .................. [RUN]
[0m13:52:28.683262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m13:52:28.683453 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m13:52:28.685157 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m13:52:28.686196 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m13:52:28.688013 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m13:52:28.689028 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m13:52:28.689266 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m13:52:28.689442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:28.696720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:52:28.696999 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m13:52:28.697222 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  
    

  create  table "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
  
  
    as
  
  (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
  
[0m13:52:28.700908 [debug] [Thread-1 (]: SQL status: SELECT 99 in 0.003 seconds
[0m13:52:28.702471 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m13:52:28.702678 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts" rename to "order_payment_method_amounts__dbt_backup"
[0m13:52:28.703226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:28.704612 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m13:52:28.704812 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m13:52:28.705276 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:28.706327 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m13:52:28.706519 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m13:52:28.706686 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m13:52:28.707479 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:52:28.708487 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m13:52:28.708758 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m13:52:28.708940 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop table if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m13:52:28.711758 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:52:28.712523 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m13:52:28.712817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f955e4be-5d46-44de-8d31-0fc39b58a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514be30>]}
[0m13:52:28.713152 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dev.order_payment_method_amounts ............. [[32mSELECT 99[0m in 0.03s]
[0m13:52:28.713491 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m13:52:28.713720 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m13:52:28.713978 [info ] [Thread-1 (]: 6 of 6 START sql table model dev.dim_customers ................................. [RUN]
[0m13:52:28.714201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.dim_customers)
[0m13:52:28.714430 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m13:52:28.716066 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m13:52:28.716860 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m13:52:28.718671 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m13:52:28.719426 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m13:52:28.719728 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m13:52:28.719935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:28.735819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:52:28.736112 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m13:52:28.736325 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    

  create  table "dbt"."dev"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
  
[0m13:52:28.740765 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.004 seconds
[0m13:52:28.742503 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m13:52:28.742728 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:52:28.743316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:28.744777 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m13:52:28.744986 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:52:28.745524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:28.746328 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:52:28.746980 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m13:52:28.747166 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:52:28.748532 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:52:28.750024 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m13:52:28.750357 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m13:52:28.750551 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m13:52:28.753353 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:52:28.754202 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m13:52:28.754536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f955e4be-5d46-44de-8d31-0fc39b58a73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050273b0>]}
[0m13:52:28.754889 [info ] [Thread-1 (]: 6 of 6 OK created sql table model dev.dim_customers ............................ [[32mSELECT 100[0m in 0.04s]
[0m13:52:28.755217 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m13:52:28.755916 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:28.756088 [debug] [MainThread]: On master: BEGIN
[0m13:52:28.756245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:28.765537 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:52:28.765956 [debug] [MainThread]: On master: COMMIT
[0m13:52:28.766170 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:28.766328 [debug] [MainThread]: On master: COMMIT
[0m13:52:28.766805 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:52:28.767020 [debug] [MainThread]: On master: Close
[0m13:52:28.767484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:28.767641 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m13:52:28.767853 [info ] [MainThread]: 
[0m13:52:28.768032 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m13:52:28.768787 [debug] [MainThread]: Command end result
[0m13:52:28.785185 [info ] [MainThread]: 
[0m13:52:28.785467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:28.785619 [info ] [MainThread]: 
[0m13:52:28.785776 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:52:28.786943 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9179146, "process_user_time": 1.028039, "process_kernel_time": 0.184038, "process_mem_max_rss": "113393664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:52:28.787262 [debug] [MainThread]: Command `dbt run` succeeded at 13:52:28.787212 after 0.92 seconds
[0m13:52:28.787466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f5bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522b9b0>]}
[0m13:52:28.787651 [debug] [MainThread]: Flushing usage events
[0m20:32:11.326668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104465fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc3ed0>]}


============================== 20:32:11.340586 | e0d96595-5e2b-4d86-a4cd-9c7968b742d4 ==============================
[0m20:32:11.340586 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:32:11.340944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:32:11.341158 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m20:32:11.341322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e0d96595-5e2b-4d86-a4cd-9c7968b742d4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df0e90>]}
[0m20:32:11.430710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0d96595-5e2b-4d86-a4cd-9c7968b742d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab3570>]}
[0m20:32:11.455309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0d96595-5e2b-4d86-a4cd-9c7968b742d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b73550>]}
[0m20:34:44.868141 [error] [MainThread]: Encountered an error:

[0m20:34:44.886866 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m20:34:44.938265 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 153.65657, "process_user_time": 0.695747, "process_kernel_time": 0.177517, "process_mem_max_rss": "104939520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:34:44.939433 [debug] [MainThread]: Command `dbt docs serve` failed at 20:34:44.939248 after 153.66 seconds
[0m20:34:44.940546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064826c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064827b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b599b0>]}
[0m20:34:44.941807 [debug] [MainThread]: Flushing usage events
[0m20:35:40.965411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f69fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c3ed0>]}


============================== 20:35:40.998630 | 6ae5df12-230f-4b57-b19b-07e4dfaca397 ==============================
[0m20:35:40.998630 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:35:40.998971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt source freshness', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:35:40.999183 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m20:35:40.999334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6ae5df12-230f-4b57-b19b-07e4dfaca397', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f8e90>]}
[0m20:35:41.087379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ae5df12-230f-4b57-b19b-07e4dfaca397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b78a0>]}
[0m20:35:41.110142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ae5df12-230f-4b57-b19b-07e4dfaca397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108673550>]}
[0m20:35:41.110613 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:35:41.120978 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:35:41.199110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:35:41.199350 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:35:41.201848 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m20:35:41.223112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ae5df12-230f-4b57-b19b-07e4dfaca397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9d130>]}
[0m20:35:41.284910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ae5df12-230f-4b57-b19b-07e4dfaca397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b2f90>]}
[0m20:35:41.285203 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m20:35:41.285381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ae5df12-230f-4b57-b19b-07e4dfaca397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108946a90>]}
[0m20:35:41.286376 [info ] [MainThread]: 
[0m20:35:41.286670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:41.288567 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m20:35:41.339274 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m20:35:41.339499 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m20:35:41.339633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:41.486281 [debug] [ThreadPool]: SQL status: BEGIN in 0.147 seconds
[0m20:35:41.486627 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m20:35:41.486872 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:35:41.512523 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m20:35:41.513882 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m20:35:41.514695 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m20:35:41.519085 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:41.519360 [debug] [MainThread]: On master: BEGIN
[0m20:35:41.519561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:41.529886 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:35:41.530164 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:41.530466 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:35:41.541215 [debug] [MainThread]: SQL status: SELECT 3 in 0.010 seconds
[0m20:35:41.542375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ae5df12-230f-4b57-b19b-07e4dfaca397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f93650>]}
[0m20:35:41.542749 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:41.543340 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:41.543560 [debug] [MainThread]: On master: BEGIN
[0m20:35:41.544279 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:35:41.544499 [debug] [MainThread]: On master: COMMIT
[0m20:35:41.544684 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:41.544861 [debug] [MainThread]: On master: COMMIT
[0m20:35:41.545328 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:35:41.545620 [debug] [MainThread]: On master: Close
[0m20:35:41.545995 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:35:41.546237 [info ] [MainThread]: 
[0m20:35:41.548132 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.customers
[0m20:35:41.548485 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.customers ................................ [RUN]
[0m20:35:41.548829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now source.jaffle_shop.jaffle_shop.customers)
[0m20:35:41.549094 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.customers
[0m20:35:41.549346 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.customers
[0m20:35:41.549730 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m20:35:41.549973 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: BEGIN
[0m20:35:41.550184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:41.567394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m20:35:41.567699 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m20:35:41.567866 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m20:35:41.568017 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: COMMIT
[0m20:35:41.568354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m20:35:41.572490 [debug] [Thread-1 (]: Using postgres connection "source.jaffle_shop.jaffle_shop.customers"
[0m20:35:41.572688 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "source.jaffle_shop.jaffle_shop.customers"} */
select
      max(loaded_at_field) as max_loaded_at,
      now() as snapshotted_at
    from "dbt"."dev_data"."customers"
    
  
[0m20:35:41.576110 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:35:41.576809 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.customers: Close
[0m20:35:41.577708 [error] [Thread-1 (]: 1 of 1 ERROR STALE freshness of jaffle_shop.customers .......................... [[31mERROR STALE[0m in 0.03s]
[0m20:35:41.578023 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.customers
[0m20:35:41.579020 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:41.579187 [debug] [MainThread]: On master: BEGIN
[0m20:35:41.579311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:41.587313 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:35:41.587590 [debug] [MainThread]: On master: COMMIT
[0m20:35:41.587753 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:41.587901 [debug] [MainThread]: On master: COMMIT
[0m20:35:41.588399 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:35:41.588643 [debug] [MainThread]: On master: Close
[0m20:35:41.588909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:41.589061 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.customers' was properly closed.
[0m20:35:41.589230 [info ] [MainThread]: 
[0m20:35:41.589738 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m20:35:41.606476 [info ] [MainThread]: 
[0m20:35:41.606745 [info ] [MainThread]: Done.
[0m20:35:41.608368 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 0.67940396, "process_user_time": 0.854232, "process_kernel_time": 0.174201, "process_mem_max_rss": "114589696", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:35:41.608730 [debug] [MainThread]: Command `dbt source freshness` failed at 20:35:41.608668 after 0.68 seconds
[0m20:35:41.608959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109546af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991f430>]}
[0m20:35:41.609145 [debug] [MainThread]: Flushing usage events
[0m20:35:47.495887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f51fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bfed0>]}


============================== 20:35:47.499365 | 5edc797f-540d-40b8-b686-f3cbe7a63917 ==============================
[0m20:35:47.499365 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:35:47.499693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m20:35:47.499896 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m20:35:47.500057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5edc797f-540d-40b8-b686-f3cbe7a63917', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f4e90>]}
[0m20:35:47.575225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5edc797f-540d-40b8-b686-f3cbe7a63917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ef8a0>]}
[0m20:35:47.598152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5edc797f-540d-40b8-b686-f3cbe7a63917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ab550>]}
[0m20:35:47.599588 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:35:47.608002 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:35:47.675926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:35:47.676174 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:35:47.678772 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m20:35:47.700353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5edc797f-540d-40b8-b686-f3cbe7a63917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d41130>]}
[0m20:35:47.711789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5edc797f-540d-40b8-b686-f3cbe7a63917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085df3f0>]}
[0m20:35:47.712056 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m20:35:47.712225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5edc797f-540d-40b8-b686-f3cbe7a63917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ea680>]}
[0m20:35:47.713264 [info ] [MainThread]: 
[0m20:35:47.713556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:47.715420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m20:35:47.750878 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m20:35:47.751100 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m20:35:47.751237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:47.768456 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m20:35:47.768719 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m20:35:47.768885 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m20:35:47.772571 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m20:35:47.773383 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m20:35:47.774094 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m20:35:47.776731 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:47.776908 [debug] [MainThread]: On master: BEGIN
[0m20:35:47.777034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:47.786118 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:35:47.786371 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:47.786569 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:35:47.789104 [debug] [MainThread]: SQL status: SELECT 3 in 0.002 seconds
[0m20:35:47.789835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5edc797f-540d-40b8-b686-f3cbe7a63917', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4a5d0>]}
[0m20:35:47.790044 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:47.790378 [debug] [MainThread]: On master: Close
[0m20:35:47.790625 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:35:47.790781 [info ] [MainThread]: 
[0m20:35:47.792142 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m20:35:47.792375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m20:35:47.792538 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:35:47.796076 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:35:47.796835 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:35:47.797844 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:35:47.798071 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m20:35:47.798293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m20:35:47.798522 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:35:47.799797 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:35:47.800860 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:35:47.801284 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:35:47.801468 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m20:35:47.802160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m20:35:47.802317 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m20:35:47.804129 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m20:35:47.804792 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m20:35:47.805103 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m20:35:47.805289 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m20:35:47.806099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m20:35:47.806268 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m20:35:47.812717 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m20:35:47.814445 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m20:35:47.815050 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m20:35:47.815234 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:35:47.815411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:35:47.815625 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:35:47.819601 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:35:47.820848 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:35:47.821149 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:35:47.821324 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:35:47.821503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m20:35:47.821656 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:35:47.825538 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m20:35:47.826215 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:35:47.826521 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:35:47.826697 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:35:47.826872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m20:35:47.827025 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:35:47.829550 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:35:47.830132 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:35:47.830424 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:35:47.830595 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m20:35:47.830756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now model.jaffle_shop.fct_orders)
[0m20:35:47.830898 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m20:35:47.832028 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m20:35:47.832504 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m20:35:47.832782 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m20:35:47.832945 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m20:35:47.833122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m20:35:47.833286 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m20:35:47.834844 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m20:35:47.835435 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m20:35:47.835719 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m20:35:47.835894 [debug] [Thread-1 (]: Began running node test.jaffle_shop.positive_total_payments
[0m20:35:47.836059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now test.jaffle_shop.positive_total_payments)
[0m20:35:47.836206 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.positive_total_payments
[0m20:35:47.837217 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.positive_total_payments"
[0m20:35:47.837877 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.positive_total_payments
[0m20:35:47.838146 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.positive_total_payments
[0m20:35:47.838313 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m20:35:47.838472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.positive_total_payments, now model.jaffle_shop.dim_customers)
[0m20:35:47.838614 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m20:35:47.839758 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m20:35:47.840409 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m20:35:47.840673 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m20:35:47.841118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:47.841247 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m20:35:47.841991 [debug] [MainThread]: Command end result
[0m20:35:47.889424 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m20:35:47.890958 [info ] [MainThread]: Building catalog
[0m20:35:47.895190 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt.information_schema'
[0m20:35:47.898815 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
[0m20:35:47.899020 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
[0m20:35:47.899177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:47.909230 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:35:47.909442 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
[0m20:35:47.909639 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('order_payment_method_amounts')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('dev_data') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('stg_payments')) or (upper(sch.nspname) = upper('dev_data') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('dev_data') and
           upper(tbl.relname) = upper('payments')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('dev') and
           upper(tbl.relname) = upper('fct_orders')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m20:35:47.919465 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.010 seconds
[0m20:35:47.922833 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
[0m20:35:47.923266 [debug] [ThreadPool]: On dbt.information_schema: Close
[0m20:35:47.942309 [info ] [MainThread]: Catalog written to /Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/target/catalog.json
[0m20:35:47.943545 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.4794082, "process_user_time": 0.903422, "process_kernel_time": 0.139015, "process_mem_max_rss": "116506624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:35:47.943903 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:35:47.943853 after 0.48 seconds
[0m20:35:47.944072 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:35:47.944198 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.
[0m20:35:47.944352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089cb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089cb750>]}
[0m20:35:47.944524 [debug] [MainThread]: Flushing usage events
[0m20:35:54.510508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103251fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fbed0>]}


============================== 20:35:54.514027 | b7b37107-29ae-4689-876a-86105d55d6b1 ==============================
[0m20:35:54.514027 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:35:54.514350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:35:54.514571 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m20:35:54.514731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b7b37107-29ae-4689-876a-86105d55d6b1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10522ce90>]}
[0m20:35:54.590500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7b37107-29ae-4689-876a-86105d55d6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df3570>]}
[0m20:35:54.613354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7b37107-29ae-4689-876a-86105d55d6b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e7550>]}
[0m20:39:15.947982 [error] [MainThread]: Encountered an error:

[0m20:39:15.963589 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m20:39:15.981339 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 201.50414, "process_user_time": 0.692745, "process_kernel_time": 0.135202, "process_mem_max_rss": "103972864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:39:15.982509 [debug] [MainThread]: Command `dbt docs serve` failed at 20:39:15.982333 after 201.51 seconds
[0m20:39:15.983289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060165d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060166c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c99b0>]}
[0m20:39:15.983876 [debug] [MainThread]: Flushing usage events
[0m20:39:20.347037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103151fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c3ed0>]}


============================== 20:39:20.350994 | 0e752fa5-49a9-479a-aca8-bb0b4639a422 ==============================
[0m20:39:20.350994 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:39:20.351348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:39:20.351560 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m20:39:20.351717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0e752fa5-49a9-479a-aca8-bb0b4639a422', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f0e90>]}
[0m20:39:20.434217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e752fa5-49a9-479a-aca8-bb0b4639a422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cef570>]}
[0m20:39:20.460579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e752fa5-49a9-479a-aca8-bb0b4639a422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dab550>]}
[0m20:46:06.295862 [error] [MainThread]: Encountered an error:

[0m20:46:06.312697 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m20:46:06.330754 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 406.02356, "process_user_time": 0.731681, "process_kernel_time": 0.170062, "process_mem_max_rss": "102514688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:46:06.332190 [debug] [MainThread]: Command `dbt docs serve` failed at 20:46:06.332065 after 406.03 seconds
[0m20:46:06.333085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067925d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067926c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8d9b0>]}
[0m20:46:06.333775 [debug] [MainThread]: Flushing usage events
[0m20:46:12.525367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028fdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cffed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cffd90>]}


============================== 20:46:12.529602 | 28bc0296-7e1a-4388-aa8c-2e39e17b0984 ==============================
[0m20:46:12.529602 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:46:12.529948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:46:12.530161 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m20:46:12.530324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '28bc0296-7e1a-4388-aa8c-2e39e17b0984', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d34d60>]}
[0m20:46:12.619882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28bc0296-7e1a-4388-aa8c-2e39e17b0984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ef8a0>]}
[0m20:46:12.642927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28bc0296-7e1a-4388-aa8c-2e39e17b0984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aab550>]}
[0m20:46:12.643505 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:46:12.653000 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:46:12.708179 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading jaffle_shop: sources.yml - Runtime Error
    Syntax error near line 17
    ------------------------------
    14 |             description: Primary key for customers.
    15 |         warn_after: {count: 2, period: minute}
    16 |         error_after: {count: 4, period: minute}
    17 |      - name: payments
    18 |      - name: orders
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 17, column 6
[0m20:46:12.709411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.22240412, "process_user_time": 0.729128, "process_kernel_time": 0.133931, "process_mem_max_rss": "106217472", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:46:12.709765 [debug] [MainThread]: Command `dbt run` failed at 20:46:12.709665 after 0.22 seconds
[0m20:46:12.710039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad0aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a8fe70>]}
[0m20:46:12.710250 [debug] [MainThread]: Flushing usage events
[0m20:59:38.094353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d51fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ffed0>]}


============================== 20:59:38.125086 | b366f599-7acc-4f48-9324-e090071eac4a ==============================
[0m20:59:38.125086 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:59:38.125534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m20:59:38.125777 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m20:59:38.125944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b366f599-7acc-4f48-9324-e090071eac4a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552ce90>]}
[0m20:59:38.222178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b366f599-7acc-4f48-9324-e090071eac4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ef570>]}
[0m20:59:38.245446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b366f599-7acc-4f48-9324-e090071eac4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e7550>]}
[0m21:01:56.944383 [error] [MainThread]: Encountered an error:

[0m21:01:56.961953 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/.venv/lib/python3.13/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "/opt/homebrew/Cellar/python@3.13/3.13.0_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m21:01:56.971789 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 138.91869, "process_user_time": 0.677947, "process_kernel_time": 0.158022, "process_mem_max_rss": "102957056", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:01:56.973739 [debug] [MainThread]: Command `dbt docs serve` failed at 21:01:56.973389 after 138.92 seconds
[0m21:01:56.975206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d59b0>]}
[0m21:01:56.975948 [debug] [MainThread]: Flushing usage events
[0m15:40:56.323153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10314dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aabed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aabd90>]}


============================== 15:40:56.338656 | c1ff2341-d12b-4b46-95cb-968859056835 ==============================
[0m15:40:56.338656 [info ] [MainThread]: Running with dbt=1.8.8
[0m15:40:56.339084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/mariallorcanavarro/.dbt', 'log_path': '/Users/mariallorcanavarro/Documents/Rosa/dbt-edem/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:40:56.339304 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:40:56.339469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1ff2341-d12b-4b46-95cb-968859056835', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adcd60>]}
[0m15:40:56.429477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1ff2341-d12b-4b46-95cb-968859056835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479b8a0>]}
[0m15:40:56.452824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1ff2341-d12b-4b46-95cb-968859056835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104857550>]}
[0m15:40:56.453435 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:40:56.463376 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m15:40:56.538290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:56.538530 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:56.541171 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.jaffle_shop
[0m15:40:56.562621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1ff2341-d12b-4b46-95cb-968859056835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10570d040>]}
[0m15:40:56.632600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1ff2341-d12b-4b46-95cb-968859056835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba4e50>]}
[0m15:40:56.632883 [info ] [MainThread]: Found 6 models, 5 data tests, 3 sources, 424 macros
[0m15:40:56.633049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1ff2341-d12b-4b46-95cb-968859056835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b85f30>]}
[0m15:40:56.634049 [info ] [MainThread]: 
[0m15:40:56.634332 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:40:56.636258 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m15:40:56.687166 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m15:40:56.687398 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m15:40:56.687532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:56.825112 [debug] [ThreadPool]: SQL status: BEGIN in 0.137 seconds
[0m15:40:56.825474 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m15:40:56.825715 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:40:56.851254 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m15:40:56.852599 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m15:40:56.853779 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m15:40:56.858098 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:56.858399 [debug] [MainThread]: On master: BEGIN
[0m15:40:56.858622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:40:56.871318 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m15:40:56.871592 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:56.871858 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:40:56.880846 [debug] [MainThread]: SQL status: SELECT 3 in 0.009 seconds
[0m15:40:56.881945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1ff2341-d12b-4b46-95cb-968859056835', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105adb350>]}
[0m15:40:56.882299 [debug] [MainThread]: On master: ROLLBACK
[0m15:40:56.882840 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:56.883121 [debug] [MainThread]: On master: BEGIN
[0m15:40:56.883882 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:40:56.884085 [debug] [MainThread]: On master: COMMIT
[0m15:40:56.884276 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:56.884457 [debug] [MainThread]: On master: COMMIT
[0m15:40:56.884891 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:40:56.885092 [debug] [MainThread]: On master: Close
[0m15:40:56.885419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:40:56.885651 [info ] [MainThread]: 
[0m15:40:56.887820 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m15:40:56.888205 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [RUN]
[0m15:40:56.888568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m15:40:56.888836 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m15:40:56.902159 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m15:40:56.903470 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m15:40:56.912655 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m15:40:56.913357 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m15:40:56.913553 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: BEGIN
[0m15:40:56.913727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:56.920799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:40:56.921120 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m15:40:56.921339 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','return_pending','placed'
)



      
    ) dbt_internal_test
[0m15:40:56.926358 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m15:40:56.928801 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: ROLLBACK
[0m15:40:56.929303 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: Close
[0m15:40:56.929682 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [[32mPASS[0m in 0.04s]
[0m15:40:56.930024 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m15:40:56.930261 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m15:40:56.930495 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m15:40:56.930718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m15:40:56.930899 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m15:40:56.934566 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:40:56.935552 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m15:40:56.936700 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:40:56.937178 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:40:56.937363 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m15:40:56.937526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:56.944450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:40:56.944704 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:40:56.944893 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt"."dev"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m15:40:56.945704 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:40:56.946546 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m15:40:56.947013 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m15:40:56.947374 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m15:40:56.947676 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m15:40:56.947888 [debug] [Thread-1 (]: Began running node test.jaffle_shop.positive_total_payments
[0m15:40:56.948125 [info ] [Thread-1 (]: 3 of 5 START test positive_total_payments ...................................... [RUN]
[0m15:40:56.948364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.positive_total_payments)
[0m15:40:56.948545 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.positive_total_payments
[0m15:40:56.949924 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.positive_total_payments"
[0m15:40:56.950921 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.positive_total_payments
[0m15:40:56.952188 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.positive_total_payments"
[0m15:40:56.952644 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.positive_total_payments"
[0m15:40:56.952942 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: BEGIN
[0m15:40:56.953206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:56.960188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:40:56.960457 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.positive_total_payments"
[0m15:40:56.960633 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.positive_total_payments"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with payments as (
    select
        *
    from
        "dbt"."dev"."stg_payments"
),

test_data as (
    select
        order_id,
        sum(amount) as total_amount
    from payments
    group by order_id
)

select *
from
    test_data
where
    total_amount < 0
      
    ) dbt_internal_test
[0m15:40:56.964063 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:40:56.964898 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: ROLLBACK
[0m15:40:56.965297 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: Close
[0m15:40:56.965600 [info ] [Thread-1 (]: 3 of 5 PASS positive_total_payments ............................................ [[32mPASS[0m in 0.02s]
[0m15:40:56.965889 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.positive_total_payments
[0m15:40:56.966092 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:40:56.966296 [info ] [Thread-1 (]: 4 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m15:40:56.966494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.positive_total_payments, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m15:40:56.966665 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:40:56.970869 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:40:56.971870 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:40:56.973152 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:40:56.973746 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:40:56.973928 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m15:40:56.974086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:56.980584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m15:40:56.980841 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:40:56.981031 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt"."dev"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt"."dev"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:40:56.982145 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:40:56.982995 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m15:40:56.983374 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m15:40:56.983691 [info ] [Thread-1 (]: 4 of 5 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.02s]
[0m15:40:56.983967 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:40:56.984178 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m15:40:56.984370 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m15:40:56.984573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m15:40:56.984776 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m15:40:56.987843 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m15:40:56.988617 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m15:40:56.989585 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m15:40:56.990312 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m15:40:56.990487 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m15:40:56.990637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:56.997038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m15:40:56.997289 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m15:40:56.997463 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:40:56.998339 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:40:56.999144 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m15:40:56.999506 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m15:40:56.999812 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.02s]
[0m15:40:57.000152 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m15:40:57.000870 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:57.001032 [debug] [MainThread]: On master: BEGIN
[0m15:40:57.001159 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:40:57.006719 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:40:57.006995 [debug] [MainThread]: On master: COMMIT
[0m15:40:57.007140 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:57.007267 [debug] [MainThread]: On master: COMMIT
[0m15:40:57.007582 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:40:57.007753 [debug] [MainThread]: On master: Close
[0m15:40:57.007977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:57.008104 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m15:40:57.008261 [info ] [MainThread]: 
[0m15:40:57.008415 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m15:40:57.008996 [debug] [MainThread]: Command end result
[0m15:40:57.025991 [info ] [MainThread]: 
[0m15:40:57.026259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:57.026408 [info ] [MainThread]: 
[0m15:40:57.026563 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:40:57.031314 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7502231, "process_user_time": 0.932004, "process_kernel_time": 0.202565, "process_mem_max_rss": "119586816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:40:57.031593 [debug] [MainThread]: Command `dbt test` succeeded at 15:40:57.031551 after 0.75 seconds
[0m15:40:57.031785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef87e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb1bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb13b0>]}
[0m15:40:57.031955 [debug] [MainThread]: Flushing usage events
[0m23:07:29.003513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d512800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e41a5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e419f00>]}


============================== 23:07:29.010391 | 2faf0539-dc8f-49f2-91e3-011f4e599499 ==============================
[0m23:07:29.010391 [info ] [MainThread]: Running with dbt=1.9.1
[0m23:07:29.011430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/juanmontoliuarrando/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt init jaffle_shop', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:07:29.012000 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:07:29.012499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2faf0539-dc8f-49f2-91e3-011f4e599499', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e41a5f0>]}
[0m23:07:29.038502 [info ] [MainThread]: Setting up your profile.
[0m23:08:09.181820 [error] [MainThread]: Encountered an error:

[0m23:08:09.184981 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/task/init.py", line 320, in run
    self.setup_profile(profile_name)
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/task/init.py", line 261, in setup_profile
    adapter = self.ask_for_adapter_choice()
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/task/init.py", line 242, in ask_for_adapter_choice
    numeric_choice = click.prompt(prompt_msg, type=click.INT)
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/click/termui.py", line 164, in prompt
    value = prompt_func(prompt)
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/click/termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m23:08:09.236557 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 40.33941, "process_in_blocks": "0", "process_kernel_time": 0.250759, "process_mem_max_rss": "87822336", "process_out_blocks": "0", "process_user_time": 1.528877}
[0m23:08:09.237877 [debug] [MainThread]: Command `dbt init` failed at 23:08:09.237506 after 40.34 seconds
[0m23:08:09.238923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d512800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e41b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e41d090>]}
[0m23:08:09.239750 [debug] [MainThread]: Flushing usage events
[0m23:08:10.273968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:41:17.952483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10328a7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10419a140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104198520>]}


============================== 08:41:17.958512 | 8d7ec5db-6f3e-4a91-ae33-3e4134bbe205 ==============================
[0m08:41:17.958512 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:41:17.959379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/juanmontoliuarrando/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:41:17.959945 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m08:41:17.960496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8d7ec5db-6f3e-4a91-ae33-3e4134bbe205', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10419a140>]}
[0m08:41:18.725971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d7ec5db-6f3e-4a91-ae33-3e4134bbe205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046650f0>]}
[0m08:41:18.796483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d7ec5db-6f3e-4a91-ae33-3e4134bbe205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046667d0>]}
[0m08:41:18.799166 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:41:19.099672 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:41:19.390591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m08:41:19.391250 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/payments.csv
[0m08:41:19.391680 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/customers.csv
[0m08:41:19.392077 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/orders.csv
[0m08:41:19.817289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d7ec5db-6f3e-4a91-ae33-3e4134bbe205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f3fd0>]}
[0m08:41:19.962207 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m08:41:19.972443 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m08:41:20.056809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d7ec5db-6f3e-4a91-ae33-3e4134bbe205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050358a0>]}
[0m08:41:20.057517 [info ] [MainThread]: Found 6 models, 5 data tests, 3 seeds, 3 sources, 430 macros
[0m08:41:20.058291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d7ec5db-6f3e-4a91-ae33-3e4134bbe205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff3550>]}
[0m08:41:20.061715 [info ] [MainThread]: 
[0m08:41:20.062544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:41:20.063355 [info ] [MainThread]: 
[0m08:41:20.064717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:41:20.071418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m08:41:20.210922 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m08:41:20.211711 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m08:41:20.212342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:41:20.422838 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.210 seconds
[0m08:41:20.424528 [debug] [ThreadPool]: On list_dbt: Close
[0m08:41:20.425545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_dev_data)
[0m08:41:20.426403 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "dev_data"
"
[0m08:41:20.433131 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_data"
[0m08:41:20.433572 [debug] [ThreadPool]: On create_dbt_dev_data: BEGIN
[0m08:41:20.433946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:41:20.451900 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m08:41:20.452361 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_data"
[0m08:41:20.452725 [debug] [ThreadPool]: On create_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_dbt_dev_data"} */
create schema if not exists "dev_data"
[0m08:41:20.455004 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m08:41:20.456076 [debug] [ThreadPool]: On create_dbt_dev_data: COMMIT
[0m08:41:20.456462 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev_data"
[0m08:41:20.456808 [debug] [ThreadPool]: On create_dbt_dev_data: COMMIT
[0m08:41:20.466465 [debug] [ThreadPool]: SQL status: COMMIT in 0.009 seconds
[0m08:41:20.467299 [debug] [ThreadPool]: On create_dbt_dev_data: Close
[0m08:41:20.470607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_dev_data, now list_dbt_dev)
[0m08:41:20.478214 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m08:41:20.478695 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m08:41:20.479059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:41:20.496494 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m08:41:20.497014 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m08:41:20.497401 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m08:41:20.501959 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m08:41:20.503301 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m08:41:20.504789 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m08:41:20.505720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_dev, now list_dbt_dev_data)
[0m08:41:20.509567 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m08:41:20.510007 [debug] [ThreadPool]: On list_dbt_dev_data: BEGIN
[0m08:41:20.510345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:41:20.528431 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m08:41:20.528991 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m08:41:20.529421 [debug] [ThreadPool]: On list_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev_data"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_data'
  
[0m08:41:20.533268 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m08:41:20.534578 [debug] [ThreadPool]: On list_dbt_dev_data: ROLLBACK
[0m08:41:20.535982 [debug] [ThreadPool]: On list_dbt_dev_data: Close
[0m08:41:20.601317 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:20.601826 [debug] [MainThread]: On master: BEGIN
[0m08:41:20.602215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:41:20.630202 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m08:41:20.630741 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:20.631657 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:41:20.639760 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m08:41:20.641435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d7ec5db-6f3e-4a91-ae33-3e4134bbe205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c29b0>]}
[0m08:41:20.642263 [debug] [MainThread]: On master: ROLLBACK
[0m08:41:20.644104 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:20.644767 [debug] [MainThread]: On master: BEGIN
[0m08:41:20.647471 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m08:41:20.647982 [debug] [MainThread]: On master: COMMIT
[0m08:41:20.648546 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:20.649084 [debug] [MainThread]: On master: COMMIT
[0m08:41:20.650478 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m08:41:20.650984 [debug] [MainThread]: On master: Close
[0m08:41:20.653246 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.customers
[0m08:41:20.654444 [info ] [Thread-1 (]: 1 of 3 START seed file dev_data.customers ...................................... [RUN]
[0m08:41:20.655587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev_data, now seed.jaffle_shop.customers)
[0m08:41:20.656506 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.customers
[0m08:41:20.657190 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.customers
[0m08:41:20.706326 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.customers"
[0m08:41:20.706941 [debug] [Thread-1 (]: On seed.jaffle_shop.customers: BEGIN
[0m08:41:20.707359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:20.726251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m08:41:20.727054 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.customers"
[0m08:41:20.727526 [debug] [Thread-1 (]: On seed.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.customers"} */

    create table "dbt"."dev_data"."customers" ("id" integer,"first_name" text,"last_name" text)
  
[0m08:41:20.732689 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.005 seconds
[0m08:41:20.778257 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.customers"
[0m08:41:20.778799 [debug] [Thread-1 (]: On seed.jaffle_shop.customers: 
          insert into "dbt"."dev_data"."customers" ("id", "first_name", "last_name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m08:41:20.781316 [debug] [Thread-1 (]: SQL status: INSERT 0 100 in 0.002 seconds
[0m08:41:20.787807 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.customers"
[0m08:41:20.808758 [debug] [Thread-1 (]: On seed.jaffle_shop.customers: COMMIT
[0m08:41:20.809271 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.customers"
[0m08:41:20.809690 [debug] [Thread-1 (]: On seed.jaffle_shop.customers: COMMIT
[0m08:41:20.812863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m08:41:20.815361 [debug] [Thread-1 (]: On seed.jaffle_shop.customers: Close
[0m08:41:20.818087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d7ec5db-6f3e-4a91-ae33-3e4134bbe205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c3f10>]}
[0m08:41:20.819330 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file dev_data.customers .................................. [[32mINSERT 100[0m in 0.16s]
[0m08:41:20.820497 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.customers
[0m08:41:20.820994 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.orders
[0m08:41:20.821564 [info ] [Thread-1 (]: 2 of 3 START seed file dev_data.orders ......................................... [RUN]
[0m08:41:20.822251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.customers, now seed.jaffle_shop.orders)
[0m08:41:20.822691 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.orders
[0m08:41:20.823112 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.orders
[0m08:41:20.832415 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.orders"
[0m08:41:20.832962 [debug] [Thread-1 (]: On seed.jaffle_shop.orders: BEGIN
[0m08:41:20.833409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:20.858208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m08:41:20.858828 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.orders"
[0m08:41:20.859272 [debug] [Thread-1 (]: On seed.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.orders"} */

    create table "dbt"."dev_data"."orders" ("id" integer,"user_id" integer,"order_date" date,"status" text)
  
[0m08:41:20.862478 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m08:41:20.901423 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.orders"
[0m08:41:20.901972 [debug] [Thread-1 (]: On seed.jaffle_shop.orders: 
          insert into "dbt"."dev_data"."orders" ("id", "user_id", "order_date", "status") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s...
[0m08:41:20.905005 [debug] [Thread-1 (]: SQL status: INSERT 0 99 in 0.003 seconds
[0m08:41:20.905804 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.orders"
[0m08:41:20.907743 [debug] [Thread-1 (]: On seed.jaffle_shop.orders: COMMIT
[0m08:41:20.908204 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.orders"
[0m08:41:20.908619 [debug] [Thread-1 (]: On seed.jaffle_shop.orders: COMMIT
[0m08:41:20.911270 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:41:20.912292 [debug] [Thread-1 (]: On seed.jaffle_shop.orders: Close
[0m08:41:20.913196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d7ec5db-6f3e-4a91-ae33-3e4134bbe205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103117fa0>]}
[0m08:41:20.914198 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file dev_data.orders ..................................... [[32mINSERT 99[0m in 0.09s]
[0m08:41:20.915161 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.orders
[0m08:41:20.915951 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.payments
[0m08:41:20.916999 [info ] [Thread-1 (]: 3 of 3 START seed file dev_data.payments ....................................... [RUN]
[0m08:41:20.917658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.orders, now seed.jaffle_shop.payments)
[0m08:41:20.918156 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.payments
[0m08:41:20.918595 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.payments
[0m08:41:20.931818 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.payments"
[0m08:41:20.932315 [debug] [Thread-1 (]: On seed.jaffle_shop.payments: BEGIN
[0m08:41:20.932716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:20.954183 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m08:41:20.955461 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.payments"
[0m08:41:20.955906 [debug] [Thread-1 (]: On seed.jaffle_shop.payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.payments"} */

    create table "dbt"."dev_data"."payments" ("id" integer,"orderid" integer,"paymentmethod" text,"status" text,"amount" integer,"created" date)
  
[0m08:41:20.959032 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.003 seconds
[0m08:41:21.039905 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.payments"
[0m08:41:21.040856 [debug] [Thread-1 (]: On seed.jaffle_shop.payments: 
          insert into "dbt"."dev_data"."payments" ("id", "orderid", "paymentmethod", "status", "amount", "created") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s...
[0m08:41:21.049854 [debug] [Thread-1 (]: SQL status: INSERT 0 120 in 0.008 seconds
[0m08:41:21.050941 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.payments"
[0m08:41:21.053347 [debug] [Thread-1 (]: On seed.jaffle_shop.payments: COMMIT
[0m08:41:21.053841 [debug] [Thread-1 (]: Using postgres connection "seed.jaffle_shop.payments"
[0m08:41:21.054254 [debug] [Thread-1 (]: On seed.jaffle_shop.payments: COMMIT
[0m08:41:21.056483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:41:21.057554 [debug] [Thread-1 (]: On seed.jaffle_shop.payments: Close
[0m08:41:21.058461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d7ec5db-6f3e-4a91-ae33-3e4134bbe205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105065870>]}
[0m08:41:21.059260 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file dev_data.payments ................................... [[32mINSERT 120[0m in 0.14s]
[0m08:41:21.060263 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.payments
[0m08:41:21.061936 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:21.062488 [debug] [MainThread]: On master: BEGIN
[0m08:41:21.062856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:41:21.086281 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m08:41:21.086826 [debug] [MainThread]: On master: COMMIT
[0m08:41:21.087198 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:21.087674 [debug] [MainThread]: On master: COMMIT
[0m08:41:21.090297 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m08:41:21.090903 [debug] [MainThread]: On master: Close
[0m08:41:21.091471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:41:21.092045 [debug] [MainThread]: Connection 'seed.jaffle_shop.payments' was properly closed.
[0m08:41:21.092494 [info ] [MainThread]: 
[0m08:41:21.093088 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m08:41:21.095072 [debug] [MainThread]: Command end result
[0m08:41:21.130657 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m08:41:21.132965 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m08:41:21.142573 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/run_results.json
[0m08:41:21.143207 [info ] [MainThread]: 
[0m08:41:21.143841 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:41:21.144351 [info ] [MainThread]: 
[0m08:41:21.144859 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:41:21.147901 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.3212736, "process_in_blocks": "0", "process_kernel_time": 0.668198, "process_mem_max_rss": "113139712", "process_out_blocks": "0", "process_user_time": 3.372138}
[0m08:41:21.148654 [debug] [MainThread]: Command `dbt seed` succeeded at 08:41:21.148518 after 3.32 seconds
[0m08:41:21.149924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10328a7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034db490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f7eb30>]}
[0m08:41:21.150940 [debug] [MainThread]: Flushing usage events
[0m08:41:21.730241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:58:39.733745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ce710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d6740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d6050>]}


============================== 08:58:39.740593 | 3c617d5c-6f05-4f12-ad9d-62991014c0fe ==============================
[0m08:58:39.740593 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:58:39.741558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/juanmontoliuarrando/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt init jaffle_shop', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:58:39.742120 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m08:58:39.742646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3c617d5c-6f05-4f12-ad9d-62991014c0fe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d6740>]}
[0m08:58:39.785368 [info ] [MainThread]: Setting up your profile.
[0m09:00:08.958664 [error] [MainThread]: Encountered an error:

[0m09:00:08.979819 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/task/init.py", line 320, in run
    self.setup_profile(profile_name)
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/task/init.py", line 261, in setup_profile
    adapter = self.ask_for_adapter_choice()
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/task/init.py", line 242, in ask_for_adapter_choice
    numeric_choice = click.prompt(prompt_msg, type=click.INT)
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/click/termui.py", line 164, in prompt
    value = prompt_func(prompt)
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/click/termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m09:00:08.985887 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 89.36119, "process_in_blocks": "0", "process_kernel_time": 0.438182, "process_mem_max_rss": "87670784", "process_out_blocks": "0", "process_user_time": 1.929658}
[0m09:00:08.998378 [debug] [MainThread]: Command `dbt init` failed at 09:00:08.998085 after 89.37 seconds
[0m09:00:08.999079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ce710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d8f40>]}
[0m09:00:08.999591 [debug] [MainThread]: Flushing usage events
[0m09:00:09.472213 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:00:17.863578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105527a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145a260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111459b70>]}


============================== 09:00:17.877153 | 842e40a7-5332-44a5-8e93-2fe4437d29af ==============================
[0m09:00:17.877153 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:00:17.878230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/juanmontoliuarrando/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt init jaffle_shop', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:00:17.878770 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:00:17.879331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '842e40a7-5332-44a5-8e93-2fe4437d29af', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145a260>]}
[0m09:00:17.924890 [info ] [MainThread]: Setting up your profile.
[0m09:00:34.167850 [error] [MainThread]: Encountered an error:

[0m09:00:34.175521 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/task/init.py", line 320, in run
    self.setup_profile(profile_name)
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/task/init.py", line 248, in setup_profile
    if not self.check_if_can_write_profile(profile_name=profile_name):
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/dbt/task/init.py", line 211, in check_if_can_write_profile
    response = click.confirm(
  File "/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/.venv/lib/python3.10/site-packages/click/termui.py", line 235, in confirm
    raise Abort() from None
click.exceptions.Abort

[0m09:00:34.177948 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 16.430948, "process_in_blocks": "0", "process_kernel_time": 0.367058, "process_mem_max_rss": "87797760", "process_out_blocks": "0", "process_user_time": 1.8097}
[0m09:00:34.181082 [debug] [MainThread]: Command `dbt init` failed at 09:00:34.180856 after 16.43 seconds
[0m09:00:34.183538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105527a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145d5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145d510>]}
[0m09:00:34.184194 [debug] [MainThread]: Flushing usage events
[0m09:00:34.911172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:01:49.028415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf1e7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de26260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de25b70>]}


============================== 09:01:49.034812 | ea6f1fab-03bc-4545-bbd1-a25146973ed3 ==============================
[0m09:01:49.034812 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:01:49.035758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/juanmontoliuarrando/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt init jaffle_shop', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:01:49.036270 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:01:49.036821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea6f1fab-03bc-4545-bbd1-a25146973ed3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de26260>]}
[0m09:01:49.080369 [info ] [MainThread]: Setting up your profile.
[0m09:01:54.666993 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 5.7302165, "process_in_blocks": "0", "process_kernel_time": 0.178358, "process_mem_max_rss": "87506944", "process_out_blocks": "0", "process_user_time": 1.383019}
[0m09:01:54.671590 [debug] [MainThread]: Command `dbt init` succeeded at 09:01:54.671241 after 5.73 seconds
[0m09:01:54.672714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf1e7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1b8670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de27a60>]}
[0m09:01:54.673991 [debug] [MainThread]: Flushing usage events
[0m09:01:55.145837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:04.487615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a686830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b590910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b590220>]}


============================== 09:10:04.496123 | 64a93768-7a67-4674-b025-ea900598188a ==============================
[0m09:10:04.496123 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:10:04.497275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/logs', 'version_check': 'True', 'profiles_dir': '/Users/juanmontoliuarrando/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:10:04.497915 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:10:04.498503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '64a93768-7a67-4674-b025-ea900598188a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9135b0>]}
[0m09:10:04.862794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64a93768-7a67-4674-b025-ea900598188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba750f0>]}
[0m09:10:04.933693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64a93768-7a67-4674-b025-ea900598188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b56d690>]}
[0m09:10:04.936377 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:10:05.160643 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:10:05.455387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:10:05.455849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:10:05.542218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64a93768-7a67-4674-b025-ea900598188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4ad690>]}
[0m09:10:05.694908 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m09:10:05.702774 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m09:10:05.915556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64a93768-7a67-4674-b025-ea900598188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c610df0>]}
[0m09:10:05.916261 [info ] [MainThread]: Found 6 models, 5 data tests, 3 seeds, 3 sources, 430 macros
[0m09:10:05.916832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64a93768-7a67-4674-b025-ea900598188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c611210>]}
[0m09:10:05.919200 [info ] [MainThread]: 
[0m09:10:05.919720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:10:05.920154 [info ] [MainThread]: 
[0m09:10:05.920826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:10:05.929186 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m09:10:06.039416 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:10:06.040066 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m09:10:06.040571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:06.107251 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m09:10:06.107901 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:10:06.108307 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:10:06.112707 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m09:10:06.114197 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m09:10:06.115629 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m09:10:06.116491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_dev, now list_dbt_dev_data)
[0m09:10:06.119731 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m09:10:06.120232 [debug] [ThreadPool]: On list_dbt_dev_data: BEGIN
[0m09:10:06.120626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:06.137939 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m09:10:06.138397 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m09:10:06.138857 [debug] [ThreadPool]: On list_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev_data"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_data'
  
[0m09:10:06.142855 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m09:10:06.144472 [debug] [ThreadPool]: On list_dbt_dev_data: ROLLBACK
[0m09:10:06.146100 [debug] [ThreadPool]: On list_dbt_dev_data: Close
[0m09:10:06.152932 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:06.153373 [debug] [MainThread]: On master: BEGIN
[0m09:10:06.153722 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:10:06.171507 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:10:06.172012 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:06.172472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:10:06.177907 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m09:10:06.179302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64a93768-7a67-4674-b025-ea900598188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c610b20>]}
[0m09:10:06.179878 [debug] [MainThread]: On master: ROLLBACK
[0m09:10:06.181237 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:06.181705 [debug] [MainThread]: On master: BEGIN
[0m09:10:06.184040 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m09:10:06.184509 [debug] [MainThread]: On master: COMMIT
[0m09:10:06.184951 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:06.185300 [debug] [MainThread]: On master: COMMIT
[0m09:10:06.186613 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:10:06.187070 [debug] [MainThread]: On master: Close
[0m09:10:06.188998 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:10:06.189901 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [RUN]
[0m09:10:06.190715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev_data, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m09:10:06.191670 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:10:06.219642 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:10:06.223466 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:10:06.245864 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:10:06.248212 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:10:06.248953 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: BEGIN
[0m09:10:06.249538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:06.268581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m09:10:06.269125 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:10:06.269588 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','return_pending','placed'
)



      
    ) dbt_internal_test
[0m09:10:06.273483 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.stg_orders" does not exist
LINE 17:     from "dbt"."dev"."stg_orders"
                  ^

[0m09:10:06.274198 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: ROLLBACK
[0m09:10:06.275964 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: Close
[0m09:10:06.288248 [debug] [Thread-1 (]: Database Error in test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed (models/schema.yml)
  relation "dev.stg_orders" does not exist
  LINE 17:     from "dbt"."dev"."stg_orders"
                    ^
  compiled code at target/run/jaffle_shop/models/schema.yml/accepted_values_stg_orders_99eb96a6e71559355998323ec83bd487.sql
[0m09:10:06.289074 [error] [Thread-1 (]: 1 of 5 ERROR accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [[31mERROR[0m in 0.10s]
[0m09:10:06.289969 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:10:06.290713 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:10:06.291224 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m09:10:06.292024 [debug] [Thread-4 (]: Marking all children of 'test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed (models/schema.yml)
  relation "dev.stg_orders" does not exist
  LINE 17:     from "dbt"."dev"."stg_orders"
                    ^
  compiled code at target/run/jaffle_shop/models/schema.yml/accepted_values_stg_orders_99eb96a6e71559355998323ec83bd487.sql.
[0m09:10:06.292628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m09:10:06.293910 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:10:06.308907 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:10:06.309797 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:10:06.361355 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:10:06.362331 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:10:06.362783 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m09:10:06.363192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:06.381319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m09:10:06.381948 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:10:06.382399 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt"."dev"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m09:10:06.384317 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.stg_orders" does not exist
LINE 14: from "dbt"."dev"."stg_orders"
              ^

[0m09:10:06.384958 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m09:10:06.386411 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m09:10:06.388002 [debug] [Thread-1 (]: Database Error in test not_null_stg_orders_order_id (models/schema.yml)
  relation "dev.stg_orders" does not exist
  LINE 14: from "dbt"."dev"."stg_orders"
                ^
  compiled code at target/run/jaffle_shop/models/schema.yml/not_null_stg_orders_order_id.sql
[0m09:10:06.388763 [error] [Thread-1 (]: 2 of 5 ERROR not_null_stg_orders_order_id ...................................... [[31mERROR[0m in 0.10s]
[0m09:10:06.390099 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:10:06.390762 [debug] [Thread-1 (]: Began running node test.jaffle_shop.positive_total_payments
[0m09:10:06.391426 [debug] [Thread-4 (]: Marking all children of 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_orders_order_id (models/schema.yml)
  relation "dev.stg_orders" does not exist
  LINE 14: from "dbt"."dev"."stg_orders"
                ^
  compiled code at target/run/jaffle_shop/models/schema.yml/not_null_stg_orders_order_id.sql.
[0m09:10:06.391933 [info ] [Thread-1 (]: 3 of 5 START test positive_total_payments ...................................... [RUN]
[0m09:10:06.393406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.positive_total_payments)
[0m09:10:06.394948 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.positive_total_payments
[0m09:10:06.402555 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.positive_total_payments"
[0m09:10:06.403472 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.positive_total_payments
[0m09:10:06.406151 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.positive_total_payments"
[0m09:10:06.407906 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.positive_total_payments"
[0m09:10:06.408551 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: BEGIN
[0m09:10:06.409041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:06.429671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m09:10:06.430233 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.positive_total_payments"
[0m09:10:06.430746 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.positive_total_payments"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with payments as (
    select
        *
    from
        "dbt"."dev"."stg_payments"
),

test_data as (
    select
        order_id,
        sum(amount) as total_amount
    from payments
    group by order_id
)

select *
from
    test_data
where
    total_amount < 0
      
    ) dbt_internal_test
[0m09:10:06.432754 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.stg_payments" does not exist
LINE 11:         "dbt"."dev"."stg_payments"
                 ^

[0m09:10:06.433304 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: ROLLBACK
[0m09:10:06.435154 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: Close
[0m09:10:06.437110 [debug] [Thread-1 (]: Database Error in test positive_total_payments (tests/positive_total_payments.sql)
  relation "dev.stg_payments" does not exist
  LINE 11:         "dbt"."dev"."stg_payments"
                   ^
  compiled code at target/run/jaffle_shop/tests/positive_total_payments.sql
[0m09:10:06.437881 [error] [Thread-1 (]: 3 of 5 ERROR positive_total_payments ........................................... [[31mERROR[0m in 0.04s]
[0m09:10:06.439130 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.positive_total_payments
[0m09:10:06.439875 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:10:06.441065 [debug] [Thread-4 (]: Marking all children of 'test.jaffle_shop.positive_total_payments' to be skipped because of status 'error'.  Reason: Database Error in test positive_total_payments (tests/positive_total_payments.sql)
  relation "dev.stg_payments" does not exist
  LINE 11:         "dbt"."dev"."stg_payments"
                   ^
  compiled code at target/run/jaffle_shop/tests/positive_total_payments.sql.
[0m09:10:06.440373 [info ] [Thread-1 (]: 4 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m09:10:06.441968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.positive_total_payments, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m09:10:06.442449 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:10:06.458029 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:10:06.459072 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:10:06.461969 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:10:06.462975 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:10:06.463505 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m09:10:06.463955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:06.483392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m09:10:06.483998 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:10:06.484591 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt"."dev"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt"."dev"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:10:06.486841 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.stg_orders" does not exist
LINE 13:     from "dbt"."dev"."stg_orders"
                  ^

[0m09:10:06.487383 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m09:10:06.489074 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m09:10:06.490869 [debug] [Thread-1 (]: Database Error in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/schema.yml)
  relation "dev.stg_orders" does not exist
  LINE 13:     from "dbt"."dev"."stg_orders"
                    ^
  compiled code at target/run/jaffle_shop/models/schema.yml/relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
[0m09:10:06.491591 [error] [Thread-1 (]: 4 of 5 ERROR relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[31mERROR[0m in 0.05s]
[0m09:10:06.492959 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:10:06.493537 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:10:06.494013 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m09:10:06.494710 [debug] [Thread-4 (]: Marking all children of 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' to be skipped because of status 'error'.  Reason: Database Error in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/schema.yml)
  relation "dev.stg_orders" does not exist
  LINE 13:     from "dbt"."dev"."stg_orders"
                    ^
  compiled code at target/run/jaffle_shop/models/schema.yml/relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql.
[0m09:10:06.495257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m09:10:06.495837 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:10:06.507304 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:10:06.509051 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:10:06.512314 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:10:06.513226 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:10:06.513691 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m09:10:06.514116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:06.533900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m09:10:06.534455 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:10:06.535012 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:10:06.537247 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dev.stg_orders" does not exist
LINE 15: from "dbt"."dev"."stg_orders"
              ^

[0m09:10:06.537852 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m09:10:06.539349 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m09:10:06.541539 [debug] [Thread-1 (]: Database Error in test unique_stg_orders_order_id (models/schema.yml)
  relation "dev.stg_orders" does not exist
  LINE 15: from "dbt"."dev"."stg_orders"
                ^
  compiled code at target/run/jaffle_shop/models/schema.yml/unique_stg_orders_order_id.sql
[0m09:10:06.543036 [error] [Thread-1 (]: 5 of 5 ERROR unique_stg_orders_order_id ........................................ [[31mERROR[0m in 0.05s]
[0m09:10:06.545652 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:10:06.546397 [debug] [Thread-4 (]: Marking all children of 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_orders_order_id (models/schema.yml)
  relation "dev.stg_orders" does not exist
  LINE 15: from "dbt"."dev"."stg_orders"
                ^
  compiled code at target/run/jaffle_shop/models/schema.yml/unique_stg_orders_order_id.sql.
[0m09:10:06.547860 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:06.548306 [debug] [MainThread]: On master: BEGIN
[0m09:10:06.548729 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:10:06.570319 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m09:10:06.571354 [debug] [MainThread]: On master: COMMIT
[0m09:10:06.572274 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:06.572746 [debug] [MainThread]: On master: COMMIT
[0m09:10:06.574201 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:10:06.574694 [debug] [MainThread]: On master: Close
[0m09:10:06.575278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:06.575829 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m09:10:06.576280 [info ] [MainThread]: 
[0m09:10:06.576874 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m09:10:06.580790 [debug] [MainThread]: Command end result
[0m09:10:06.619171 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m09:10:06.621292 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m09:10:06.634791 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/run_results.json
[0m09:10:06.635489 [info ] [MainThread]: 
[0m09:10:06.636333 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m09:10:06.637246 [info ] [MainThread]: 
[0m09:10:06.638236 [error] [MainThread]:   Database Error in test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed (models/schema.yml)
  relation "dev.stg_orders" does not exist
  LINE 17:     from "dbt"."dev"."stg_orders"
                    ^
  compiled code at target/run/jaffle_shop/models/schema.yml/accepted_values_stg_orders_99eb96a6e71559355998323ec83bd487.sql
[0m09:10:06.639017 [info ] [MainThread]: 
[0m09:10:06.639837 [error] [MainThread]:   Database Error in test not_null_stg_orders_order_id (models/schema.yml)
  relation "dev.stg_orders" does not exist
  LINE 14: from "dbt"."dev"."stg_orders"
                ^
  compiled code at target/run/jaffle_shop/models/schema.yml/not_null_stg_orders_order_id.sql
[0m09:10:06.640697 [info ] [MainThread]: 
[0m09:10:06.641882 [error] [MainThread]:   Database Error in test positive_total_payments (tests/positive_total_payments.sql)
  relation "dev.stg_payments" does not exist
  LINE 11:         "dbt"."dev"."stg_payments"
                   ^
  compiled code at target/run/jaffle_shop/tests/positive_total_payments.sql
[0m09:10:06.649051 [info ] [MainThread]: 
[0m09:10:06.657537 [error] [MainThread]:   Database Error in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models/schema.yml)
  relation "dev.stg_orders" does not exist
  LINE 13:     from "dbt"."dev"."stg_orders"
                    ^
  compiled code at target/run/jaffle_shop/models/schema.yml/relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
[0m09:10:06.658679 [info ] [MainThread]: 
[0m09:10:06.659882 [error] [MainThread]:   Database Error in test unique_stg_orders_order_id (models/schema.yml)
  relation "dev.stg_orders" does not exist
  LINE 15: from "dbt"."dev"."stg_orders"
                ^
  compiled code at target/run/jaffle_shop/models/schema.yml/unique_stg_orders_order_id.sql
[0m09:10:06.660608 [info ] [MainThread]: 
[0m09:10:06.661309 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m09:10:06.676523 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.291568, "process_in_blocks": "0", "process_kernel_time": 0.661494, "process_mem_max_rss": "140697600", "process_out_blocks": "0", "process_user_time": 3.211034}
[0m09:10:06.677290 [debug] [MainThread]: Command `dbt test` failed at 09:10:06.677151 after 2.29 seconds
[0m09:10:06.677803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a686830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3cd1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3cdff0>]}
[0m09:10:06.678295 [debug] [MainThread]: Flushing usage events
[0m09:10:07.156027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:12:36.350468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d2830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a5e10>]}


============================== 09:12:36.362256 | a43a06af-9063-48fc-9002-08e76f38b0d2 ==============================
[0m09:12:36.362256 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:12:36.363365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/logs', 'version_check': 'True', 'profiles_dir': '/Users/juanmontoliuarrando/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:12:36.364009 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:12:36.364613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a43a06af-9063-48fc-9002-08e76f38b0d2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a513ca0>]}
[0m09:12:36.657188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a43a06af-9063-48fc-9002-08e76f38b0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa813c0>]}
[0m09:12:36.730583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a43a06af-9063-48fc-9002-08e76f38b0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a5c00>]}
[0m09:12:36.733250 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:12:36.972466 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:12:37.283070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:12:37.283572 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:12:37.379294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a43a06af-9063-48fc-9002-08e76f38b0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4bd510>]}
[0m09:12:37.554055 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m09:12:37.563271 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m09:12:37.686609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a43a06af-9063-48fc-9002-08e76f38b0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b422740>]}
[0m09:12:37.687329 [info ] [MainThread]: Found 6 models, 5 data tests, 3 seeds, 3 sources, 430 macros
[0m09:12:37.688171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a43a06af-9063-48fc-9002-08e76f38b0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3dec20>]}
[0m09:12:37.691748 [info ] [MainThread]: 
[0m09:12:37.693005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:12:37.693729 [info ] [MainThread]: 
[0m09:12:37.694858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:12:37.719685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m09:12:37.865000 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m09:12:37.865707 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m09:12:37.866207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:37.932139 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.066 seconds
[0m09:12:37.933735 [debug] [ThreadPool]: On list_dbt: Close
[0m09:12:37.934698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_dev)
[0m09:12:37.935550 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "dev"
"
[0m09:12:37.942250 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
[0m09:12:37.942694 [debug] [ThreadPool]: On create_dbt_dev: BEGIN
[0m09:12:37.943043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:37.960092 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m09:12:37.960565 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
[0m09:12:37.960933 [debug] [ThreadPool]: On create_dbt_dev: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_dbt_dev"} */
create schema if not exists "dev"
[0m09:12:37.962754 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m09:12:37.964251 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
[0m09:12:37.964697 [debug] [ThreadPool]: Using postgres connection "create_dbt_dev"
[0m09:12:37.965056 [debug] [ThreadPool]: On create_dbt_dev: COMMIT
[0m09:12:37.974752 [debug] [ThreadPool]: SQL status: COMMIT in 0.009 seconds
[0m09:12:37.975588 [debug] [ThreadPool]: On create_dbt_dev: Close
[0m09:12:37.978639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_dev, now list_dbt_dev)
[0m09:12:37.986505 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:12:37.986949 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m09:12:37.987295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:38.005276 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m09:12:38.005739 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:12:38.006134 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:12:38.010274 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m09:12:38.011616 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m09:12:38.012985 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m09:12:38.013791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_dev, now list_dbt_dev_data)
[0m09:12:38.017103 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m09:12:38.017588 [debug] [ThreadPool]: On list_dbt_dev_data: BEGIN
[0m09:12:38.017938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:38.035355 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m09:12:38.035812 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m09:12:38.036352 [debug] [ThreadPool]: On list_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev_data"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_data'
  
[0m09:12:38.040414 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m09:12:38.041842 [debug] [ThreadPool]: On list_dbt_dev_data: ROLLBACK
[0m09:12:38.043151 [debug] [ThreadPool]: On list_dbt_dev_data: Close
[0m09:12:38.050241 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:38.050681 [debug] [MainThread]: On master: BEGIN
[0m09:12:38.051024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:38.068926 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:12:38.069868 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:38.070362 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:12:38.075299 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m09:12:38.076722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a43a06af-9063-48fc-9002-08e76f38b0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3eae90>]}
[0m09:12:38.077677 [debug] [MainThread]: On master: ROLLBACK
[0m09:12:38.079339 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:38.079786 [debug] [MainThread]: On master: BEGIN
[0m09:12:38.082347 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m09:12:38.082805 [debug] [MainThread]: On master: COMMIT
[0m09:12:38.083217 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:38.083608 [debug] [MainThread]: On master: COMMIT
[0m09:12:38.084926 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:12:38.085489 [debug] [MainThread]: On master: Close
[0m09:12:38.087247 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m09:12:38.087938 [info ] [Thread-1 (]: 1 of 6 START sql view model dev.stg_customers .................................. [RUN]
[0m09:12:38.088884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev_data, now model.jaffle_shop.stg_customers)
[0m09:12:38.089617 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m09:12:38.102951 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m09:12:38.107726 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m09:12:38.157091 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m09:12:38.158716 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:12:38.159230 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m09:12:38.159650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:38.179949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m09:12:38.180720 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:12:38.181267 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m09:12:38.198735 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m09:12:38.207143 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:12:38.207967 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m09:12:38.211727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:12:38.228756 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:12:38.229279 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:12:38.229704 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m09:12:38.232318 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:38.240077 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m09:12:38.245194 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m09:12:38.245704 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m09:12:38.249299 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:12:38.252265 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m09:12:38.255626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43a06af-9063-48fc-9002-08e76f38b0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b93f400>]}
[0m09:12:38.257125 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m09:12:38.258218 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m09:12:38.258747 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m09:12:38.259303 [info ] [Thread-1 (]: 2 of 6 START sql view model dev.stg_orders ..................................... [RUN]
[0m09:12:38.260032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m09:12:38.260536 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m09:12:38.265610 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m09:12:38.266693 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m09:12:38.275529 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m09:12:38.276592 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:12:38.277060 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m09:12:38.277647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:38.298647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m09:12:38.299538 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:12:38.300551 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m09:12:38.303506 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:12:38.307857 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:12:38.308383 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m09:12:38.311468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:12:38.313219 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:12:38.314102 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:12:38.314669 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m09:12:38.317413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:38.372262 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m09:12:38.373328 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m09:12:38.373924 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m09:12:38.376225 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:12:38.378310 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m09:12:38.379276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43a06af-9063-48fc-9002-08e76f38b0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba86950>]}
[0m09:12:38.380603 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.12s]
[0m09:12:38.381763 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m09:12:38.382864 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m09:12:38.383783 [info ] [Thread-1 (]: 3 of 6 START sql view model dev.stg_payments ................................... [RUN]
[0m09:12:38.384572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m09:12:38.385101 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m09:12:38.394999 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m09:12:38.396175 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m09:12:38.400396 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m09:12:38.401901 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:12:38.402674 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m09:12:38.403177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:38.427191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m09:12:38.427819 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:12:38.428326 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    
    (amount / 100)::numeric(16, 2)
 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m09:12:38.433950 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:12:38.438072 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:12:38.438579 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m09:12:38.441002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:12:38.442693 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m09:12:38.443344 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:12:38.443816 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m09:12:38.446380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:38.449274 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m09:12:38.450081 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m09:12:38.450560 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m09:12:38.452197 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:38.453849 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m09:12:38.454891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43a06af-9063-48fc-9002-08e76f38b0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b39ba60>]}
[0m09:12:38.455860 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m09:12:38.457145 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m09:12:38.458505 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m09:12:38.459137 [info ] [Thread-1 (]: 4 of 6 START sql view model dev.fct_orders ..................................... [RUN]
[0m09:12:38.459948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m09:12:38.460554 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m09:12:38.466194 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m09:12:38.470078 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m09:12:38.477679 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m09:12:38.478915 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:12:38.479462 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m09:12:38.480187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:38.504692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m09:12:38.505508 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:12:38.506004 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  create view "dbt"."dev"."fct_orders__dbt_tmp"
    
    
  as (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
[0m09:12:38.513981 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:12:38.520297 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:12:38.520841 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m09:12:38.523225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:12:38.525441 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m09:12:38.525985 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:12:38.526511 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m09:12:38.528994 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:38.531894 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m09:12:38.532998 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m09:12:38.533645 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop view if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m09:12:38.535512 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:38.537237 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m09:12:38.538346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43a06af-9063-48fc-9002-08e76f38b0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b53cd00>]}
[0m09:12:38.539605 [info ] [Thread-1 (]: 4 of 6 OK created sql view model dev.fct_orders ................................ [[32mCREATE VIEW[0m in 0.08s]
[0m09:12:38.542329 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m09:12:38.544006 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m09:12:38.544879 [info ] [Thread-1 (]: 5 of 6 START sql view model dev.order_payment_method_amounts ................... [RUN]
[0m09:12:38.545720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m09:12:38.546302 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m09:12:38.553512 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m09:12:38.561165 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m09:12:38.567477 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m09:12:38.569263 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m09:12:38.569913 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m09:12:38.570421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:38.590915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m09:12:38.591511 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m09:12:38.591973 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  create view "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
    
    
  as (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
[0m09:12:38.595379 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:12:38.599613 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m09:12:38.600130 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m09:12:38.601938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:38.603487 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m09:12:38.603951 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m09:12:38.604375 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m09:12:38.607080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:38.610183 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m09:12:38.610981 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m09:12:38.611468 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop view if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m09:12:38.613430 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:38.616937 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m09:12:38.618299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43a06af-9063-48fc-9002-08e76f38b0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab81450>]}
[0m09:12:38.621044 [info ] [Thread-1 (]: 5 of 6 OK created sql view model dev.order_payment_method_amounts .............. [[32mCREATE VIEW[0m in 0.07s]
[0m09:12:38.622798 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m09:12:38.624032 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m09:12:38.625339 [info ] [Thread-1 (]: 6 of 6 START sql view model dev.dim_customers .................................. [RUN]
[0m09:12:38.627129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.dim_customers)
[0m09:12:38.628120 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m09:12:38.637533 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m09:12:38.640278 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m09:12:38.651969 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m09:12:38.653487 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:12:38.654319 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m09:12:38.655691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:38.692515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m09:12:38.693470 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:12:38.694268 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  create view "dbt"."dev"."dim_customers__dbt_tmp"
    
    
  as (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
[0m09:12:38.702234 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:12:38.707305 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:12:38.707967 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m09:12:38.710665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:12:38.712480 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m09:12:38.712972 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:12:38.713446 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m09:12:38.716139 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:38.719163 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m09:12:38.720067 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m09:12:38.720584 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m09:12:38.722224 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:12:38.723893 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m09:12:38.724969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43a06af-9063-48fc-9002-08e76f38b0d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4a14b0>]}
[0m09:12:38.726129 [info ] [Thread-1 (]: 6 of 6 OK created sql view model dev.dim_customers ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m09:12:38.727453 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m09:12:38.729090 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:38.729615 [debug] [MainThread]: On master: BEGIN
[0m09:12:38.729976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:12:38.758691 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m09:12:38.759313 [debug] [MainThread]: On master: COMMIT
[0m09:12:38.759745 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:38.760128 [debug] [MainThread]: On master: COMMIT
[0m09:12:38.763337 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:12:38.763851 [debug] [MainThread]: On master: Close
[0m09:12:38.764927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:38.766208 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m09:12:38.767549 [info ] [MainThread]: 
[0m09:12:38.768977 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m09:12:38.771085 [debug] [MainThread]: Command end result
[0m09:12:38.813759 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m09:12:38.816837 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m09:12:38.835291 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/run_results.json
[0m09:12:38.836051 [info ] [MainThread]: 
[0m09:12:38.837163 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:12:38.838200 [info ] [MainThread]: 
[0m09:12:38.839034 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:12:38.850485 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6080441, "process_in_blocks": "0", "process_kernel_time": 0.732647, "process_mem_max_rss": "110718976", "process_out_blocks": "0", "process_user_time": 3.448556}
[0m09:12:38.851698 [debug] [MainThread]: Command `dbt run` succeeded at 09:12:38.851461 after 2.61 seconds
[0m09:12:38.853496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d2830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba514b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba51f00>]}
[0m09:12:38.854398 [debug] [MainThread]: Flushing usage events
[0m09:12:39.703135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:12:44.229945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057367d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106640a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106640370>]}


============================== 09:12:44.234760 | 12a6d58a-aa79-4834-be47-4ca6419f7ccf ==============================
[0m09:12:44.234760 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:12:44.235591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/juanmontoliuarrando/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:12:44.236106 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m09:12:44.236546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '12a6d58a-aa79-4834-be47-4ca6419f7ccf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647d4b0>]}
[0m09:12:44.449807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12a6d58a-aa79-4834-be47-4ca6419f7ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b25150>]}
[0m09:12:44.519355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12a6d58a-aa79-4834-be47-4ca6419f7ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d60e0>]}
[0m09:12:44.520315 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:12:44.718370 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:12:45.026442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:12:45.026964 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:12:45.114925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12a6d58a-aa79-4834-be47-4ca6419f7ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107549630>]}
[0m09:12:45.261506 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m09:12:45.265757 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m09:12:45.377840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12a6d58a-aa79-4834-be47-4ca6419f7ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107585210>]}
[0m09:12:45.378580 [info ] [MainThread]: Found 6 models, 5 data tests, 3 seeds, 3 sources, 430 macros
[0m09:12:45.379292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12a6d58a-aa79-4834-be47-4ca6419f7ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105252650>]}
[0m09:12:45.382541 [info ] [MainThread]: 
[0m09:12:45.383591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:12:45.384269 [info ] [MainThread]: 
[0m09:12:45.389572 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:12:45.399589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_dev'
[0m09:12:45.479108 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:12:45.479634 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m09:12:45.480031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:45.517493 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m09:12:45.517973 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m09:12:45.518464 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m09:12:45.525142 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m09:12:45.526750 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m09:12:45.528296 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m09:12:45.529147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_dev, now list_dbt_dev_data)
[0m09:12:45.532429 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m09:12:45.534179 [debug] [ThreadPool]: On list_dbt_dev_data: BEGIN
[0m09:12:45.534529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:45.555212 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m09:12:45.555688 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m09:12:45.556168 [debug] [ThreadPool]: On list_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev_data"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_data'
  
[0m09:12:45.560210 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m09:12:45.561648 [debug] [ThreadPool]: On list_dbt_dev_data: ROLLBACK
[0m09:12:45.563036 [debug] [ThreadPool]: On list_dbt_dev_data: Close
[0m09:12:45.570156 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:45.570655 [debug] [MainThread]: On master: BEGIN
[0m09:12:45.571000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:45.589221 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:12:45.590240 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:45.590791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:12:45.605372 [debug] [MainThread]: SQL status: SELECT 8 in 0.014 seconds
[0m09:12:45.608889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12a6d58a-aa79-4834-be47-4ca6419f7ccf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107587b80>]}
[0m09:12:45.609448 [debug] [MainThread]: On master: ROLLBACK
[0m09:12:45.610903 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:45.611459 [debug] [MainThread]: On master: BEGIN
[0m09:12:45.613827 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m09:12:45.614327 [debug] [MainThread]: On master: COMMIT
[0m09:12:45.614700 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:45.615049 [debug] [MainThread]: On master: COMMIT
[0m09:12:45.616413 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:12:45.616863 [debug] [MainThread]: On master: Close
[0m09:12:45.618903 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:12:45.619522 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [RUN]
[0m09:12:45.620554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev_data, now test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1)
[0m09:12:45.621249 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:12:45.648375 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:12:45.650553 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:12:45.672718 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:12:45.674398 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:12:45.675021 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: BEGIN
[0m09:12:45.675458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:45.695340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m09:12:45.695910 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"
[0m09:12:45.696388 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt"."dev"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','shipped','returned','return_pending','placed'
)



      
    ) dbt_internal_test
[0m09:12:45.699203 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:12:45.704290 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: ROLLBACK
[0m09:12:45.705779 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1: Close
[0m09:12:45.706803 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed  [[32mPASS[0m in 0.09s]
[0m09:12:45.707905 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1
[0m09:12:45.708501 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:12:45.709218 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m09:12:45.710123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__completed__shipped__returned__return_pending__placed.89a0a7d5f1, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m09:12:45.710611 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:12:45.723022 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:12:45.723965 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:12:45.732394 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:12:45.733953 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:12:45.734619 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m09:12:45.735202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:45.755451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m09:12:45.755975 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:12:45.756530 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt"."dev"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m09:12:45.759811 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:12:45.761554 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m09:12:45.762954 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m09:12:45.764280 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.05s]
[0m09:12:45.765839 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m09:12:45.766894 [debug] [Thread-1 (]: Began running node test.jaffle_shop.positive_total_payments
[0m09:12:45.767830 [info ] [Thread-1 (]: 3 of 5 START test positive_total_payments ...................................... [RUN]
[0m09:12:45.769686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.positive_total_payments)
[0m09:12:45.770598 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.positive_total_payments
[0m09:12:45.774403 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.positive_total_payments"
[0m09:12:45.775550 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.positive_total_payments
[0m09:12:45.780569 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.positive_total_payments"
[0m09:12:45.781513 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.positive_total_payments"
[0m09:12:45.781978 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: BEGIN
[0m09:12:45.782505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:45.804837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m09:12:45.805825 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.positive_total_payments"
[0m09:12:45.806445 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.positive_total_payments"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with payments as (
    select
        *
    from
        "dbt"."dev"."stg_payments"
),

test_data as (
    select
        order_id,
        sum(amount) as total_amount
    from payments
    group by order_id
)

select *
from
    test_data
where
    total_amount < 0
      
    ) dbt_internal_test
[0m09:12:45.809830 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:12:45.811516 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: ROLLBACK
[0m09:12:45.813538 [debug] [Thread-1 (]: On test.jaffle_shop.positive_total_payments: Close
[0m09:12:45.815083 [info ] [Thread-1 (]: 3 of 5 PASS positive_total_payments ............................................ [[32mPASS[0m in 0.05s]
[0m09:12:45.816063 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.positive_total_payments
[0m09:12:45.816639 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:12:45.817409 [info ] [Thread-1 (]: 4 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m09:12:45.818499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.positive_total_payments, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m09:12:45.819013 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:12:45.834151 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:12:45.835536 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:12:45.892639 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:12:45.894445 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:12:45.895091 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m09:12:45.895651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:45.917640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m09:12:45.918266 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m09:12:45.918868 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt"."dev"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt"."dev"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:12:45.921977 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:12:45.923788 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m09:12:45.925434 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m09:12:45.926463 [info ] [Thread-1 (]: 4 of 5 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.11s]
[0m09:12:45.927649 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m09:12:45.928223 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:12:45.928902 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m09:12:45.929893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m09:12:45.930432 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:12:45.942038 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:12:45.943072 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:12:45.945920 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:12:45.946787 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:12:45.947256 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m09:12:45.947682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:45.969897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m09:12:45.970533 [debug] [Thread-1 (]: Using postgres connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m09:12:45.971022 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt"."dev"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:12:45.973522 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:12:45.975405 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m09:12:45.977004 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m09:12:45.978016 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.05s]
[0m09:12:45.979163 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m09:12:45.980898 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:45.981357 [debug] [MainThread]: On master: BEGIN
[0m09:12:45.981721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:12:46.001237 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m09:12:46.002820 [debug] [MainThread]: On master: COMMIT
[0m09:12:46.003741 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:46.004136 [debug] [MainThread]: On master: COMMIT
[0m09:12:46.005543 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:12:46.005999 [debug] [MainThread]: On master: Close
[0m09:12:46.006627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:46.007366 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m09:12:46.008069 [info ] [MainThread]: 
[0m09:12:46.008729 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m09:12:46.011848 [debug] [MainThread]: Command end result
[0m09:12:46.051573 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m09:12:46.054616 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m09:12:46.071679 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/run_results.json
[0m09:12:46.072386 [info ] [MainThread]: 
[0m09:12:46.073194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:12:46.074037 [info ] [MainThread]: 
[0m09:12:46.074866 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:12:46.077243 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.930873, "process_in_blocks": "0", "process_kernel_time": 0.479706, "process_mem_max_rss": "112930816", "process_out_blocks": "0", "process_user_time": 2.859199}
[0m09:12:46.078347 [debug] [MainThread]: Command `dbt test` succeeded at 09:12:46.078132 after 1.93 seconds
[0m09:12:46.079776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057367d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b60040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b60100>]}
[0m09:12:46.080642 [debug] [MainThread]: Flushing usage events
[0m09:12:46.538083 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:27:42.944327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10875a800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109666500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109665e10>]}


============================== 10:27:42.951761 | 5b470f97-6e11-4c7e-8aa7-77ea060dcb11 ==============================
[0m10:27:42.951761 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:27:42.952770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/juanmontoliuarrando/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:27:42.953321 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m10:27:42.953813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ce350>]}
[0m10:27:43.219192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b449d0>]}
[0m10:27:43.289635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109665c00>]}
[0m10:27:43.292315 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:27:43.503331 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:27:43.797560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:27:43.798023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:27:43.884458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a571a80>]}
[0m10:27:44.031181 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m10:27:44.046052 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m10:27:44.145975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a58a110>]}
[0m10:27:44.146664 [info ] [MainThread]: Found 7 models, 5 data tests, 3 seeds, 3 sources, 430 macros
[0m10:27:44.147365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a58add0>]}
[0m10:27:44.149615 [info ] [MainThread]: 
[0m10:27:44.150291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:27:44.150815 [info ] [MainThread]: 
[0m10:27:44.151553 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:27:44.161766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m10:27:44.316104 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m10:27:44.316630 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m10:27:44.317030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:44.479497 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.162 seconds
[0m10:27:44.481374 [debug] [ThreadPool]: On list_dbt: Close
[0m10:27:44.484727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m10:27:44.493353 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:27:44.493798 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m10:27:44.494145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:44.511934 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m10:27:44.512392 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:27:44.512835 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:27:44.517076 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m10:27:44.518720 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m10:27:44.520273 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m10:27:44.521091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_dev, now list_dbt_dev_data)
[0m10:27:44.525410 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m10:27:44.525837 [debug] [ThreadPool]: On list_dbt_dev_data: BEGIN
[0m10:27:44.526177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:44.544029 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m10:27:44.544528 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m10:27:44.545006 [debug] [ThreadPool]: On list_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev_data"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_data'
  
[0m10:27:44.549042 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m10:27:44.550517 [debug] [ThreadPool]: On list_dbt_dev_data: ROLLBACK
[0m10:27:44.552088 [debug] [ThreadPool]: On list_dbt_dev_data: Close
[0m10:27:44.558864 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:44.559301 [debug] [MainThread]: On master: BEGIN
[0m10:27:44.559648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:44.576750 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m10:27:44.577204 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:44.577757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:27:44.584050 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m10:27:44.587240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c3c1c0>]}
[0m10:27:44.587837 [debug] [MainThread]: On master: ROLLBACK
[0m10:27:44.589368 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:44.589813 [debug] [MainThread]: On master: BEGIN
[0m10:27:44.592073 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:27:44.592580 [debug] [MainThread]: On master: COMMIT
[0m10:27:44.592958 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:44.593310 [debug] [MainThread]: On master: COMMIT
[0m10:27:44.594758 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:27:44.595212 [debug] [MainThread]: On master: Close
[0m10:27:44.597227 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m10:27:44.597967 [info ] [Thread-1 (]: 1 of 7 START sql view model dev.stg_customers .................................. [RUN]
[0m10:27:44.599083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev_data, now model.jaffle_shop.stg_customers)
[0m10:27:44.599586 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m10:27:44.611607 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m10:27:44.614732 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m10:27:44.661595 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m10:27:44.662560 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:27:44.663013 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m10:27:44.663417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:44.683481 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m10:27:44.684009 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:27:44.684453 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m10:27:44.688544 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:27:44.696204 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:27:44.696713 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m10:27:44.698390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:27:44.701784 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:27:44.702239 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m10:27:44.705226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:27:44.723980 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:27:44.724488 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:27:44.724910 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:27:44.729075 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:27:44.736599 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m10:27:44.741540 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:27:44.742035 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m10:27:44.756451 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.014 seconds
[0m10:27:44.759634 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m10:27:44.762784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e55d0>]}
[0m10:27:44.763710 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m10:27:44.765120 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m10:27:44.765693 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m10:27:44.766259 [info ] [Thread-1 (]: 2 of 7 START sql view model dev.stg_orders ..................................... [RUN]
[0m10:27:44.766935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m10:27:44.767386 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m10:27:44.771875 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m10:27:44.773048 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m10:27:44.780016 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m10:27:44.780914 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:27:44.781355 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m10:27:44.781799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:44.800453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m10:27:44.801000 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:27:44.801435 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m10:27:44.803908 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:27:44.810886 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:27:44.811397 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m10:27:44.814710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:27:44.867676 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:27:44.868350 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:27:44.872137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:27:44.874210 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:27:44.874823 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:27:44.875372 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:27:44.878488 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:27:44.882041 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m10:27:44.882841 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:27:44.883332 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m10:27:44.888267 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:27:44.889995 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m10:27:44.890946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e55d0>]}
[0m10:27:44.892047 [info ] [Thread-1 (]: 2 of 7 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.12s]
[0m10:27:44.893181 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m10:27:44.893988 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m10:27:44.895011 [info ] [Thread-1 (]: 3 of 7 START sql view model dev.stg_payments ................................... [RUN]
[0m10:27:44.895736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m10:27:44.896230 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m10:27:44.902558 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m10:27:44.906991 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m10:27:44.911603 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m10:27:44.912556 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:27:44.913077 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m10:27:44.913626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:44.934906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m10:27:44.935536 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:27:44.936022 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    
    (amount / 100)::numeric(16, 2)
 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m10:27:44.939374 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:27:44.943451 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:27:44.943942 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m10:27:44.945810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:27:44.949902 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:27:44.950454 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m10:27:44.952319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:27:44.954009 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:27:44.954488 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:27:44.954982 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:27:44.957459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:27:44.960361 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m10:27:44.962485 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:27:44.962982 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m10:27:44.966836 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:27:44.968481 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m10:27:44.969324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab12710>]}
[0m10:27:44.970274 [info ] [Thread-1 (]: 3 of 7 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m10:27:44.971379 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m10:27:44.973370 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m10:27:44.974051 [info ] [Thread-1 (]: 4 of 7 START sql view model dev.fct_orders ..................................... [RUN]
[0m10:27:44.974805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m10:27:44.975274 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m10:27:44.980813 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m10:27:44.982981 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m10:27:44.987199 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m10:27:44.988093 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:27:44.988771 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m10:27:44.990359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:45.012972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m10:27:45.013765 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:27:45.014549 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  create view "dbt"."dev"."fct_orders__dbt_tmp"
    
    
  as (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
[0m10:27:45.019092 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:27:45.023409 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:27:45.024117 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m10:27:45.026429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:27:45.028656 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:27:45.029213 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:27:45.029778 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:27:45.033954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:27:45.037190 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m10:27:45.037950 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:27:45.038524 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop view if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m10:27:45.040282 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:27:45.041901 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m10:27:45.042735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966bb20>]}
[0m10:27:45.043693 [info ] [Thread-1 (]: 4 of 7 OK created sql view model dev.fct_orders ................................ [[32mCREATE VIEW[0m in 0.07s]
[0m10:27:45.044831 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m10:27:45.045732 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m10:27:45.046612 [info ] [Thread-1 (]: 5 of 7 START sql view model dev.order_payment_method_amounts ................... [RUN]
[0m10:27:45.047442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m10:27:45.047973 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m10:27:45.056974 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:27:45.058102 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m10:27:45.062393 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:27:45.063321 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:27:45.063787 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m10:27:45.064219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:45.083472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:27:45.084002 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:27:45.084479 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  create view "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
    
    
  as (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
[0m10:27:45.089314 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:27:45.094600 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:27:45.095103 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m10:27:45.096958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:27:45.098500 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:27:45.098962 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:27:45.099381 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:27:45.101754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:27:45.104596 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m10:27:45.105389 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:27:45.105947 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop view if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m10:27:45.107531 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:27:45.109198 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m10:27:45.110135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab55450>]}
[0m10:27:45.111096 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dev.order_payment_method_amounts .............. [[32mCREATE VIEW[0m in 0.06s]
[0m10:27:45.112081 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m10:27:45.112913 [debug] [Thread-1 (]: Began running node model.jaffle_shop.rep_payment_method_status
[0m10:27:45.113597 [info ] [Thread-1 (]: 6 of 7 START sql view model dev.rep_payment_method_status ...................... [RUN]
[0m10:27:45.114313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.rep_payment_method_status)
[0m10:27:45.114855 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.rep_payment_method_status
[0m10:27:45.120691 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.rep_payment_method_status"
[0m10:27:45.124301 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.rep_payment_method_status
[0m10:27:45.129367 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.rep_payment_method_status"
[0m10:27:45.130311 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:27:45.130780 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: BEGIN
[0m10:27:45.131209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:45.155559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m10:27:45.156213 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:27:45.156680 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */

  create view "dbt"."dev"."rep_payment_method_status__dbt_tmp"
    
    
  as (
    with payment_status as (

    select
        payment_method,
        -- Calcula el total de pagos exitosos
        sum(case when status = 'success' then amount else 0 end) as success,
        -- Calcula el total de pagos fallidos
        sum(case when status = 'failed' then amount else 0 end) as failed
    from "dbt"."dev"."stg_payments"  -- Hace referencia a la tabla de pagos en staging
    group by payment_method

)

select * from payment_status
  );
[0m10:27:45.159839 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:27:45.163552 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:27:45.164070 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */
alter table "dbt"."dev"."rep_payment_method_status__dbt_tmp" rename to "rep_payment_method_status"
[0m10:27:45.166742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:27:45.168686 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: COMMIT
[0m10:27:45.169193 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:27:45.169642 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: COMMIT
[0m10:27:45.171979 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:27:45.174962 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."rep_payment_method_status__dbt_backup"
[0m10:27:45.175756 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:27:45.176199 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */
drop view if exists "dbt"."dev"."rep_payment_method_status__dbt_backup" cascade
[0m10:27:45.179071 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:27:45.180834 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: Close
[0m10:27:45.181625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab55450>]}
[0m10:27:45.182685 [info ] [Thread-1 (]: 6 of 7 OK created sql view model dev.rep_payment_method_status ................. [[32mCREATE VIEW[0m in 0.07s]
[0m10:27:45.183660 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.rep_payment_method_status
[0m10:27:45.184361 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m10:27:45.185448 [info ] [Thread-1 (]: 7 of 7 START sql view model dev.dim_customers .................................. [RUN]
[0m10:27:45.186059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.rep_payment_method_status, now model.jaffle_shop.dim_customers)
[0m10:27:45.186508 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m10:27:45.192768 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m10:27:45.193693 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m10:27:45.199905 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m10:27:45.200995 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:27:45.201714 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m10:27:45.202458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:45.225658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m10:27:45.226287 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:27:45.226889 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  create view "dbt"."dev"."dim_customers__dbt_tmp"
    
    
  as (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
[0m10:27:45.233543 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:27:45.237433 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:27:45.237917 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m10:27:45.239871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:27:45.242121 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:27:45.242762 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:27:45.243210 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:27:45.247248 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:27:45.250252 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m10:27:45.250989 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:27:45.251433 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m10:27:45.253105 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:27:45.254932 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m10:27:45.255774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b470f97-6e11-4c7e-8aa7-77ea060dcb11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab12710>]}
[0m10:27:45.256845 [info ] [Thread-1 (]: 7 of 7 OK created sql view model dev.dim_customers ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m10:27:45.257968 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m10:27:45.259752 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.260193 [debug] [MainThread]: On master: BEGIN
[0m10:27:45.260646 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:27:45.284781 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m10:27:45.285311 [debug] [MainThread]: On master: COMMIT
[0m10:27:45.285897 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.286297 [debug] [MainThread]: On master: COMMIT
[0m10:27:45.287815 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:27:45.288255 [debug] [MainThread]: On master: Close
[0m10:27:45.289117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:45.289749 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m10:27:45.290246 [info ] [MainThread]: 
[0m10:27:45.290895 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m10:27:45.293641 [debug] [MainThread]: Command end result
[0m10:27:45.330262 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m10:27:45.333694 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m10:27:45.345955 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/run_results.json
[0m10:27:45.346676 [info ] [MainThread]: 
[0m10:27:45.347658 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:27:45.348611 [info ] [MainThread]: 
[0m10:27:45.349360 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m10:27:45.395471 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5510824, "process_in_blocks": "0", "process_kernel_time": 0.827466, "process_mem_max_rss": "111501312", "process_out_blocks": "0", "process_user_time": 3.343304}
[0m10:27:45.396240 [debug] [MainThread]: Command `dbt run` succeeded at 10:27:45.396114 after 2.55 seconds
[0m10:27:45.396702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10875a800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b50c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd5510>]}
[0m10:27:45.397261 [debug] [MainThread]: Flushing usage events
[0m10:27:46.359086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:47:36.496058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6e770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d473d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d47ac0>]}


============================== 10:47:36.508126 | f2e80892-29b6-457b-bdee-7ec5231bc736 ==============================
[0m10:47:36.508126 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:47:36.509179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/logs', 'profiles_dir': '/Users/juanmontoliuarrando/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:47:36.509810 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m10:47:36.510592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918b610>]}
[0m10:47:36.804363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21fa90>]}
[0m10:47:36.882433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d45930>]}
[0m10:47:36.885102 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:47:37.118067 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:47:37.337462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:47:37.337921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:47:37.429091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac62080>]}
[0m10:47:37.589625 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m10:47:37.595473 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m10:47:37.678768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac905e0>]}
[0m10:47:37.679452 [info ] [MainThread]: Found 8 models, 5 data tests, 3 seeds, 3 sources, 430 macros
[0m10:47:37.680148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac904f0>]}
[0m10:47:37.682429 [info ] [MainThread]: 
[0m10:47:37.684471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:47:37.685616 [info ] [MainThread]: 
[0m10:47:37.686426 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:47:37.697680 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m10:47:37.809683 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m10:47:37.810330 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m10:47:37.810831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:37.914721 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.104 seconds
[0m10:47:37.916235 [debug] [ThreadPool]: On list_dbt: Close
[0m10:47:37.918596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m10:47:37.925948 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:47:37.926412 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m10:47:37.926761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:37.946018 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m10:47:37.946488 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:47:37.946881 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:47:37.951115 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m10:47:37.952704 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m10:47:37.954301 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m10:47:37.955246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_dev, now list_dbt_dev_data)
[0m10:47:37.959683 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m10:47:37.960288 [debug] [ThreadPool]: On list_dbt_dev_data: BEGIN
[0m10:47:37.960768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:37.980001 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m10:47:37.980497 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m10:47:37.980889 [debug] [ThreadPool]: On list_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev_data"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_data'
  
[0m10:47:37.986054 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m10:47:37.987491 [debug] [ThreadPool]: On list_dbt_dev_data: ROLLBACK
[0m10:47:37.989054 [debug] [ThreadPool]: On list_dbt_dev_data: Close
[0m10:47:37.995785 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:37.996228 [debug] [MainThread]: On master: BEGIN
[0m10:47:37.996575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:47:38.015579 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m10:47:38.016108 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:38.016573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:47:38.024496 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m10:47:38.028285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac62a70>]}
[0m10:47:38.028863 [debug] [MainThread]: On master: ROLLBACK
[0m10:47:38.030563 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:38.031062 [debug] [MainThread]: On master: BEGIN
[0m10:47:38.034377 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m10:47:38.034845 [debug] [MainThread]: On master: COMMIT
[0m10:47:38.035268 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:38.035626 [debug] [MainThread]: On master: COMMIT
[0m10:47:38.037139 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:47:38.037605 [debug] [MainThread]: On master: Close
[0m10:47:38.039659 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m10:47:38.040376 [info ] [Thread-1 (]: 1 of 8 START sql view model dev.stg_customers .................................. [RUN]
[0m10:47:38.041437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev_data, now model.jaffle_shop.stg_customers)
[0m10:47:38.042029 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m10:47:38.055413 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m10:47:38.057310 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m10:47:38.104096 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m10:47:38.107642 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:47:38.108345 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m10:47:38.108897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:38.128052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:47:38.128571 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:47:38.129070 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m10:47:38.141705 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m10:47:38.150005 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:47:38.150729 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m10:47:38.152568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:47:38.156013 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:47:38.156611 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m10:47:38.158588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:47:38.177157 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:47:38.177675 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:47:38.178097 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:47:38.182668 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:47:38.190276 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m10:47:38.195095 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:47:38.195596 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m10:47:38.201059 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m10:47:38.204012 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m10:47:38.206802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac63160>]}
[0m10:47:38.207969 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m10:47:38.208770 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m10:47:38.209278 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m10:47:38.209835 [info ] [Thread-1 (]: 2 of 8 START sql view model dev.stg_orders ..................................... [RUN]
[0m10:47:38.210592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m10:47:38.211059 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m10:47:38.214303 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m10:47:38.216454 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m10:47:38.223430 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m10:47:38.224685 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:47:38.225299 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m10:47:38.226128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:38.247831 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m10:47:38.248454 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:47:38.248896 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m10:47:38.252004 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:47:38.257217 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:47:38.257756 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m10:47:38.259624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:47:38.314915 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:47:38.315782 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:47:38.318267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:47:38.321026 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:47:38.321589 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:47:38.322089 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:47:38.326797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:47:38.331835 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m10:47:38.333035 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:47:38.333614 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m10:47:38.337477 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:47:38.339355 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m10:47:38.340199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d00760>]}
[0m10:47:38.341363 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m10:47:38.342405 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m10:47:38.343235 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m10:47:38.344050 [info ] [Thread-1 (]: 3 of 8 START sql view model dev.stg_payments ................................... [RUN]
[0m10:47:38.344865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m10:47:38.345391 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m10:47:38.351644 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m10:47:38.355313 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m10:47:38.360215 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m10:47:38.361404 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:47:38.362230 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m10:47:38.362861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:38.384538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m10:47:38.385179 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:47:38.385658 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    
    (amount / 100)::numeric(16, 2)
 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m10:47:38.388837 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:47:38.393475 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:47:38.394019 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m10:47:38.396009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:47:38.399879 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:47:38.400984 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m10:47:38.402788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:47:38.404467 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:47:38.404966 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:47:38.405414 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:47:38.408484 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:47:38.411576 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m10:47:38.413717 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:47:38.414222 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m10:47:38.418289 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:47:38.420156 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m10:47:38.420948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d00760>]}
[0m10:47:38.421940 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.08s]
[0m10:47:38.423066 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m10:47:38.423815 [debug] [Thread-1 (]: Began running node model.jaffle_shop.rep_returned_orders
[0m10:47:38.424963 [info ] [Thread-1 (]: 4 of 8 START sql view model dev.rep_returned_orders ............................ [RUN]
[0m10:47:38.425772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.rep_returned_orders)
[0m10:47:38.426323 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.rep_returned_orders
[0m10:47:38.432299 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.rep_returned_orders"
[0m10:47:38.434642 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.rep_returned_orders
[0m10:47:38.438894 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.rep_returned_orders"
[0m10:47:38.439965 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_returned_orders"
[0m10:47:38.440445 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: BEGIN
[0m10:47:38.440880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:38.464787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m10:47:38.465432 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_returned_orders"
[0m10:47:38.465915 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_returned_orders"} */

  create view "dbt"."dev"."rep_returned_orders__dbt_tmp"
    
    
  as (
    -- rep_returned_orders.sql

with orders as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        amount
    from "dbt"."dev"."stg_orders"  -- Asegúrate de que 'stg_orders' es el nombre correcto de la tabla de órdenes
    where status = 'returned'  -- Solo seleccionamos las órdenes con el estado 'returned'
),

customers as (
    select
        id as customer_id,
        first_name,
        last_name
    from "dbt"."dev"."stg_customers"  -- Asegúrate de que 'stg_customers' es el nombre correcto de la tabla de clientes
)

select
    o.order_id,
    o.customer_id,
    o.order_date,
    o.status,
    c.first_name,
    c.last_name,
    o.amount
from orders o
join customers c on o.customer_id = c.customer_id  -- Unimos las tablas de órdenes y clientes por 'customer_id'
  );
[0m10:47:38.470858 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "amount" does not exist
LINE 15:         amount
                 ^

[0m10:47:38.471512 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: ROLLBACK
[0m10:47:38.473201 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: Close
[0m10:47:38.500892 [debug] [Thread-1 (]: Database Error in model rep_returned_orders (models/marts/rep_returned_orders.sql)
  column "amount" does not exist
  LINE 15:         amount
                   ^
  compiled code at target/run/jaffle_shop/models/marts/rep_returned_orders.sql
[0m10:47:38.501763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac79030>]}
[0m10:47:38.502569 [error] [Thread-1 (]: 4 of 8 ERROR creating sql view model dev.rep_returned_orders ................... [[31mERROR[0m in 0.08s]
[0m10:47:38.503391 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.rep_returned_orders
[0m10:47:38.503910 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m10:47:38.504495 [info ] [Thread-1 (]: 5 of 8 START sql view model dev.fct_orders ..................................... [RUN]
[0m10:47:38.505257 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.rep_returned_orders' to be skipped because of status 'error'.  Reason: Database Error in model rep_returned_orders (models/marts/rep_returned_orders.sql)
  column "amount" does not exist
  LINE 15:         amount
                   ^
  compiled code at target/run/jaffle_shop/models/marts/rep_returned_orders.sql.
[0m10:47:38.505805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.rep_returned_orders, now model.jaffle_shop.fct_orders)
[0m10:47:38.507002 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m10:47:38.512862 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m10:47:38.513703 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m10:47:38.519799 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m10:47:38.520741 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:47:38.521196 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m10:47:38.521602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:38.540363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:47:38.540959 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:47:38.541430 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  create view "dbt"."dev"."fct_orders__dbt_tmp"
    
    
  as (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
[0m10:47:38.545332 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:47:38.549085 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:47:38.549570 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m10:47:38.551607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:47:38.553451 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:47:38.553940 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:47:38.554493 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:47:38.556667 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:47:38.559506 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m10:47:38.560588 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:47:38.561166 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop view if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m10:47:38.562689 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:47:38.564279 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m10:47:38.565101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc7c10>]}
[0m10:47:38.565874 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dev.fct_orders ................................ [[32mCREATE VIEW[0m in 0.06s]
[0m10:47:38.567940 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m10:47:38.568630 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m10:47:38.569880 [info ] [Thread-1 (]: 6 of 8 START sql view model dev.order_payment_method_amounts ................... [RUN]
[0m10:47:38.570564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m10:47:38.571090 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m10:47:38.577401 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:47:38.579587 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m10:47:38.584025 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:47:38.586783 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:47:38.587355 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m10:47:38.587799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:38.611682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m10:47:38.612346 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:47:38.612839 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  create view "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
    
    
  as (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
[0m10:47:38.615988 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:47:38.620015 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:47:38.621350 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m10:47:38.623656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:47:38.625401 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:47:38.625936 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:47:38.626417 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:47:38.630003 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:47:38.633139 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m10:47:38.634223 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:47:38.634734 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop view if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m10:47:38.636543 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:47:38.638190 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m10:47:38.639015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc7c10>]}
[0m10:47:38.640102 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dev.order_payment_method_amounts .............. [[32mCREATE VIEW[0m in 0.07s]
[0m10:47:38.641508 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m10:47:38.642607 [debug] [Thread-1 (]: Began running node model.jaffle_shop.rep_payment_method_status
[0m10:47:38.643341 [info ] [Thread-1 (]: 7 of 8 START sql view model dev.rep_payment_method_status ...................... [RUN]
[0m10:47:38.644096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.rep_payment_method_status)
[0m10:47:38.644598 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.rep_payment_method_status
[0m10:47:38.648609 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.rep_payment_method_status"
[0m10:47:38.649879 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.rep_payment_method_status
[0m10:47:38.656510 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.rep_payment_method_status"
[0m10:47:38.657524 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:47:38.658729 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: BEGIN
[0m10:47:38.659273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:38.682392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m10:47:38.683532 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:47:38.684086 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */

  create view "dbt"."dev"."rep_payment_method_status__dbt_tmp"
    
    
  as (
    with payment_status as (

    select
        payment_method,
        -- Calcula el total de pagos exitosos
        sum(case when status = 'success' then amount else 0 end) as success,
        -- Calcula el total de pagos fallidos
        sum(case when status = 'failed' then amount else 0 end) as failed
    from "dbt"."dev"."stg_payments"  -- Hace referencia a la tabla de pagos en staging
    group by payment_method

)

select * from payment_status
  );
[0m10:47:38.687947 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:47:38.692618 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:47:38.693217 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */
alter table "dbt"."dev"."rep_payment_method_status__dbt_tmp" rename to "rep_payment_method_status"
[0m10:47:38.695353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:47:38.697005 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: COMMIT
[0m10:47:38.697528 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:47:38.698189 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: COMMIT
[0m10:47:38.702209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:47:38.707149 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."rep_payment_method_status__dbt_backup"
[0m10:47:38.708115 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:47:38.708613 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */
drop view if exists "dbt"."dev"."rep_payment_method_status__dbt_backup" cascade
[0m10:47:38.710371 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:47:38.712111 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: Close
[0m10:47:38.713082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b5f60>]}
[0m10:47:38.714410 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dev.rep_payment_method_status ................. [[32mCREATE VIEW[0m in 0.07s]
[0m10:47:38.715974 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.rep_payment_method_status
[0m10:47:38.717182 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m10:47:38.718322 [info ] [Thread-1 (]: 8 of 8 START sql view model dev.dim_customers .................................. [RUN]
[0m10:47:38.719200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.rep_payment_method_status, now model.jaffle_shop.dim_customers)
[0m10:47:38.719697 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m10:47:38.727831 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m10:47:38.728784 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m10:47:38.733213 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m10:47:38.735233 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:47:38.736315 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m10:47:38.736787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:38.763300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m10:47:38.763966 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:47:38.764577 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  create view "dbt"."dev"."dim_customers__dbt_tmp"
    
    
  as (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
[0m10:47:38.770195 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:47:38.774688 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:47:38.775236 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m10:47:38.777274 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:47:38.778862 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:47:38.779348 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:47:38.779775 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:47:38.782398 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:47:38.785327 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m10:47:38.786117 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:47:38.786558 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m10:47:38.788204 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:47:38.789763 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m10:47:38.790596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2e80892-29b6-457b-bdee-7ec5231bc736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc7c10>]}
[0m10:47:38.791793 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dev.dim_customers ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m10:47:38.793414 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m10:47:38.795703 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:38.796184 [debug] [MainThread]: On master: BEGIN
[0m10:47:38.796570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:47:38.822363 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m10:47:38.822904 [debug] [MainThread]: On master: COMMIT
[0m10:47:38.823424 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:38.823824 [debug] [MainThread]: On master: COMMIT
[0m10:47:38.825421 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:47:38.825899 [debug] [MainThread]: On master: Close
[0m10:47:38.826683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:38.827743 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m10:47:38.828615 [info ] [MainThread]: 
[0m10:47:38.829321 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m10:47:38.832133 [debug] [MainThread]: Command end result
[0m10:47:38.873430 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m10:47:38.876253 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m10:47:38.890846 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/run_results.json
[0m10:47:38.891423 [info ] [MainThread]: 
[0m10:47:38.891991 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:47:38.892425 [info ] [MainThread]: 
[0m10:47:38.892964 [error] [MainThread]:   Database Error in model rep_returned_orders (models/marts/rep_returned_orders.sql)
  column "amount" does not exist
  LINE 15:         amount
                   ^
  compiled code at target/run/jaffle_shop/models/marts/rep_returned_orders.sql
[0m10:47:38.893395 [info ] [MainThread]: 
[0m10:47:38.893833 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m10:47:38.897433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5164285, "process_in_blocks": "0", "process_kernel_time": 0.628471, "process_mem_max_rss": "112218112", "process_out_blocks": "0", "process_user_time": 3.313685}
[0m10:47:38.899787 [debug] [MainThread]: Command `dbt run` failed at 10:47:38.899518 after 2.52 seconds
[0m10:47:38.900618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6e770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac181c0>]}
[0m10:47:38.901260 [debug] [MainThread]: Flushing usage events
[0m10:47:39.544426 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:48:57.273678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9a6830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8b2500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8b1e10>]}


============================== 10:48:57.278609 | 6b64ffd5-3f6a-4105-a287-fcc853f91c72 ==============================
[0m10:48:57.278609 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:48:57.279298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/juanmontoliuarrando/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:48:57.279774 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m10:48:57.280269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e819f60>]}
[0m10:48:57.487717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed913c0>]}
[0m10:48:57.557977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8b1c00>]}
[0m10:48:57.558942 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:48:57.758024 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:48:57.965860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:48:57.966309 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:48:58.057913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7c2140>]}
[0m10:48:58.211428 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m10:48:58.214915 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m10:48:58.230983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edba500>]}
[0m10:48:58.231615 [info ] [MainThread]: Found 8 models, 5 data tests, 3 seeds, 3 sources, 430 macros
[0m10:48:58.232073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edb99c0>]}
[0m10:48:58.234297 [info ] [MainThread]: 
[0m10:48:58.234786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:48:58.235178 [info ] [MainThread]: 
[0m10:48:58.235783 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:48:58.245497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m10:48:58.332230 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m10:48:58.332774 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m10:48:58.333174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:58.399117 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.066 seconds
[0m10:48:58.400762 [debug] [ThreadPool]: On list_dbt: Close
[0m10:48:58.403350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m10:48:58.410581 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:48:58.411017 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m10:48:58.411369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:58.429028 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m10:48:58.429488 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:48:58.429954 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:48:58.433907 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m10:48:58.435441 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m10:48:58.436970 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m10:48:58.437834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_dev, now list_dbt_dev_data)
[0m10:48:58.440475 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m10:48:58.440983 [debug] [ThreadPool]: On list_dbt_dev_data: BEGIN
[0m10:48:58.441562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:58.459198 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m10:48:58.459716 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m10:48:58.460191 [debug] [ThreadPool]: On list_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev_data"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_data'
  
[0m10:48:58.464185 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m10:48:58.465727 [debug] [ThreadPool]: On list_dbt_dev_data: ROLLBACK
[0m10:48:58.467187 [debug] [ThreadPool]: On list_dbt_dev_data: Close
[0m10:48:58.474267 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:58.474726 [debug] [MainThread]: On master: BEGIN
[0m10:48:58.475080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:48:58.492921 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m10:48:58.493454 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:58.493952 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:48:58.499203 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m10:48:58.502603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7be680>]}
[0m10:48:58.503141 [debug] [MainThread]: On master: ROLLBACK
[0m10:48:58.504579 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:58.505054 [debug] [MainThread]: On master: BEGIN
[0m10:48:58.507192 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:48:58.507650 [debug] [MainThread]: On master: COMMIT
[0m10:48:58.508105 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:58.508460 [debug] [MainThread]: On master: COMMIT
[0m10:48:58.511052 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:48:58.511569 [debug] [MainThread]: On master: Close
[0m10:48:58.513568 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m10:48:58.514453 [info ] [Thread-1 (]: 1 of 8 START sql view model dev.stg_customers .................................. [RUN]
[0m10:48:58.515784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev_data, now model.jaffle_shop.stg_customers)
[0m10:48:58.516298 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m10:48:58.528474 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m10:48:58.529380 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m10:48:58.571913 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m10:48:58.572834 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:48:58.573321 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m10:48:58.573738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:58.593191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:48:58.593739 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:48:58.594246 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m10:48:58.596836 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:48:58.604394 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:48:58.604929 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m10:48:58.606719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:48:58.610184 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:48:58.610651 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m10:48:58.612371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:48:58.631294 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:48:58.631808 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:48:58.632230 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:48:58.635512 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:48:58.642988 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m10:48:58.647785 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:48:58.648283 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m10:48:58.651974 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:48:58.654913 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m10:48:58.657513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7bded0>]}
[0m10:48:58.658401 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.14s]
[0m10:48:58.659472 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m10:48:58.660258 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m10:48:58.661018 [info ] [Thread-1 (]: 2 of 8 START sql view model dev.stg_orders ..................................... [RUN]
[0m10:48:58.662208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m10:48:58.662696 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m10:48:58.667693 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m10:48:58.670987 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m10:48:58.676031 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m10:48:58.677022 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:48:58.677490 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m10:48:58.678084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:58.697231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:48:58.697859 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:48:58.698339 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m10:48:58.702809 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:48:58.708241 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:48:58.708805 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m10:48:58.710613 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:48:58.763561 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:48:58.764240 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:48:58.766640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:48:58.768718 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:48:58.769288 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:48:58.769801 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:48:58.772905 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:48:58.776352 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m10:48:58.777125 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:48:58.777615 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m10:48:58.781343 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:48:58.783082 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m10:48:58.783987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8315d0>]}
[0m10:48:58.784956 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.12s]
[0m10:48:58.786148 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m10:48:58.786858 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m10:48:58.787937 [info ] [Thread-1 (]: 3 of 8 START sql view model dev.stg_payments ................................... [RUN]
[0m10:48:58.789035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m10:48:58.789540 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m10:48:58.798025 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m10:48:58.799645 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m10:48:58.804956 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m10:48:58.805844 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:48:58.806307 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m10:48:58.806732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:58.827636 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m10:48:58.828282 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:48:58.828758 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    
    (amount / 100)::numeric(16, 2)
 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m10:48:58.831907 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:48:58.836201 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:48:58.836710 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m10:48:58.838563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:48:58.842264 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:48:58.842734 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m10:48:58.844608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:48:58.846271 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:48:58.846744 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:48:58.847153 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:48:58.850246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:48:58.853116 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m10:48:58.855193 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:48:58.855675 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m10:48:58.859175 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:48:58.860756 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m10:48:58.861699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7eb8e0>]}
[0m10:48:58.862906 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m10:48:58.863912 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m10:48:58.864760 [debug] [Thread-1 (]: Began running node model.jaffle_shop.rep_returned_orders
[0m10:48:58.865417 [info ] [Thread-1 (]: 4 of 8 START sql view model dev.rep_returned_orders ............................ [RUN]
[0m10:48:58.866050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.rep_returned_orders)
[0m10:48:58.866501 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.rep_returned_orders
[0m10:48:58.871785 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.rep_returned_orders"
[0m10:48:58.873346 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.rep_returned_orders
[0m10:48:58.877891 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.rep_returned_orders"
[0m10:48:58.878777 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_returned_orders"
[0m10:48:58.879225 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: BEGIN
[0m10:48:58.879644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:58.903129 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m10:48:58.903717 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_returned_orders"
[0m10:48:58.904409 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_returned_orders"} */

  create view "dbt"."dev"."rep_returned_orders__dbt_tmp"
    
    
  as (
    with customers as (
    select * from "dbt"."dev"."stg_customers"
),
orders as ( 
    select * from "dbt"."dev"."stg_orders"  -- Reemplaza fct_orders por stg_orders si es ahí donde está amount
),
customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value  -- Asegúrate de que amount esté en la tabla correcta
    from orders
    group by customer_id
),
final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value
    from customers
    left join customer_orders using (customer_id)
)
select * from final
  );
[0m10:48:58.907530 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "amount" does not exist
LINE 19:         sum(amount) as lifetime_value  -- Asegúrate de que a...
                     ^

[0m10:48:58.908179 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: ROLLBACK
[0m10:48:58.909872 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: Close
[0m10:48:58.928316 [debug] [Thread-1 (]: Database Error in model rep_returned_orders (models/marts/rep_returned_orders.sql)
  column "amount" does not exist
  LINE 19:         sum(amount) as lifetime_value  -- Asegúrate de que a...
                       ^
  compiled code at target/run/jaffle_shop/models/marts/rep_returned_orders.sql
[0m10:48:58.929130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc0fa60>]}
[0m10:48:58.929929 [error] [Thread-1 (]: 4 of 8 ERROR creating sql view model dev.rep_returned_orders ................... [[31mERROR[0m in 0.06s]
[0m10:48:58.930843 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.rep_returned_orders
[0m10:48:58.931475 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m10:48:58.932069 [info ] [Thread-1 (]: 5 of 8 START sql view model dev.fct_orders ..................................... [RUN]
[0m10:48:58.932894 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.rep_returned_orders' to be skipped because of status 'error'.  Reason: Database Error in model rep_returned_orders (models/marts/rep_returned_orders.sql)
  column "amount" does not exist
  LINE 19:         sum(amount) as lifetime_value  -- Asegúrate de que a...
                       ^
  compiled code at target/run/jaffle_shop/models/marts/rep_returned_orders.sql.
[0m10:48:58.933493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.rep_returned_orders, now model.jaffle_shop.fct_orders)
[0m10:48:58.934692 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m10:48:58.941792 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m10:48:58.943078 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m10:48:58.947001 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m10:48:58.947849 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:48:58.948284 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m10:48:58.948681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:58.970294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m10:48:58.970913 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:48:58.971379 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  create view "dbt"."dev"."fct_orders__dbt_tmp"
    
    
  as (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
[0m10:48:58.974967 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:48:58.978688 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:48:58.979169 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m10:48:58.981032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:48:58.982588 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:48:58.983364 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:48:58.983934 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:48:58.987996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:48:58.991387 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m10:48:58.992276 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:48:58.992774 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop view if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m10:48:58.994381 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:48:58.996020 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m10:48:58.996875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8315d0>]}
[0m10:48:58.997963 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dev.fct_orders ................................ [[32mCREATE VIEW[0m in 0.06s]
[0m10:48:58.998864 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m10:48:58.999688 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m10:48:59.000643 [info ] [Thread-1 (]: 6 of 8 START sql view model dev.order_payment_method_amounts ................... [RUN]
[0m10:48:59.001362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m10:48:59.001826 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m10:48:59.010443 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:48:59.011560 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m10:48:59.015618 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:48:59.016490 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:48:59.019344 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m10:48:59.019843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:59.041351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m10:48:59.041947 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:48:59.042412 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  create view "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
    
    
  as (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
[0m10:48:59.045292 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:48:59.050108 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:48:59.050752 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m10:48:59.052671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:48:59.054202 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:48:59.054660 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:48:59.055388 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:48:59.057754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:48:59.060626 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m10:48:59.061413 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:48:59.061856 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop view if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m10:48:59.063417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:48:59.065019 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m10:48:59.065798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8315d0>]}
[0m10:48:59.066824 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dev.order_payment_method_amounts .............. [[32mCREATE VIEW[0m in 0.06s]
[0m10:48:59.067811 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m10:48:59.068566 [debug] [Thread-1 (]: Began running node model.jaffle_shop.rep_payment_method_status
[0m10:48:59.069236 [info ] [Thread-1 (]: 7 of 8 START sql view model dev.rep_payment_method_status ...................... [RUN]
[0m10:48:59.069999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.rep_payment_method_status)
[0m10:48:59.070482 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.rep_payment_method_status
[0m10:48:59.074596 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.rep_payment_method_status"
[0m10:48:59.077769 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.rep_payment_method_status
[0m10:48:59.088617 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.rep_payment_method_status"
[0m10:48:59.089996 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:48:59.090742 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: BEGIN
[0m10:48:59.091412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:59.119291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m10:48:59.119953 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:48:59.120432 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */

  create view "dbt"."dev"."rep_payment_method_status__dbt_tmp"
    
    
  as (
    with payment_status as (

    select
        payment_method,
        -- Calcula el total de pagos exitosos
        sum(case when status = 'success' then amount else 0 end) as success,
        -- Calcula el total de pagos fallidos
        sum(case when status = 'failed' then amount else 0 end) as failed
    from "dbt"."dev"."stg_payments"  -- Hace referencia a la tabla de pagos en staging
    group by payment_method

)

select * from payment_status
  );
[0m10:48:59.123614 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:48:59.127992 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:48:59.128487 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */
alter table "dbt"."dev"."rep_payment_method_status__dbt_tmp" rename to "rep_payment_method_status"
[0m10:48:59.130471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:48:59.132115 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: COMMIT
[0m10:48:59.132579 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:48:59.133197 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: COMMIT
[0m10:48:59.136438 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:48:59.140981 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."rep_payment_method_status__dbt_backup"
[0m10:48:59.141821 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:48:59.142374 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */
drop view if exists "dbt"."dev"."rep_payment_method_status__dbt_backup" cascade
[0m10:48:59.144247 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:48:59.145918 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: Close
[0m10:48:59.147103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8315d0>]}
[0m10:48:59.148053 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dev.rep_payment_method_status ................. [[32mCREATE VIEW[0m in 0.08s]
[0m10:48:59.149785 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.rep_payment_method_status
[0m10:48:59.150326 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m10:48:59.151048 [info ] [Thread-1 (]: 8 of 8 START sql view model dev.dim_customers .................................. [RUN]
[0m10:48:59.151790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.rep_payment_method_status, now model.jaffle_shop.dim_customers)
[0m10:48:59.152325 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m10:48:59.158194 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m10:48:59.159255 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m10:48:59.163760 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m10:48:59.164647 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:48:59.165085 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m10:48:59.165482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:59.189989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m10:48:59.190582 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:48:59.191061 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  create view "dbt"."dev"."dim_customers__dbt_tmp"
    
    
  as (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
[0m10:48:59.194969 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:48:59.200422 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:48:59.201059 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m10:48:59.203202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:48:59.205465 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:48:59.206250 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:48:59.206917 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:48:59.209557 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:48:59.212390 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m10:48:59.213165 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:48:59.213634 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m10:48:59.215206 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:48:59.216935 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m10:48:59.217701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b64ffd5-3f6a-4105-a287-fcc853f91c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdebdf0>]}
[0m10:48:59.218643 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dev.dim_customers ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m10:48:59.219626 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m10:48:59.221324 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:59.221755 [debug] [MainThread]: On master: BEGIN
[0m10:48:59.222201 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:48:59.246053 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m10:48:59.246559 [debug] [MainThread]: On master: COMMIT
[0m10:48:59.247113 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:59.247472 [debug] [MainThread]: On master: COMMIT
[0m10:48:59.249142 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:48:59.249625 [debug] [MainThread]: On master: Close
[0m10:48:59.250309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:59.250983 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m10:48:59.251484 [info ] [MainThread]: 
[0m10:48:59.252101 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m10:48:59.254876 [debug] [MainThread]: Command end result
[0m10:48:59.303575 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m10:48:59.313735 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m10:48:59.326937 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/run_results.json
[0m10:48:59.327373 [info ] [MainThread]: 
[0m10:48:59.327823 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:48:59.328262 [info ] [MainThread]: 
[0m10:48:59.328754 [error] [MainThread]:   Database Error in model rep_returned_orders (models/marts/rep_returned_orders.sql)
  column "amount" does not exist
  LINE 19:         sum(amount) as lifetime_value  -- Asegúrate de que a...
                       ^
  compiled code at target/run/jaffle_shop/models/marts/rep_returned_orders.sql
[0m10:48:59.329176 [info ] [MainThread]: 
[0m10:48:59.329607 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m10:48:59.333171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1406252, "process_in_blocks": "0", "process_kernel_time": 0.391368, "process_mem_max_rss": "111759360", "process_out_blocks": "0", "process_user_time": 2.850314}
[0m10:48:59.333927 [debug] [MainThread]: Command `dbt run` failed at 10:48:59.333790 after 2.14 seconds
[0m10:48:59.334488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9a6830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe035b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe037c0>]}
[0m10:48:59.335073 [debug] [MainThread]: Flushing usage events
[0m10:49:00.551369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:56.333254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0d67d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efe2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efe1d80>]}


============================== 10:54:56.340677 | be42de87-42bc-4507-8fcf-4ca0478f4d76 ==============================
[0m10:54:56.340677 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:54:56.341615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/juanmontoliuarrando/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:54:56.342158 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m10:54:56.342649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef4d4e0>]}
[0m10:54:56.742862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4c0610>]}
[0m10:54:56.823263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea95fc0>]}
[0m10:54:56.825776 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:54:57.100233 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:54:57.335300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:54:57.335792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:54:57.430445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff05f90>]}
[0m10:54:57.580509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m10:54:57.585410 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m10:54:57.622834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff01540>]}
[0m10:54:57.623532 [info ] [MainThread]: Found 8 models, 5 data tests, 3 seeds, 3 sources, 430 macros
[0m10:54:57.624079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff02e30>]}
[0m10:54:57.626495 [info ] [MainThread]: 
[0m10:54:57.627201 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:54:57.627663 [info ] [MainThread]: 
[0m10:54:57.628394 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:54:57.637309 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m10:54:57.729376 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m10:54:57.730180 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m10:54:57.730965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:57.801220 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.070 seconds
[0m10:54:57.802918 [debug] [ThreadPool]: On list_dbt: Close
[0m10:54:57.805667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev)
[0m10:54:57.813292 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:54:57.813760 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m10:54:57.814113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:54:57.832130 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m10:54:57.832647 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:54:57.833046 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:54:57.838469 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m10:54:57.840055 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m10:54:57.841459 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m10:54:57.842244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_dev, now list_dbt_dev_data)
[0m10:54:57.846657 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m10:54:57.847095 [debug] [ThreadPool]: On list_dbt_dev_data: BEGIN
[0m10:54:57.847541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:54:57.865776 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m10:54:57.866236 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m10:54:57.866704 [debug] [ThreadPool]: On list_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev_data"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_data'
  
[0m10:54:57.870767 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m10:54:57.872312 [debug] [ThreadPool]: On list_dbt_dev_data: ROLLBACK
[0m10:54:57.873735 [debug] [ThreadPool]: On list_dbt_dev_data: Close
[0m10:54:57.880811 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:57.881267 [debug] [MainThread]: On master: BEGIN
[0m10:54:57.881647 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:54:57.899972 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m10:54:57.900529 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:57.900999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:54:57.907085 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m10:54:57.910752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc5d750>]}
[0m10:54:57.911297 [debug] [MainThread]: On master: ROLLBACK
[0m10:54:57.913044 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:57.913499 [debug] [MainThread]: On master: BEGIN
[0m10:54:57.915684 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:54:57.916152 [debug] [MainThread]: On master: COMMIT
[0m10:54:57.916527 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:57.916914 [debug] [MainThread]: On master: COMMIT
[0m10:54:57.918294 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:54:57.918776 [debug] [MainThread]: On master: Close
[0m10:54:57.920843 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m10:54:57.921555 [info ] [Thread-1 (]: 1 of 8 START sql view model dev.stg_customers .................................. [RUN]
[0m10:54:57.922573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev_data, now model.jaffle_shop.stg_customers)
[0m10:54:57.923167 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m10:54:57.936754 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m10:54:57.939534 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m10:54:57.988284 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m10:54:57.990700 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:54:57.991335 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m10:54:57.991813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:58.011651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m10:54:58.012566 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:54:58.013414 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m10:54:58.018307 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:54:58.026964 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:54:58.027541 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m10:54:58.029869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:54:58.033666 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:54:58.034153 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m10:54:58.036076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:54:58.057102 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:54:58.057626 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:54:58.058052 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:54:58.062135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:54:58.069737 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m10:54:58.074608 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:54:58.075120 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m10:54:58.080310 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:54:58.083293 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m10:54:58.086177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff06650>]}
[0m10:54:58.087402 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m10:54:58.088250 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m10:54:58.088752 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m10:54:58.089305 [info ] [Thread-1 (]: 2 of 8 START sql view model dev.stg_orders ..................................... [RUN]
[0m10:54:58.090015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m10:54:58.090460 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m10:54:58.098830 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m10:54:58.102413 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m10:54:58.107191 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m10:54:58.108243 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:54:58.114845 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m10:54:58.115737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:58.138222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m10:54:58.138959 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:54:58.139593 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m10:54:58.142794 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:54:58.168761 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:54:58.169321 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m10:54:58.171289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:54:58.221066 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:54:58.221607 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:54:58.223356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:54:58.224948 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:54:58.225402 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:54:58.225814 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:54:58.229476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:54:58.232995 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m10:54:58.233887 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:54:58.234409 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m10:54:58.238152 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:54:58.239912 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m10:54:58.240769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df611e0>]}
[0m10:54:58.241922 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.15s]
[0m10:54:58.242905 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m10:54:58.243661 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m10:54:58.245833 [info ] [Thread-1 (]: 3 of 8 START sql view model dev.stg_payments ................................... [RUN]
[0m10:54:58.247003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m10:54:58.247562 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m10:54:58.257385 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m10:54:58.259389 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m10:54:58.265733 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m10:54:58.266667 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:54:58.267150 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m10:54:58.267589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:58.290254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m10:54:58.290988 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:54:58.291484 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    
    (amount / 100)::numeric(16, 2)
 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m10:54:58.295453 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:54:58.300165 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:54:58.300719 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m10:54:58.302619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:54:58.306440 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:54:58.306999 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m10:54:58.308745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:54:58.310415 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:54:58.311004 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:54:58.311446 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:54:58.314070 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:54:58.317047 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m10:54:58.319215 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:54:58.319714 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m10:54:58.323786 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:54:58.325551 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m10:54:58.326317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df611e0>]}
[0m10:54:58.327265 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.08s]
[0m10:54:58.328373 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m10:54:58.329495 [debug] [Thread-1 (]: Began running node model.jaffle_shop.rep_returned_orders
[0m10:54:58.330367 [info ] [Thread-1 (]: 4 of 8 START sql view model dev.rep_returned_orders ............................ [RUN]
[0m10:54:58.331256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.rep_returned_orders)
[0m10:54:58.331751 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.rep_returned_orders
[0m10:54:58.336580 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.rep_returned_orders"
[0m10:54:58.338764 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.rep_returned_orders
[0m10:54:58.343839 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.rep_returned_orders"
[0m10:54:58.346409 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_returned_orders"
[0m10:54:58.347244 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: BEGIN
[0m10:54:58.347717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:58.369081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m10:54:58.369725 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_returned_orders"
[0m10:54:58.370246 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_returned_orders"} */

  create view "dbt"."dev"."rep_returned_orders__dbt_tmp"
    
    
  as (
    with customers as (
    select * from "dbt"."dev"."stg_customers"
),
orders as ( 
    select * from "dbt"."dev"."stg_orders"  -- Reemplaza fct_orders por stg_orders si es ahí donde está amount
),
customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value  -- Asegúrate de que amount esté en la tabla correcta
    from orders
    group by customer_id
),
final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value
    from customers
    left join customer_orders using (customer_id)
)
select * from final
  );
[0m10:54:58.372741 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "amount" does not exist
LINE 19:         sum(amount) as lifetime_value  -- Asegúrate de que a...
                     ^

[0m10:54:58.373301 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: ROLLBACK
[0m10:54:58.375117 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: Close
[0m10:54:58.387912 [debug] [Thread-1 (]: Database Error in model rep_returned_orders (models/marts/rep_returned_orders.sql)
  column "amount" does not exist
  LINE 19:         sum(amount) as lifetime_value  -- Asegúrate de que a...
                       ^
  compiled code at target/run/jaffle_shop/models/marts/rep_returned_orders.sql
[0m10:54:58.388647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff02da0>]}
[0m10:54:58.389444 [error] [Thread-1 (]: 4 of 8 ERROR creating sql view model dev.rep_returned_orders ................... [[31mERROR[0m in 0.06s]
[0m10:54:58.390348 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.rep_returned_orders
[0m10:54:58.390870 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m10:54:58.391465 [info ] [Thread-1 (]: 5 of 8 START sql view model dev.fct_orders ..................................... [RUN]
[0m10:54:58.392270 [debug] [Thread-4 (]: Marking all children of 'model.jaffle_shop.rep_returned_orders' to be skipped because of status 'error'.  Reason: Database Error in model rep_returned_orders (models/marts/rep_returned_orders.sql)
  column "amount" does not exist
  LINE 19:         sum(amount) as lifetime_value  -- Asegúrate de que a...
                       ^
  compiled code at target/run/jaffle_shop/models/marts/rep_returned_orders.sql.
[0m10:54:58.392815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.rep_returned_orders, now model.jaffle_shop.fct_orders)
[0m10:54:58.394495 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m10:54:58.399580 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m10:54:58.401002 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m10:54:58.405638 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m10:54:58.406544 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:54:58.406990 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m10:54:58.407394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:58.432932 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m10:54:58.433857 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:54:58.434416 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  create view "dbt"."dev"."fct_orders__dbt_tmp"
    
    
  as (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
[0m10:54:58.438184 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:54:58.442432 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:54:58.443038 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m10:54:58.445116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:54:58.447173 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:54:58.447953 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:54:58.448390 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:54:58.451059 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:54:58.453792 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m10:54:58.454480 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:54:58.454913 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop view if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m10:54:58.456484 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:54:58.458136 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m10:54:58.458927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b56a950>]}
[0m10:54:58.459905 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dev.fct_orders ................................ [[32mCREATE VIEW[0m in 0.07s]
[0m10:54:58.461296 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m10:54:58.462032 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m10:54:58.463314 [info ] [Thread-1 (]: 6 of 8 START sql view model dev.order_payment_method_amounts ................... [RUN]
[0m10:54:58.463951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m10:54:58.464407 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m10:54:58.470648 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:54:58.471771 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m10:54:58.475901 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:54:58.476760 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:54:58.477209 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m10:54:58.477616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:58.501972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m10:54:58.502570 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:54:58.503033 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  create view "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
    
    
  as (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
[0m10:54:58.506162 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:54:58.510251 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:54:58.511048 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m10:54:58.513599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:54:58.515149 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:54:58.515617 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:54:58.516036 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:54:58.643672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.127 seconds
[0m10:54:58.647979 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m10:54:58.648890 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:54:58.649363 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop view if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m10:54:58.655218 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m10:54:58.656904 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m10:54:58.657923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b56a950>]}
[0m10:54:58.658889 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dev.order_payment_method_amounts .............. [[32mCREATE VIEW[0m in 0.19s]
[0m10:54:58.660039 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m10:54:58.661058 [debug] [Thread-1 (]: Began running node model.jaffle_shop.rep_payment_method_status
[0m10:54:58.662156 [info ] [Thread-1 (]: 7 of 8 START sql view model dev.rep_payment_method_status ...................... [RUN]
[0m10:54:58.662895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.rep_payment_method_status)
[0m10:54:58.663519 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.rep_payment_method_status
[0m10:54:58.667563 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.rep_payment_method_status"
[0m10:54:58.669097 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.rep_payment_method_status
[0m10:54:58.673694 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.rep_payment_method_status"
[0m10:54:58.674730 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:54:58.675287 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: BEGIN
[0m10:54:58.675721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:58.704090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m10:54:58.705051 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:54:58.706156 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */

  create view "dbt"."dev"."rep_payment_method_status__dbt_tmp"
    
    
  as (
    with payment_status as (

    select
        payment_method,
        -- Calcula el total de pagos exitosos
        sum(case when status = 'success' then amount else 0 end) as success,
        -- Calcula el total de pagos fallidos
        sum(case when status = 'failed' then amount else 0 end) as failed
    from "dbt"."dev"."stg_payments"  -- Hace referencia a la tabla de pagos en staging
    group by payment_method

)

select * from payment_status
  );
[0m10:54:58.710438 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:54:58.718517 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:54:58.719369 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */
alter table "dbt"."dev"."rep_payment_method_status__dbt_tmp" rename to "rep_payment_method_status"
[0m10:54:58.723005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:54:58.726230 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: COMMIT
[0m10:54:58.727051 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:54:58.727999 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: COMMIT
[0m10:54:58.731301 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:54:58.738193 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."rep_payment_method_status__dbt_backup"
[0m10:54:58.739411 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:54:58.740254 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */
drop view if exists "dbt"."dev"."rep_payment_method_status__dbt_backup" cascade
[0m10:54:58.742004 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:54:58.743932 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: Close
[0m10:54:58.745015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110555e70>]}
[0m10:54:58.746673 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dev.rep_payment_method_status ................. [[32mCREATE VIEW[0m in 0.08s]
[0m10:54:58.747735 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.rep_payment_method_status
[0m10:54:58.748689 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m10:54:58.749459 [info ] [Thread-1 (]: 8 of 8 START sql view model dev.dim_customers .................................. [RUN]
[0m10:54:58.750144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.rep_payment_method_status, now model.jaffle_shop.dim_customers)
[0m10:54:58.750619 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m10:54:58.756977 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m10:54:58.758004 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m10:54:58.764360 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m10:54:58.765919 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:54:58.767103 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m10:54:58.767582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:58.788096 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m10:54:58.788788 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:54:58.789298 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  create view "dbt"."dev"."dim_customers__dbt_tmp"
    
    
  as (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
[0m10:54:58.795787 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:54:58.799695 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:54:58.800199 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m10:54:58.802177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:54:58.803860 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:54:58.804346 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:54:58.804782 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:54:58.807568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:54:58.810474 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m10:54:58.811460 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:54:58.811940 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m10:54:58.814847 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:54:58.816544 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m10:54:58.817338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be42de87-42bc-4507-8fcf-4ca0478f4d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110555e70>]}
[0m10:54:58.818316 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dev.dim_customers ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m10:54:58.819383 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m10:54:58.821216 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:58.821774 [debug] [MainThread]: On master: BEGIN
[0m10:54:58.822151 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:54:58.847935 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m10:54:58.848509 [debug] [MainThread]: On master: COMMIT
[0m10:54:58.849278 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:58.850059 [debug] [MainThread]: On master: COMMIT
[0m10:54:58.851672 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:54:58.852162 [debug] [MainThread]: On master: Close
[0m10:54:58.852777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:58.853308 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m10:54:58.853962 [info ] [MainThread]: 
[0m10:54:58.854687 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m10:54:58.857585 [debug] [MainThread]: Command end result
[0m10:54:58.895223 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m10:54:58.898803 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m10:54:58.908369 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/run_results.json
[0m10:54:58.908835 [info ] [MainThread]: 
[0m10:54:58.909353 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:54:58.909813 [info ] [MainThread]: 
[0m10:54:58.910414 [error] [MainThread]:   Database Error in model rep_returned_orders (models/marts/rep_returned_orders.sql)
  column "amount" does not exist
  LINE 19:         sum(amount) as lifetime_value  -- Asegúrate de que a...
                       ^
  compiled code at target/run/jaffle_shop/models/marts/rep_returned_orders.sql
[0m10:54:58.910960 [info ] [MainThread]: 
[0m10:54:58.911550 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m10:54:58.915999 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.683337, "process_in_blocks": "0", "process_kernel_time": 0.610246, "process_mem_max_rss": "112021504", "process_out_blocks": "0", "process_user_time": 3.261789}
[0m10:54:58.918132 [debug] [MainThread]: Command `dbt run` failed at 10:54:58.917707 after 2.69 seconds
[0m10:54:58.919336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0d67d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e338670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f48cf70>]}
[0m10:54:58.919864 [debug] [MainThread]: Flushing usage events
[0m10:54:59.461970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:57:10.144103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d12740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c1e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c1dd20>]}


============================== 10:57:10.152638 | f1055cca-3ec1-4973-8a01-43684303d4b1 ==============================
[0m10:57:10.152638 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:57:10.153830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/logs', 'profiles_dir': '/Users/juanmontoliuarrando/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:57:10.154497 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m10:57:10.155097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b8a380>]}
[0m10:57:10.420086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f5d7e0>]}
[0m10:57:10.515172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c1d930>]}
[0m10:57:10.516915 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:57:10.778847 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:57:11.020398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:11.020889 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:11.120003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b45f60>]}
[0m10:57:11.297132 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m10:57:11.320162 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m10:57:11.408957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b3fee0>]}
[0m10:57:11.409644 [info ] [MainThread]: Found 8 models, 5 data tests, 3 seeds, 3 sources, 430 macros
[0m10:57:11.410306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b3ff70>]}
[0m10:57:11.412768 [info ] [MainThread]: 
[0m10:57:11.413415 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:11.413916 [info ] [MainThread]: 
[0m10:57:11.414713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:11.429140 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m10:57:11.576457 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m10:57:11.576994 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m10:57:11.577449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:11.645278 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.068 seconds
[0m10:57:11.646852 [debug] [ThreadPool]: On list_dbt: Close
[0m10:57:11.649367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now list_dbt_dev_data)
[0m10:57:11.656671 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m10:57:11.657114 [debug] [ThreadPool]: On list_dbt_dev_data: BEGIN
[0m10:57:11.657459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:11.675858 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m10:57:11.676318 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev_data"
[0m10:57:11.676744 [debug] [ThreadPool]: On list_dbt_dev_data: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev_data"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_data'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev_data'
  
[0m10:57:11.681822 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m10:57:11.683296 [debug] [ThreadPool]: On list_dbt_dev_data: ROLLBACK
[0m10:57:11.684736 [debug] [ThreadPool]: On list_dbt_dev_data: Close
[0m10:57:11.685597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_dev_data, now list_dbt_dev)
[0m10:57:11.689199 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:57:11.689700 [debug] [ThreadPool]: On list_dbt_dev: BEGIN
[0m10:57:11.690095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:11.707281 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m10:57:11.707821 [debug] [ThreadPool]: Using postgres connection "list_dbt_dev"
[0m10:57:11.708221 [debug] [ThreadPool]: On list_dbt_dev: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbt_dev"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'dbt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m10:57:11.712395 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m10:57:11.714027 [debug] [ThreadPool]: On list_dbt_dev: ROLLBACK
[0m10:57:11.715488 [debug] [ThreadPool]: On list_dbt_dev: Close
[0m10:57:11.723338 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:11.723788 [debug] [MainThread]: On master: BEGIN
[0m10:57:11.724131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:11.741621 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m10:57:11.742126 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:11.742714 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:57:11.749928 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m10:57:11.753455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b5b340>]}
[0m10:57:11.753991 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:11.755396 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:11.755868 [debug] [MainThread]: On master: BEGIN
[0m10:57:11.758129 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:57:11.758603 [debug] [MainThread]: On master: COMMIT
[0m10:57:11.759049 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:11.759402 [debug] [MainThread]: On master: COMMIT
[0m10:57:11.760641 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:57:11.761098 [debug] [MainThread]: On master: Close
[0m10:57:11.763068 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m10:57:11.763769 [info ] [Thread-1 (]: 1 of 8 START sql view model dev.stg_customers .................................. [RUN]
[0m10:57:11.764809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_dev, now model.jaffle_shop.stg_customers)
[0m10:57:11.765483 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m10:57:11.779742 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m10:57:11.788516 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m10:57:11.832786 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m10:57:11.834847 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:57:11.835505 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m10:57:11.835988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:11.854346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m10:57:11.854928 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:57:11.855363 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbt"."dev"."stg_customers__dbt_tmp"
    
    
  as (
    select
   id as customer_id,
   first_name,
   last_name
from
   "dbt"."dev_data"."customers"
  );
[0m10:57:11.858378 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:57:11.865877 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:57:11.866406 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers" rename to "stg_customers__dbt_backup"
[0m10:57:11.868182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:57:11.871588 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:57:11.872059 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbt"."dev"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m10:57:11.874104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:11.892475 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:57:11.892993 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:57:11.893413 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m10:57:11.895905 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:57:11.903047 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_customers__dbt_backup"
[0m10:57:11.907933 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_customers"
[0m10:57:11.908429 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbt"."dev"."stg_customers__dbt_backup" cascade
[0m10:57:11.912557 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:57:11.915560 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m10:57:11.918433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bd1f30>]}
[0m10:57:11.919682 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dev.stg_customers ............................. [[32mCREATE VIEW[0m in 0.15s]
[0m10:57:11.920523 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m10:57:11.921017 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m10:57:11.921567 [info ] [Thread-1 (]: 2 of 8 START sql view model dev.stg_orders ..................................... [RUN]
[0m10:57:11.922292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_orders)
[0m10:57:11.922739 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m10:57:11.926438 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m10:57:11.929078 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m10:57:11.940859 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m10:57:11.941814 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:57:11.942283 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m10:57:11.942709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:11.964883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m10:57:11.965563 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:57:11.966143 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbt"."dev"."stg_orders__dbt_tmp"
    
    
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status
from 
    "dbt"."dev_data"."orders"
  );
[0m10:57:11.969049 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:57:11.974246 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:57:11.974747 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders" rename to "stg_orders__dbt_backup"
[0m10:57:11.977294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:12.029911 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:57:12.030596 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbt"."dev"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:57:12.033146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:12.035309 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:57:12.035913 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:57:12.036462 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m10:57:12.040818 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:57:12.044384 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_orders__dbt_backup"
[0m10:57:12.045187 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_orders"
[0m10:57:12.045693 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbt"."dev"."stg_orders__dbt_backup" cascade
[0m10:57:12.049268 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:57:12.051051 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: Close
[0m10:57:12.051908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b9e800>]}
[0m10:57:12.053043 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dev.stg_orders ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m10:57:12.054036 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m10:57:12.054584 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m10:57:12.055848 [info ] [Thread-1 (]: 3 of 8 START sql view model dev.stg_payments ................................... [RUN]
[0m10:57:12.056549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m10:57:12.057062 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m10:57:12.063317 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m10:57:12.067492 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m10:57:12.071818 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m10:57:12.072723 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:57:12.073203 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m10:57:12.073647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:12.094800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m10:57:12.095383 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:57:12.095932 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbt"."dev"."stg_payments__dbt_tmp"
    
    
  as (
    select
    id as payment_id,
    orderid as order_id,
    paymentmethod as payment_method,
    status,
    -- amount is stored in cents, convert it to dollars
    
    (amount / 100)::numeric(16, 2)
 as amount,
    created as created_at
from "dbt"."dev_data"."payments"
  );
[0m10:57:12.098842 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m10:57:12.103157 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:57:12.103686 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments" rename to "stg_payments__dbt_backup"
[0m10:57:12.105475 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:57:12.109242 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:57:12.109748 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbt"."dev"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m10:57:12.111953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:12.113640 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:57:12.114122 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:57:12.114562 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m10:57:12.118237 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:57:12.121324 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."stg_payments__dbt_backup"
[0m10:57:12.123550 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.stg_payments"
[0m10:57:12.124067 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbt"."dev"."stg_payments__dbt_backup" cascade
[0m10:57:12.128076 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:57:12.129854 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m10:57:12.130747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140140d0>]}
[0m10:57:12.131736 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dev.stg_payments .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m10:57:12.132713 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m10:57:12.134387 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m10:57:12.135107 [info ] [Thread-1 (]: 4 of 8 START sql view model dev.fct_orders ..................................... [RUN]
[0m10:57:12.135923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m10:57:12.136408 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m10:57:12.142052 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m10:57:12.146351 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m10:57:12.150589 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m10:57:12.152488 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:57:12.153473 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m10:57:12.154520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:12.178283 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m10:57:12.179006 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:57:12.179526 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  create view "dbt"."dev"."fct_orders__dbt_tmp"
    
    
  as (
    with orders as  (
    select * from "dbt"."dev"."stg_orders"
),

payments as (
    select * from "dbt"."dev"."stg_payments"
),

order_payments as (
    select
        order_id,
        sum (case when status = 'success' then amount end) as amount

    from payments
    group by order_id
),

 final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce (order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
  );
[0m10:57:12.184624 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:57:12.190506 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:57:12.191165 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbt"."dev"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m10:57:12.193202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:12.194820 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:57:12.195551 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:57:12.195996 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m10:57:12.198810 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:57:12.201803 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."fct_orders__dbt_backup"
[0m10:57:12.202524 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.fct_orders"
[0m10:57:12.202984 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop view if exists "dbt"."dev"."fct_orders__dbt_backup" cascade
[0m10:57:12.204775 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:57:12.207212 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m10:57:12.208095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140fb8b0>]}
[0m10:57:12.209122 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dev.fct_orders ................................ [[32mCREATE VIEW[0m in 0.07s]
[0m10:57:12.210162 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m10:57:12.211769 [debug] [Thread-1 (]: Began running node model.jaffle_shop.order_payment_method_amounts
[0m10:57:12.213159 [info ] [Thread-1 (]: 5 of 8 START sql view model dev.order_payment_method_amounts ................... [RUN]
[0m10:57:12.215409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.order_payment_method_amounts)
[0m10:57:12.218013 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.order_payment_method_amounts
[0m10:57:12.223941 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:57:12.225099 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.order_payment_method_amounts
[0m10:57:12.232068 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.order_payment_method_amounts"
[0m10:57:12.245371 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:57:12.246172 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: BEGIN
[0m10:57:12.246629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:12.275902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m10:57:12.276805 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:57:12.277836 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */

  create view "dbt"."dev"."order_payment_method_amounts__dbt_tmp"
    
    
  as (
    

select
    order_id,
    
    sum(case when payment_method = 'bank_transfer' then amount end) as bank_transfer_amount,
    
    sum(case when payment_method = 'credit_card' then amount end) as credit_card_amount,
    
    sum(case when payment_method = 'gift_card' then amount end) as gift_card_amount,
    
    sum(amount) as total_amount
from "dbt"."dev"."stg_payments"
group by order_id
  );
[0m10:57:12.282021 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:57:12.289076 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:57:12.289804 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
alter table "dbt"."dev"."order_payment_method_amounts__dbt_tmp" rename to "order_payment_method_amounts"
[0m10:57:12.293005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:57:12.294533 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:57:12.295001 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:57:12.295418 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: COMMIT
[0m10:57:12.299008 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:57:12.302096 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."order_payment_method_amounts__dbt_backup"
[0m10:57:12.302925 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.order_payment_method_amounts"
[0m10:57:12.303379 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payment_method_amounts"} */
drop view if exists "dbt"."dev"."order_payment_method_amounts__dbt_backup" cascade
[0m10:57:12.306246 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:57:12.307870 [debug] [Thread-1 (]: On model.jaffle_shop.order_payment_method_amounts: Close
[0m10:57:12.308617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11413fb20>]}
[0m10:57:12.309435 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dev.order_payment_method_amounts .............. [[32mCREATE VIEW[0m in 0.09s]
[0m10:57:12.310719 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.order_payment_method_amounts
[0m10:57:12.311240 [debug] [Thread-1 (]: Began running node model.jaffle_shop.rep_payment_method_status
[0m10:57:12.311925 [info ] [Thread-1 (]: 6 of 8 START sql view model dev.rep_payment_method_status ...................... [RUN]
[0m10:57:12.312768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.order_payment_method_amounts, now model.jaffle_shop.rep_payment_method_status)
[0m10:57:12.313450 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.rep_payment_method_status
[0m10:57:12.317226 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.rep_payment_method_status"
[0m10:57:12.320331 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.rep_payment_method_status
[0m10:57:12.325765 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.rep_payment_method_status"
[0m10:57:12.327657 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:57:12.328602 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: BEGIN
[0m10:57:12.329045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:12.347972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:57:12.348494 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:57:12.349038 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */

  create view "dbt"."dev"."rep_payment_method_status__dbt_tmp"
    
    
  as (
    with payment_status as (

    select
        payment_method,
        -- Calcula el total de pagos exitosos
        sum(case when status = 'success' then amount else 0 end) as success,
        -- Calcula el total de pagos fallidos
        sum(case when status = 'failed' then amount else 0 end) as failed
    from "dbt"."dev"."stg_payments"  -- Hace referencia a la tabla de pagos en staging
    group by payment_method

)

select * from payment_status
  );
[0m10:57:12.352350 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:57:12.355920 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:57:12.356402 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */
alter table "dbt"."dev"."rep_payment_method_status__dbt_tmp" rename to "rep_payment_method_status"
[0m10:57:12.358127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:57:12.360013 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: COMMIT
[0m10:57:12.360519 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:57:12.360935 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: COMMIT
[0m10:57:12.363434 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:57:12.366220 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."rep_payment_method_status__dbt_backup"
[0m10:57:12.367064 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_payment_method_status"
[0m10:57:12.367509 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_payment_method_status"} */
drop view if exists "dbt"."dev"."rep_payment_method_status__dbt_backup" cascade
[0m10:57:12.369749 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:57:12.371334 [debug] [Thread-1 (]: On model.jaffle_shop.rep_payment_method_status: Close
[0m10:57:12.372166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114110d60>]}
[0m10:57:12.373158 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dev.rep_payment_method_status ................. [[32mCREATE VIEW[0m in 0.06s]
[0m10:57:12.374109 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.rep_payment_method_status
[0m10:57:12.374830 [debug] [Thread-1 (]: Began running node model.jaffle_shop.rep_returned_orders
[0m10:57:12.375510 [info ] [Thread-1 (]: 7 of 8 START sql view model dev.rep_returned_orders ............................ [RUN]
[0m10:57:12.376193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.rep_payment_method_status, now model.jaffle_shop.rep_returned_orders)
[0m10:57:12.376756 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.rep_returned_orders
[0m10:57:12.383040 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.rep_returned_orders"
[0m10:57:12.385358 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.rep_returned_orders
[0m10:57:12.392146 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.rep_returned_orders"
[0m10:57:12.393587 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_returned_orders"
[0m10:57:12.396062 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: BEGIN
[0m10:57:12.396727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:12.417973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m10:57:12.418857 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_returned_orders"
[0m10:57:12.419361 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_returned_orders"} */

  create view "dbt"."dev"."rep_returned_orders__dbt_tmp"
    
    
  as (
    with returned_orders as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        o.status
    from "dbt"."dev"."stg_orders" o
    where o.status = 'returned'  -- Filtra solo las órdenes devueltas
),

payment_details as (
    select
        p.order_id,
        sum(case when p.status = 'success' then p.amount else 0 end) as amount
    from "dbt"."dev"."stg_payments" p
    group by p.order_id
),

final_report as (
    select
        ro.order_id,
        ro.customer_id,
        ro.order_date,
        ro.status,
        c.first_name,
        c.last_name,
        pd.amount
    from returned_orders ro
    left join "dbt"."dev"."stg_customers" c
        on ro.customer_id = c.customer_id
    left join payment_details pd
        on ro.order_id = pd.order_id
)

select * from final_report
  );
[0m10:57:12.425609 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:57:12.430848 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_returned_orders"
[0m10:57:12.431440 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_returned_orders"} */
alter table "dbt"."dev"."rep_returned_orders__dbt_tmp" rename to "rep_returned_orders"
[0m10:57:12.434066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:12.435891 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: COMMIT
[0m10:57:12.436459 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_returned_orders"
[0m10:57:12.437055 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: COMMIT
[0m10:57:12.439809 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:57:12.445910 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."rep_returned_orders__dbt_backup"
[0m10:57:12.447274 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.rep_returned_orders"
[0m10:57:12.449231 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.rep_returned_orders"} */
drop view if exists "dbt"."dev"."rep_returned_orders__dbt_backup" cascade
[0m10:57:12.453562 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:57:12.456676 [debug] [Thread-1 (]: On model.jaffle_shop.rep_returned_orders: Close
[0m10:57:12.457787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140140d0>]}
[0m10:57:12.458928 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dev.rep_returned_orders ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m10:57:12.461000 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.rep_returned_orders
[0m10:57:12.462247 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m10:57:12.464220 [info ] [Thread-1 (]: 8 of 8 START sql view model dev.dim_customers .................................. [RUN]
[0m10:57:12.472622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.rep_returned_orders, now model.jaffle_shop.dim_customers)
[0m10:57:12.473916 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m10:57:12.486954 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m10:57:12.488404 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m10:57:12.498339 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m10:57:12.500874 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:57:12.501728 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m10:57:12.503223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:12.589081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.086 seconds
[0m10:57:12.589994 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:57:12.590537 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  create view "dbt"."dev"."dim_customers__dbt_tmp"
    
    
  as (
    with customers as (

     select * from "dbt"."dev"."stg_customers"

),

orders as ( 

    select * from "dbt"."dev"."fct_orders"

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders

    group by customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce (customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
[0m10:57:12.595789 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:57:12.600910 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:57:12.601451 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbt"."dev"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m10:57:12.605054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:57:12.606994 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:57:12.607559 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:57:12.608357 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m10:57:12.616634 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m10:57:12.621636 [debug] [Thread-1 (]: Applying DROP to: "dbt"."dev"."dim_customers__dbt_backup"
[0m10:57:12.623615 [debug] [Thread-1 (]: Using postgres connection "model.jaffle_shop.dim_customers"
[0m10:57:12.624419 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop view if exists "dbt"."dev"."dim_customers__dbt_backup" cascade
[0m10:57:12.627823 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:57:12.630468 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m10:57:12.632124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1055cca-3ec1-4973-8a01-43684303d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b67f70>]}
[0m10:57:12.633597 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dev.dim_customers ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m10:57:12.635899 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m10:57:12.637916 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:12.638640 [debug] [MainThread]: On master: BEGIN
[0m10:57:12.639280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:12.673742 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m10:57:12.674706 [debug] [MainThread]: On master: COMMIT
[0m10:57:12.675475 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:12.676249 [debug] [MainThread]: On master: COMMIT
[0m10:57:12.678648 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:57:12.679134 [debug] [MainThread]: On master: Close
[0m10:57:12.679910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:12.680503 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m10:57:12.681146 [info ] [MainThread]: 
[0m10:57:12.681885 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m10:57:12.685245 [debug] [MainThread]: Command end result
[0m10:57:12.725847 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/manifest.json
[0m10:57:12.731381 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/semantic_manifest.json
[0m10:57:12.749973 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/juanmontoliuarrando/Desktop/MDA/dbt-postgres2/jaffle_shop/target/run_results.json
[0m10:57:12.750476 [info ] [MainThread]: 
[0m10:57:12.751112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:12.751550 [info ] [MainThread]: 
[0m10:57:12.752289 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m10:57:12.755838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.706788, "process_in_blocks": "0", "process_kernel_time": 0.629562, "process_mem_max_rss": "111374336", "process_out_blocks": "0", "process_user_time": 3.357131}
[0m10:57:12.757975 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:12.757726 after 2.71 seconds
[0m10:57:12.765897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d12740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f8cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11410d870>]}
[0m10:57:12.767012 [debug] [MainThread]: Flushing usage events
[0m10:57:13.458408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:57:35.687532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195DEABB830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195DE69F560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195DEAB8080>]}


============================== 22:57:35.703474 | ca59833c-e392-47b1-a576-684b8c8d4c4e ==============================
[0m22:57:35.703474 [info ] [MainThread]: Running with dbt=1.6.18
[0m22:57:35.703474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alejb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\EDEM_MDA2425\\ALUMNOS\\MDAB\\JUAN_MONTOLIU\\DBT\\jaffle_shop\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m22:57:35.703474 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m22:57:35.703474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ca59833c-e392-47b1-a576-684b8c8d4c4e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195DEAB9EE0>]}
[0m22:57:35.864029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca59833c-e392-47b1-a576-684b8c8d4c4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195DE69F560>]}
[0m22:57:35.864029 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:57:35.864029 [debug] [MainThread]: Command `cli deps` succeeded at 22:57:35.864029 after 0.31 seconds
[0m22:57:35.864029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195DE003CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195DE5D1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195DE50B830>]}
[0m22:57:35.864029 [debug] [MainThread]: Flushing usage events
[0m17:18:04.209775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A36B794F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A36B7B710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A36B7B9B0>]}


============================== 17:18:04.214781 | eab03cd9-27d4-4c6a-8d64-a992cae0fd37 ==============================
[0m17:18:04.214781 [info ] [MainThread]: Running with dbt=1.6.18
[0m17:18:04.215782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\EDEM_MDA2425\\ALUMNOS\\MDAB\\JUAN_MONTOLIU\\DBT\\jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alejb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:18:04.216776 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:18:04.217780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eab03cd9-27d4-4c6a-8d64-a992cae0fd37', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A367816D0>]}
[0m17:18:04.364552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eab03cd9-27d4-4c6a-8d64-a992cae0fd37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A36B79850>]}
[0m17:18:04.366552 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:18:04.367552 [debug] [MainThread]: Command `cli deps` succeeded at 17:18:04.366552 after 0.28 seconds
[0m17:18:04.367552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A36853020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A3690F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A355A6DB0>]}
[0m17:18:04.368551 [debug] [MainThread]: Flushing usage events
[0m11:51:42.179266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021397B0B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021397A1B950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002139794FFE0>]}


============================== 11:51:42.179266 | 074ee63b-b525-4c14-a621-b38290e61dda ==============================
[0m11:51:42.179266 [info ] [MainThread]: Running with dbt=1.6.18
[0m11:51:42.179266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alejb\\.dbt', 'log_path': 'c:\\EDEM_MDA2425\\ALUMNOS\\MDAB\\JUAN_MONTOLIU\\DBT\\jaffle_shop\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:51:42.179266 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m11:51:42.179266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '074ee63b-b525-4c14-a621-b38290e61dda', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213978AB110>]}
[0m11:51:42.329226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '074ee63b-b525-4c14-a621-b38290e61dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021397B24B00>]}
[0m11:51:42.329226 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:51:42.329226 [debug] [MainThread]: Command `cli deps` succeeded at 11:51:42.329226 after 0.26 seconds
[0m11:51:42.329226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213977B1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021397813020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021397AE7E30>]}
[0m11:51:42.329226 [debug] [MainThread]: Flushing usage events
[0m17:46:03.797507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A009D9B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A009D88C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A009D95E0>]}


============================== 17:46:03.797507 | 4429934d-2121-41a5-b4c3-9514363c594f ==============================
[0m17:46:03.797507 [info ] [MainThread]: Running with dbt=1.6.18
[0m17:46:03.797507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alejb\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\EDEM_MDA2425\\ALUMNOS\\MDAB\\JUAN_MONTOLIU\\DBT\\jaffle_shop\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:46:03.811035 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:46:03.811035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4429934d-2121-41a5-b4c3-9514363c594f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A009DA060>]}
[0m17:46:03.923510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4429934d-2121-41a5-b4c3-9514363c594f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A00492060>]}
[0m17:46:03.923510 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:46:03.923510 [debug] [MainThread]: Command `cli deps` succeeded at 17:46:03.923510 after 0.23 seconds
[0m17:46:03.923510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A003D5E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A0089E390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A0089EB10>]}
[0m17:46:03.923510 [debug] [MainThread]: Flushing usage events
[0m20:32:07.664007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D781613530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7811AB950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78168B3B0>]}


============================== 20:32:07.671911 | 89efbf84-5f2d-467f-a9c7-6e2945fabb9d ==============================
[0m20:32:07.671911 [info ] [MainThread]: Running with dbt=1.6.18
[0m20:32:07.673365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alejb\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\EDEM_MDA2425\\ALUMNOS\\MDAB\\JUAN_MONTOLIU\\DBT\\jaffle_shop\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:32:07.673933 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m20:32:07.674990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '89efbf84-5f2d-467f-a9c7-6e2945fabb9d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D780BBEC00>]}
[0m20:32:07.939856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89efbf84-5f2d-467f-a9c7-6e2945fabb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78084E3F0>]}
[0m20:32:07.944375 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:32:07.944375 [debug] [MainThread]: Command `cli deps` succeeded at 20:32:07.944375 after 0.43 seconds
[0m20:32:07.944375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D781757EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7815BFC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D78084E3F0>]}
[0m20:32:07.944375 [debug] [MainThread]: Flushing usage events
[0m20:32:20.004268 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m12:58:03.654984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6B88B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6B5C7FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6B8894F0>]}


============================== 12:58:03.662987 | bdfaca35-8f27-4586-94cd-656e2893d760 ==============================
[0m12:58:03.662987 [info ] [MainThread]: Running with dbt=1.6.18
[0m12:58:03.662987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alejb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\EDEM_MDA2425\\ALUMNOS\\MDAB\\JUAN_MONTOLIU\\DBT\\jaffle_shop\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:58:03.662987 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m12:58:03.662987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bdfaca35-8f27-4586-94cd-656e2893d760', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6B5C6C00>]}
[0m12:58:03.800839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdfaca35-8f27-4586-94cd-656e2893d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6B889850>]}
[0m12:58:03.800839 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:58:03.800839 [debug] [MainThread]: Command `cli deps` succeeded at 12:58:03.800839 after 0.27 seconds
[0m12:58:03.800839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6B86BAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6B591DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD6B530B60>]}
[0m12:58:03.800839 [debug] [MainThread]: Flushing usage events
[0m15:52:10.662288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001901B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020019018D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001901B680>]}


============================== 15:52:10.671793 | 7dbd7154-2d82-43a7-beb2-54a5ecac7560 ==============================
[0m15:52:10.671793 [info ] [MainThread]: Running with dbt=1.6.18
[0m15:52:10.672897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alejb\\.dbt', 'log_path': 'c:\\EDEM_MDA2425\\ALUMNOS\\MDAB\\JUAN_MONTOLIU\\DBT\\jaffle_shop\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:10.673962 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:52:10.674589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7dbd7154-2d82-43a7-beb2-54a5ecac7560', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020018EDEC00>]}
[0m15:52:10.871590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dbd7154-2d82-43a7-beb2-54a5ecac7560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020019019850>]}
[0m15:52:10.871590 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:52:10.871590 [debug] [MainThread]: Command `cli deps` succeeded at 15:52:10.871590 after 0.37 seconds
[0m15:52:10.887110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020014F89580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020018D53830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020018AF95E0>]}
[0m15:52:10.887110 [debug] [MainThread]: Flushing usage events
[0m10:04:53.680744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20D86B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20D868D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20D868DD0>]}


============================== 10:04:53.689602 | 7f0837ab-e368-44fa-bed5-9f240490d485 ==============================
[0m10:04:53.689602 [info ] [MainThread]: Running with dbt=1.6.18
[0m10:04:53.689602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alejb\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\EDEM_MDA2425\\ALUMNOS\\MDAB\\JUAN_MONTOLIU\\DBT\\jaffle_shop\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:04:53.689602 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m10:04:53.689602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7f0837ab-e368-44fa-bed5-9f240490d485', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20D72EC00>]}
[0m10:04:53.866978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f0837ab-e368-44fa-bed5-9f240490d485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20D847D70>]}
[0m10:04:53.866978 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:04:53.866978 [debug] [MainThread]: Command `cli deps` succeeded at 10:04:53.866978 after 0.33 seconds
[0m10:04:53.874997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20D77B5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20D67C560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A20D701670>]}
[0m10:04:53.874997 [debug] [MainThread]: Flushing usage events
